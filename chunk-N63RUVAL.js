import{a as re}from"./chunk-IUDEA7YP.js";import{a as J,b as K,c as X,f as Z,i as $,j as ee,k as te,p as ne}from"./chunk-DGZ2O3NI.js";import{c as ae}from"./chunk-PSANGQAQ.js";import"./chunk-2ZM6CYAQ.js";import"./chunk-QIGGX7RR.js";import{a as oe}from"./chunk-YFXRQM6Z.js";import{$a as E,Bb as B,Ca as s,Da as V,Db as Y,Fb as R,Sa as b,Ua as u,Wa as D,Za as n,_ as U,_a as i,a as j,bc as Q,cb as P,cc as q,db as g,eb as c,fc as H,ga as d,gb as W,ha as p,jc as G,lb as A,mb as r,nb as S,nd as ie,ob as I,p as L,rb as y,sb as C,tb as M,vb as N,xa as F}from"./chunk-PYKLABYS.js";import{a as T,b as z}from"./chunk-7QOE2ANW.js";function le(l,_){if(l&1&&(n(0,"span",42)(1,"span",35),r(2,"receipt_long"),i(),r(3),i()),l&2){let e=c().$implicit;s(3),I(" Ref: ",e.pendingSubscription==null?null:e.pendingSubscription.referenceNumber," ")}}function se(l,_){if(l&1){let e=P();n(0,"div",28)(1,"div",29)(2,"div",30)(3,"span",31),r(4),i(),n(5,"span",32),r(6),i()(),n(7,"div",33)(8,"span",34)(9,"span",35),r(10,"calendar_today"),i(),r(11),B(12,"date"),i(),b(13,le,4,1,"span",36),i()(),n(14,"div",37)(15,"button",38),g("click",function(){let t=d(e).$implicit,o=c(2);return p(o.viewProof(t))}),n(16,"span",35),r(17,"visibility"),i(),n(18,"span"),r(19,"Proof"),i()(),E(20,"div",39),n(21,"button",40),g("click",function(){let t=d(e).$implicit,o=c(2);return p(o.rejectRenewal(t))}),n(22,"span",35),r(23,"close"),i()(),n(24,"button",41),g("click",function(){let t=d(e).$implicit,o=c(2);return p(o.approveRenewal(t))}),n(25,"span",35),r(26,"check"),i(),n(27,"span"),r(28,"Approve"),i()()()()}if(l&2){let e=_.$implicit;s(4),S(e.name),s(2),S(e.pendingSubscription==null?null:e.pendingSubscription.plan),s(5),I(" ",Y(12,4,e.pendingSubscription==null?null:e.pendingSubscription.requestDate,"mediumDate")," "),s(2),u("ngIf",e.pendingSubscription==null?null:e.pendingSubscription.referenceNumber)}}function ce(l,_){if(l&1&&(n(0,"div",23)(1,"div",24)(2,"h2"),E(3,"span",25),r(4),i()(),n(5,"div",26),b(6,se,29,7,"div",27),i()()),l&2){let e=c();s(4),I(" Pending Approvals (",e.pendingRenewals.length,")"),s(2),u("ngForOf",e.pendingRenewals)}}function de(l,_){if(l&1&&E(0,"img",66),l&2){let e=c().$implicit;W("alt","",e.name," logo"),u("src",e.logoUrl,F)}}function pe(l,_){l&1&&(n(0,"span",10),r(1,"storefront"),i())}function me(l,_){l&1&&(n(0,"span",67),r(1,"Active Context"),i())}function ge(l,_){l&1&&(n(0,"span",68)(1,"span",35),r(2,"security"),i(),r(3," Super Branch "),i())}function ue(l,_){if(l&1){let e=P();n(0,"button",69),g("click",function(t){d(e);let o=c().$implicit;return c(2).onDeleteStore(o,t),p(t.stopPropagation())}),n(1,"span",10),r(2,"delete_outline"),i()()}}function _e(l,_){l&1&&(n(0,"p",70),r(1," Assignment required "),i())}function xe(l,_){if(l&1){let e=P();n(0,"div",45),g("click",function(){let t=d(e).$implicit,o=c(2);return p(o.openEditModal(t))})("keydown.enter",function(){let t=d(e).$implicit,o=c(2);return p(o.openEditModal(t))}),E(1,"span",46),n(2,"div",47)(3,"div",48),b(4,de,1,3,"img",49)(5,pe,2,0,"ng-template",null,1,R),i(),n(7,"div",50)(8,"h3"),r(9),i(),n(10,"div",51),b(11,me,2,0,"span",52)(12,ge,4,0,"span",53),i()(),b(13,ue,3,0,"button",54),i(),n(14,"div",55)(15,"div",56)(16,"span",10),r(17,"location_on"),i(),n(18,"span"),r(19),i()(),n(20,"div",56)(21,"span",10),r(22,"phone"),i(),n(23,"span"),r(24),i()()(),n(25,"div",57)(26,"div",58)(27,"div",59)(28,"span",60),r(29),i(),n(30,"span",61),r(31,"Products"),i()(),n(32,"div",59)(33,"span",60),r(34),i(),n(35,"span",61),r(36,"Sales"),i()(),n(37,"div",62)(38,"span",60),r(39),i(),n(40,"span",61),r(41,"Admin"),i()(),n(42,"div",59)(43,"span",60),r(44),i(),n(45,"span",61),r(46,"Users"),i()()(),n(47,"div",63)(48,"button",64),g("click",function(t){let o=d(e).$implicit;return c(2).onSwitchStore(o.id),p(t.stopPropagation())}),r(49),i(),b(50,_e,2,0,"p",65),i()()()}if(l&2){let e=_.$implicit,a=A(6),t=c(2);D("active-context",t.getActiveStoreId()===e.id),s(4),u("ngIf",e.logoUrl)("ngIfElse",a),s(5),S(e.name),s(2),u("ngIf",t.getActiveStoreId()===e.id),s(),u("ngIf",e.isSuperAdminOnly),s(),u("ngIf",!e.isSuperAdminOnly),s(6),S(e.address||"No address provided"),s(5),S(e.phoneNumber||"No phone set"),s(5),S((t.storeStats[e.id]==null?null:t.storeStats[e.id].products)||0),s(5),S((t.storeStats[e.id]==null?null:t.storeStats[e.id].sales)||0),s(5),S((t.storeStats[e.id]==null?null:t.storeStats[e.id].admins)||0),s(5),S((t.storeStats[e.id]==null?null:t.storeStats[e.id].staff)||0),s(4),D("disabled",!t.canSwitchToStore(e.id)),u("disabled",!t.canSwitchToStore(e.id))("title",t.canSwitchToStore(e.id)?"Switch to this store":"You must be assigned to this store to switch"),s(),I(" ",t.canSwitchToStore(e.id)?"Switch Context":"Restricted"," "),s(),u("ngIf",!t.canSwitchToStore(e.id))}}function fe(l,_){if(l&1&&(n(0,"div",43),b(1,xe,51,20,"div",44),i()),l&2){let e=c();s(),u("ngForOf",e.filteredStores)}}function ve(l,_){l&1&&(n(0,"p"),r(1,"Try adjusting your search query or clear filters."),i())}function he(l,_){l&1&&(n(0,"p"),r(1,"Start by registering your first store branch."),i())}function be(l,_){if(l&1){let e=P();n(0,"div",71)(1,"div",72),E(2,"img",73),i(),n(3,"h2"),r(4,"No stores found"),i(),b(5,ve,2,0,"p",74)(6,he,2,0,"p",74),n(7,"button",75),g("click",function(){d(e);let t=c();return p(t.openAddModal())}),r(8,"Add Your First Store"),i()()}if(l&2){let e=c();s(5),u("ngIf",e.searchQuery),s(),u("ngIf",!e.searchQuery)}}function Se(l,_){if(l&1){let e=P();n(0,"div",117),E(1,"img",118),n(2,"button",119),g("click",function(t){return d(e),c(2).removeLogo(),p(t.stopPropagation())}),n(3,"span",35),r(4,"delete"),i()(),n(5,"input",120),g("change",function(t){d(e);let o=c(2);return p(o.onLogoChange(t))}),i()()}if(l&2){let e=c(2);s(),u("src",e.logoPreview,F)}}function we(l,_){if(l&1){let e=P();n(0,"div",121)(1,"span",35),r(2,"add_photo_alternate"),i(),n(3,"p"),r(4,"Upload Logo"),i(),n(5,"input",122),g("change",function(t){d(e);let o=c(2);return p(o.onLogoChange(t))}),i()()}}function ye(l,_){if(l&1){let e=P();n(0,"div",76),g("click",function(){d(e);let t=c();return p(t.closeModal())})("keydown.escape",function(){d(e);let t=c();return p(t.closeModal())}),n(1,"div",77),g("click",function(t){return d(e),p(t.stopPropagation())})("keydown",function(t){return d(e),p(t.stopPropagation())}),n(2,"div",78)(3,"h2",79),r(4),i(),n(5,"button",80),g("click",function(){d(e);let t=c();return p(t.closeModal())}),n(6,"span",10),r(7,"close"),i()()(),n(8,"div",81)(9,"div",82)(10,"div",83)(11,"label",84),r(12,"Store Logo"),i(),n(13,"div",85),b(14,Se,6,1,"div",86)(15,we,6,0,"div",87),i()(),n(16,"div",83)(17,"label",88),r(18,"Store Name *"),i(),n(19,"div",89)(20,"span",10),r(21,"badge"),i(),n(22,"input",90),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.name,t)||(o.storeForm.name=t),p(t)}),i()()(),n(23,"div",91)(24,"label",92),r(25,"Phone Number"),i(),n(26,"div",89)(27,"span",10),r(28,"phone"),i(),n(29,"input",93),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.phoneNumber,t)||(o.storeForm.phoneNumber=t),p(t)}),i()()(),n(30,"div",91)(31,"label",94),r(32,"Status"),i(),n(33,"div",95)(34,"span"),r(35,"Active"),i(),n(36,"input",96),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.isActive,t)||(o.storeForm.isActive=t),p(t)}),i()()(),n(37,"div",91)(38,"label",97),r(39,"Super Admin Only"),i(),n(40,"div",95)(41,"span",98),r(42,"security"),i(),n(43,"input",99),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.isSuperAdminOnly,t)||(o.storeForm.isSuperAdminOnly=t),p(t)}),i()()(),n(44,"div",83)(45,"label",100),r(46,"Subscription Plan"),i(),n(47,"div",89)(48,"span",10),r(49,"card_membership"),i(),n(50,"select",101),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.subscriptionPlan,t)||(o.storeForm.subscriptionPlan=t),p(t)}),n(51,"option",102),r(52,"Free Tier (\u20B10)"),i(),n(53,"option",103),r(54,"Starter Estimate (\u20B1999)"),i(),n(55,"option",104),r(56,"Pro Revenue (\u20B11,499)"),i()()()(),n(57,"div",83)(58,"label",105),r(59,"Subscription Expiry"),i(),n(60,"div",106)(61,"span",107),r(62,"event"),i(),n(63,"input",108),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.subscriptionExpiryDate,t)||(o.storeForm.subscriptionExpiryDate=t),p(t)}),i(),n(64,"button",109),g("click",function(){d(e);let t=c();return p(t.renewSubscription())}),r(65," Renew (+30 Days) "),i()()(),n(66,"div",83)(67,"label",110),r(68,"Business Address"),i(),n(69,"div",89)(70,"span",10),r(71,"place"),i(),n(72,"input",111),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.address,t)||(o.storeForm.address=t),p(t)}),i()()(),n(73,"div",83)(74,"label",112),r(75,"Notes / Description"),i(),n(76,"textarea",113),M("ngModelChange",function(t){d(e);let o=c();return C(o.storeForm.description,t)||(o.storeForm.description=t),p(t)}),i()()()(),n(77,"div",114)(78,"button",115),g("click",function(){d(e);let t=c();return p(t.closeModal())}),r(79,"Cancel"),i(),n(80,"button",116),g("click",function(){d(e);let t=c();return p(t.saveStore())}),r(81),i()()()()}if(l&2){let e=c();s(4),S(e.isEditing?"Edit Store Details":"Register New Branch"),s(10),u("ngIf",e.logoPreview),s(),u("ngIf",!e.logoPreview),s(7),y("ngModel",e.storeForm.name),s(7),y("ngModel",e.storeForm.phoneNumber),s(7),y("ngModel",e.storeForm.isActive),s(7),y("ngModel",e.storeForm.isSuperAdminOnly),s(7),y("ngModel",e.storeForm.subscriptionPlan),s(13),y("ngModel",e.storeForm.subscriptionExpiryDate),s(9),y("ngModel",e.storeForm.address),s(4),y("ngModel",e.storeForm.description),s(5),I(" ",e.isEditing?"Update Records":"Save Branch"," ")}}var De=(()=>{class l{constructor(e,a,t,o){this.storeService=e,this.dialogService=a,this.inventoryService=t,this.userService=o,this.stores=[],this.filteredStores=[],this.searchQuery="",this.pendingRenewals=[],this.canApproveRenewals=!1,this.isModalOpen=!1,this.isEditing=!1,this.editingStoreId=null,this.proofPreview=null,this.storeForm={name:"",address:"",phoneNumber:"",description:"",isActive:!0,isSuperAdminOnly:!1,logoUrl:"",subscriptionPlan:"Free",subscriptionExpiryDate:""},this.logoPreview=null,this.storeStats={},this.currentUser=null,this.sub=new j}ngOnInit(){this.sub.add(L([this.storeService.stores$,this.inventoryService.getProducts(),this.inventoryService.getSales(),this.userService.users$,this.userService.currentUser$]).subscribe(([e,a,t,o,f])=>{this.stores=e,this.pendingRenewals=e.filter(x=>!!x.pendingSubscription),this.currentUser=f;let v=e.find(x=>x.id===f?.storeId);this.canApproveRenewals=f?.role==="super-admin"&&!!v?.isSuperAdminOnly,this.storeStats={},e.forEach(x=>{this.storeStats[x.id]={products:a.filter(m=>m.storeId===x.id).length,sales:t.filter(m=>m.storeId===x.id).length,admins:o.filter(m=>m.storeId===x.id&&m.role==="super-admin").length,staff:o.filter(m=>m.storeId===x.id&&(m.role==="admin"||m.role==="user")).length}}),this.applyFilter()})),this.storeService.loadStores(),this.inventoryService.reloadData(),this.userService.loadUsers()}viewProof(e){if(e.pendingSubscription?.proofUrl){let a=window.open();a&&a.document.write(`<img src="${e.pendingSubscription.proofUrl}" style="max-width:100%"/>`)}}approveRenewal(e){e.pendingSubscription&&this.dialogService.confirm(`Approve ${e.pendingSubscription.plan} for ${e.name}?`,"Approve Renewal").subscribe(a=>{if(a&&e.pendingSubscription){let t=e.pendingSubscription.plan,o=new Date,f={Free:0,Starter:1,Pro:2,Enterprise:3},v=f[e.subscriptionPlan||"Free"]||0,x=f[t]||0,m;x<v?m=new Date:(m=e.subscriptionExpiryDate?new Date(e.subscriptionExpiryDate):new Date,m<o&&(m=new Date)),m.setDate(m.getDate()+30);let h=e.credits||{ai:0,aiResponse:0,transactions:0,callMinutes:0,lastResetDate:new Date},w=h.transactions||0,O=h.ai||0,k=h.aiResponse||0;t==="Starter"?(w+=2e3,O=1e3,k=1e3):t==="Pro"?(w=1e5,O=5e3,k=5e3):t==="Free"&&(w=50,O=10,k=10),this.storeService.updateStore(e.id,{subscriptionPlan:t,subscriptionExpiryDate:m.toISOString().split("T")[0],credits:z(T({},h),{transactions:w,ai:O,aiResponse:k,lastResetDate:new Date}),pendingSubscription:null}).subscribe(()=>{this.dialogService.success("Subscription Approved and Updated."),this.storeService.loadStores()})}})}rejectRenewal(e){this.dialogService.confirm("Reject this request?","Reject Renewal").subscribe(a=>{a&&this.storeService.updateStore(e.id,{pendingSubscription:null}).subscribe(()=>{this.dialogService.info("Request Rejected."),this.storeService.loadStores()})})}ngOnDestroy(){this.sub.unsubscribe()}applyFilter(){if(this.searchQuery){let e=this.searchQuery.toLowerCase();this.filteredStores=this.stores.filter(a=>a.name.toLowerCase().includes(e)||a.address?.toLowerCase().includes(e)||a.phoneNumber?.toLowerCase().includes(e))}else this.filteredStores=[...this.stores]}openAddModal(){this.isEditing=!1,this.editingStoreId=null,this.storeForm={name:"",address:"",phoneNumber:"",description:"",isActive:!0,isSuperAdminOnly:!1,logoUrl:"",subscriptionPlan:"Free"},this.logoPreview=null,this.isModalOpen=!0}openEditModal(e){this.isEditing=!0,this.editingStoreId=e.id,this.storeForm=T({},e),this.logoPreview=e.logoUrl||null,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}renewSubscription(){let e=new Date,a=new Date(e);a.setDate(e.getDate()+30),this.storeForm.subscriptionExpiryDate=a.toISOString().split("T")[0],this.dialogService.success("Subscription Expiry set to "+this.storeForm.subscriptionExpiryDate)}saveStore(){if(!this.storeForm.name){this.dialogService.error("Store name is required");return}this.isEditing&&this.editingStoreId?this.storeService.updateStore(this.editingStoreId,this.storeForm).subscribe({next:()=>{this.dialogService.success("Store updated successfully"),this.closeModal()},error:e=>{console.error("Update failed:",e);let a=e.error?.details||e.error?.error||"Failed to update store";this.dialogService.error(a)}}):this.storeService.createStore(this.storeForm).subscribe({next:()=>{this.dialogService.success("Store created successfully"),this.closeModal()},error:()=>this.dialogService.error("Failed to create store")})}onDeleteStore(e,a){if(a.stopPropagation(),e.isSuperAdminOnly){this.dialogService.error("This is a protected system-level branch and cannot be deleted.","Action Restricted");return}this.dialogService.confirm("Are you sure you want to delete this store? All associated data might be affected.","Delete Store").subscribe(t=>{t&&this.storeService.deleteStore(e.id).subscribe({next:()=>this.dialogService.success("Store deleted successfully"),error:()=>this.dialogService.error("Failed to delete store")})})}onSwitchStore(e){if(!this.canSwitchToStore(e)){this.dialogService.error("Access Denied: You are not assigned to this store branch.","Permission Restricted");return}this.storeService.setActiveStore(e),this.dialogService.success("Switched active store context")}canSwitchToStore(e){return this.currentUser?this.currentUser.role==="super-admin"?!0:this.stores.find(o=>o.id===e)?.isSuperAdminOnly?!1:(this.currentUser.storeIds||[]).includes(e)||this.currentUser.storeId===e:!1}onLogoChange(e){let a=e.target;if(a.files?.[0]){let t=a.files[0],o=new FileReader;o.onload=f=>{let v=new Image;v.src=f.target.result,v.onload=()=>{let x=document.createElement("canvas"),m=v.width,h=v.height,w=400;(m>w||h>w)&&(m>h?(h=Math.round(h*w/m),m=w):(m=Math.round(m*w/h),h=w)),x.width=m,x.height=h;let O=x.getContext("2d");if(O){O.drawImage(v,0,0,m,h);let k=x.toDataURL("image/jpeg",.8);this.logoPreview=k,this.storeForm.logoUrl=k}}},o.readAsDataURL(t)}}removeLogo(){this.logoPreview=null,this.storeForm.logoUrl=""}getActiveStoreId(){return this.storeService.getActiveStoreId()}onMigrateData(){let e=this.getActiveStoreId();if(!e){this.dialogService.error("Please select an active store first");return}this.dialogService.confirm("Migrate Legacy Data?","This will move all products, sales, and customers that are NOT currently assigned to any store into your ACTIVE store context. This is usually done once when setting up branches.").subscribe(a=>{a&&this.storeService.migrateData(e).subscribe({next:t=>{let o=t?.summary||{},f=Object.values(o).reduce((v,x)=>v+Number(x),0);this.dialogService.success(`Migration complete! Successfully moved ${f} records.`),this.inventoryService.reloadData()},error:()=>this.dialogService.error("Migration failed. Please check network logs.")})})}static{this.\u0275fac=function(a){return new(a||l)(V(ie),V(oe),V(ae),V(re))}}static{this.\u0275cmp=U({type:l,selectors:[["app-store-management"]],hostBindings:function(a,t){a&1&&g("keydown.escape",function(){return t.closeModal()})},standalone:!0,features:[N],decls:41,vars:7,consts:[["emptyState",""],["defaultIcon",""],[1,"store-mgmt-wrapper"],[1,"mgmt-header"],[1,"header-content"],[1,"title-group"],[1,"premium-title"],[1,"subtitle"],[1,"header-actions-top"],["title","Move unassigned data to current store","type","button",1,"btn-migrate",3,"click"],["aria-hidden","true",1,"material-icon"],["type","button",1,"btn-create","premium-shadow",3,"click"],[1,"filter-bar","glass"],[1,"search-input-group"],["type","text","placeholder","Search by name, address or phone...","aria-label","Search stores",3,"ngModelChange","ngModel"],[1,"stats-overview"],[1,"stat-mini"],[1,"stat-label"],[1,"stat-value"],["class","pending-section",4,"ngIf"],[1,"stores-container"],["class","store-grid",4,"ngIf","ngIfElse"],["class","modal-overlay","role","dialog","aria-modal","true","aria-labelledby","modal-title",3,"click","keydown.escape",4,"ngIf"],[1,"pending-section"],[1,"pending-header"],[1,"pulse-dot"],[1,"pending-list"],["class","pending-item",4,"ngFor","ngForOf"],[1,"pending-item"],[1,"pi-content"],[1,"pi-top"],[1,"pi-store"],[1,"badge-plan"],[1,"pi-meta"],[1,"meta-date"],[1,"material-icon"],["class","meta-ref",4,"ngIf"],[1,"pi-actions"],["title","View Proof",1,"btn-view-proof",3,"click"],[1,"action-divider"],["title","Reject",1,"btn-action-reject",3,"click"],["title","Approve",1,"btn-action-approve",3,"click"],[1,"meta-ref"],[1,"store-grid"],["class","store-premium-card","tabindex","0","role","button",3,"active-context","click","keydown.enter",4,"ngFor","ngForOf"],["tabindex","0","role","button",1,"store-premium-card",3,"click","keydown.enter"],["aria-hidden","true",1,"card-glow"],[1,"card-header"],[1,"store-icon-wrapper"],["class","store-logo-img",3,"src","alt",4,"ngIf","ngIfElse"],[1,"header-info"],[1,"header-badges"],["class","active-badge",4,"ngIf"],["class","super-badge",4,"ngIf"],["class","btn-delete-subtle","title","Delete Store","type","button",3,"click",4,"ngIf"],[1,"card-body"],[1,"info-row"],[1,"card-footer"],[1,"store-stats"],[1,"mini-stat"],[1,"val"],[1,"label"],[1,"mini-stat","highlight"],[1,"switch-actions"],["type","button",1,"btn-switch",3,"click","disabled","title"],["class","restricted-text",4,"ngIf"],[1,"store-logo-img",3,"src","alt"],[1,"active-badge"],[1,"super-badge"],["title","Delete Store","type","button",1,"btn-delete-subtle",3,"click"],[1,"restricted-text"],[1,"empty-layout"],[1,"empty-illustration"],["src","assets/store_empty.png","alt","No stores illustration",1,"premium-shadow"],[4,"ngIf"],["type","button",1,"btn-primary",3,"click"],["role","dialog","aria-modal","true","aria-labelledby","modal-title",1,"modal-overlay",3,"click","keydown.escape"],[1,"modal-card","glass",3,"click","keydown"],[1,"modal-header"],["id","modal-title"],["aria-label","Close modal","type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"form-grid"],[1,"input-field","full"],["for","logo-upload"],[1,"logo-upload-container"],["class","logo-preview-box",4,"ngIf"],["class","logo-placeholder",4,"ngIf"],["for","reg-name"],[1,"input-wrapper"],["id","reg-name","type","text","placeholder","e.g. Downtown Mall Branch",3,"ngModelChange","ngModel"],[1,"input-field","half"],["for","reg-phone"],["id","reg-phone","type","text","placeholder","+254 ...",3,"ngModelChange","ngModel"],["for","reg-status"],[1,"toggle-wrapper",2,"display","flex","align-items","center","gap","10px","height","100%"],["id","reg-status","type","checkbox",2,"width","20px","height","20px","cursor","pointer",3,"ngModelChange","ngModel"],["for","reg-super"],[1,"material-icon",2,"color","#6366f1","font-size","20px"],["id","reg-super","type","checkbox",2,"width","20px","height","20px","cursor","pointer",3,"ngModelChange","ngModel"],["for","reg-plan"],["id","reg-plan",2,"background","transparent","border","none","color","inherit","width","100%","outline","none","padding","0.5rem",3,"ngModelChange","ngModel"],["value","Free",2,"color","#333"],["value","Starter",2,"color","#333"],["value","Pro",2,"color","#333"],["for","reg-expiry"],[1,"input-wrapper",2,"display","flex","gap","8px","align-items","center"],["aria-hidden","true",1,"material-icon",2,"margin-right","8px"],["id","reg-expiry","type","date",2,"flex","1","border","none","outline","none","background","transparent","color","inherit","font-family","inherit",3,"ngModelChange","ngModel"],["type","button",1,"btn-secondary",2,"padding","0.4rem 0.8rem","font-size","0.75rem","white-space","nowrap","margin-left","auto","border-radius","6px",3,"click"],["for","reg-address"],["id","reg-address","type","text","placeholder","Physical location details",3,"ngModelChange","ngModel"],["for","reg-desc"],["id","reg-desc","rows","3","placeholder","Optional notes about this branch...",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn-secondary",3,"click"],["type","button",1,"btn-save","premium-shadow",3,"click"],[1,"logo-preview-box"],["alt","Store logo preview",3,"src"],["type","button","aria-label","Remove logo",1,"btn-remove-logo",3,"click"],["type","file","accept","image/*","aria-label","Change store logo",1,"logo-input",3,"change"],[1,"logo-placeholder"],["id","logo-upload","type","file","accept","image/*","aria-label","Upload store logo",1,"logo-input",3,"change"]],template:function(a,t){if(a&1){let o=P();n(0,"div",2)(1,"header",3)(2,"div",4)(3,"div",5)(4,"h1",6),r(5,"Store Management"),i(),n(6,"p",7),r(7,"Manage and monitor all your physical branches from one place"),i()(),n(8,"div",8)(9,"button",9),g("click",function(){return d(o),p(t.onMigrateData())}),n(10,"span",10),r(11,"settings_backup_restore"),i(),n(12,"span"),r(13,"Migrate Data"),i()(),n(14,"button",11),g("click",function(){return d(o),p(t.openAddModal())}),n(15,"span",10),r(16,"add_business"),i(),n(17,"span"),r(18,"Register New Store"),i()()()(),n(19,"div",12)(20,"div",13)(21,"span",10),r(22,"search"),i(),n(23,"input",14),M("ngModelChange",function(v){return d(o),C(t.searchQuery,v)||(t.searchQuery=v),p(v)}),g("ngModelChange",function(){return d(o),p(t.applyFilter())}),i()(),n(24,"div",15)(25,"div",16)(26,"span",17),r(27,"Total Stores"),i(),n(28,"span",18),r(29),i()(),n(30,"div",16)(31,"span",17),r(32,"Active Branches"),i(),n(33,"span",18),r(34),i()()()()(),b(35,ce,7,2,"div",19),n(36,"div",20),b(37,fe,2,1,"div",21)(38,be,9,2,"ng-template",null,0,R),i(),b(40,ye,82,12,"div",22),i()}if(a&2){let o=A(39);s(23),y("ngModel",t.searchQuery),s(6),S(t.stores.length),s(5),S(t.stores.length),s(),u("ngIf",t.canApproveRenewals&&t.pendingRenewals.length>0),s(2),u("ngIf",t.filteredStores.length>0)("ngIfElse",o),s(3),u("ngIf",t.isModalOpen)}},dependencies:[G,Q,q,H,ne,ee,te,K,J,$,X,Z],styles:['.store-mgmt-wrapper[_ngcontent-%COMP%]{padding:var(--space-xl);max-width:1400px;margin:0 auto;min-height:100vh;background:var(--color-bg)}.mgmt-header[_ngcontent-%COMP%]{margin-bottom:var(--space-2xl)}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:var(--space-xl)}.header-actions-top[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-md)}.btn-migrate[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);background:transparent;color:var(--color-text-muted);border:1px solid var(--color-border);padding:.75rem 1.5rem;border-radius:var(--radius-lg);font-weight:600;cursor:pointer;transition:all .3s ease}.btn-migrate[_ngcontent-%COMP%]:hover{background:var(--color-surface);color:var(--color-primary);border-color:var(--color-primary);transform:translateY(-2px)}.premium-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;background:linear-gradient(135deg,var(--color-primary),#a855f7);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;margin:0}.subtitle[_ngcontent-%COMP%]{color:var(--color-text-muted);font-size:1.1rem;margin:var(--space-xs) 0 0 0}.btn-create[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);background:linear-gradient(135deg,var(--color-primary),#7c3aed);color:#fff;border:none;padding:1rem 2rem;border-radius:var(--radius-lg);font-weight:700;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1)}.btn-create[_ngcontent-%COMP%]:hover{transform:translateY(-3px) scale(1.02);box-shadow:0 10px 25px -5px #7c3aed66}.filter-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--space-md) var(--space-xl);border-radius:var(--radius-xl);border:1px solid rgba(255,255,255,.1)}.glass[_ngcontent-%COMP%]{background:#ffffff0d;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px)}.search-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);background:#0003;padding:.75rem 1.25rem;border-radius:var(--radius-full);width:400px}.search-input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;width:100%;outline:none;font-size:.95rem}.stats-overview[_ngcontent-%COMP%]{display:flex;gap:var(--space-2xl)}.stat-mini[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-label[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--color-text-muted)}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--color-primary)}.store-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:var(--space-xl)}.store-premium-card[_ngcontent-%COMP%]{position:relative;background:var(--color-surface);border-radius:var(--radius-2xl);padding:var(--space-xl);border:1px solid var(--color-border);cursor:pointer;transition:all .4s cubic-bezier(.4,0,.2,1);overflow:hidden;display:flex;flex-direction:column;gap:var(--space-lg)}.store-premium-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);border-color:var(--color-primary);box-shadow:var(--shadow-2xl)}.store-premium-card.active-context[_ngcontent-%COMP%]{border:2px solid var(--color-primary);background:linear-gradient(to bottom,var(--color-surface),rgba(124,58,237,.05))}.card-glow[_ngcontent-%COMP%]{position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle at center,rgba(124,58,237,.05) 0%,transparent 70%);pointer-events:none}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-md)}.store-icon-wrapper[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(135deg,#7c3aed1a,#a855f71a);border-radius:var(--radius-lg);display:flex;align-items:center;justify-content:center;color:var(--color-primary)}.header-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.35rem;font-weight:800;color:var(--color-text);line-height:1.2}.store-logo-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:var(--radius-lg)}.header-badges[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;margin-top:4px}.active-badge[_ngcontent-%COMP%]{font-size:.65rem;background:var(--color-primary);color:#fff;padding:2px 10px;border-radius:var(--radius-full);font-weight:700;text-transform:uppercase;box-shadow:0 2px 8px #6366f14d}.super-badge[_ngcontent-%COMP%]{font-size:.65rem;background:linear-gradient(135deg,#3730a3,#312e81);color:#fff;padding:2px 10px;border-radius:var(--radius-full);font-weight:700;text-transform:uppercase;box-shadow:0 2px 8px #312e8166;display:flex;align-items:center;gap:4px}.super-badge[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:12px}.btn-delete-subtle[_ngcontent-%COMP%]{margin-left:auto;background:transparent;border:none;color:var(--color-text-muted);cursor:pointer;padding:8px;border-radius:50%;transition:all .2s}.btn-delete-subtle[_ngcontent-%COMP%]:hover{background:#ef44441a;color:var(--color-danger)}.card-body[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:var(--space-sm)}.info-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--space-sm);color:var(--color-text);font-size:.9rem}.info-row[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--color-primary)}.card-footer[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-md);padding-top:var(--space-lg);border-top:1px solid var(--color-border);margin-top:auto}.store-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-sm)}.mini-stat[_ngcontent-%COMP%]{padding:.5rem;background:var(--color-bg);border:1px solid var(--color-border);border-radius:var(--radius-lg);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;transition:all .2s ease;min-height:60px}.mini-stat.highlight[_ngcontent-%COMP%]{background:#ffd7000d;border-color:#ffd70033}.mini-stat.highlight[_ngcontent-%COMP%]   .val[_ngcontent-%COMP%]{color:#c5a021}.mini-stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.6rem;text-transform:uppercase;color:var(--color-text-muted);font-weight:700;letter-spacing:.05em;margin-top:1px}.mini-stat[_ngcontent-%COMP%]   .val[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:800;color:var(--color-text);line-height:1;white-space:nowrap}.switch-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.btn-switch[_ngcontent-%COMP%]{width:100%;padding:.75rem;background:var(--color-primary);color:#fff;border:none;border-radius:var(--radius-lg);font-weight:700;cursor:pointer;transition:all .3s ease}.btn-switch[_ngcontent-%COMP%]:hover:not(.disabled){background:var(--color-primary-dark);transform:translateY(-2px);box-shadow:0 4px 12px #6366f14d}.btn-switch.disabled[_ngcontent-%COMP%]{background:var(--color-surface);color:var(--color-text-muted);border:1px solid var(--color-border);cursor:not-allowed;opacity:.7}.pending-section[_ngcontent-%COMP%]{margin-bottom:2.5rem;padding:0}.pending-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem}.pending-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin:0;display:flex;align-items:center;gap:.5rem;color:var(--color-text)}.pulse-dot[_ngcontent-%COMP%]{width:8px;height:8px;background:#f59e0b;border-radius:50%;box-shadow:0 0 #f59e0bb3;animation:_ngcontent-%COMP%_pulse-ring 2s infinite}.pending-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.pending-item[_ngcontent-%COMP%]{background:var(--color-surface);border:1px solid var(--color-border);border-radius:12px;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;gap:1.5rem;transition:all .2s;box-shadow:0 1px 2px #0000000d}.pending-item[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);transform:translate(4px);box-shadow:0 4px 6px #0000000d}.pi-content[_ngcontent-%COMP%]{flex:1}.pi-top[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:.25rem}.pi-store[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;color:var(--color-text)}.badge-plan[_ngcontent-%COMP%]{background:var(--color-primary-light, #e0f2fe);color:var(--color-primary);padding:.15rem .6rem;border-radius:99px;font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px}.pi-meta[_ngcontent-%COMP%]{display:flex;gap:1.5rem;font-size:.85rem;color:var(--color-text-muted)}.pi-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem}.pi-meta[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--color-text-light)}.pi-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.btn-view-proof[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:transparent;border:1px solid var(--color-border);border-radius:8px;color:var(--color-text);font-weight:600;cursor:pointer;height:38px;transition:all .2s}.btn-view-proof[_ngcontent-%COMP%]:hover{background:var(--color-bg)}.action-divider[_ngcontent-%COMP%]{width:1px;height:24px;background:var(--color-border);margin:0 .5rem}.btn-action-reject[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:38px;height:38px;border-radius:8px;border:1px solid #fee2e2;background:#fef2f2;color:#ef4444;cursor:pointer;transition:all .2s}.btn-action-reject[_ngcontent-%COMP%]:hover{background:#fee2e2;transform:scale(1.05)}.btn-action-approve[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:0 1.25rem;height:38px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;box-shadow:0 2px 4px #10b98140;transition:all .2s}.btn-action-approve[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px #10b98159}@keyframes _ngcontent-%COMP%_pulse-ring{0%{transform:scale(.95);box-shadow:0 0 #f59e0bb3}70%{transform:scale(1);box-shadow:0 0 0 6px #f59e0b00}to{transform:scale(.95);box-shadow:0 0 #f59e0b00}}@media (max-width: 768px){.pending-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.pi-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}}.restricted-text[_ngcontent-%COMP%]{font-size:.7rem;color:var(--color-danger);text-align:center;font-weight:500;margin:0}.empty-layout[_ngcontent-%COMP%]{text-align:center;padding:var(--space-3xl) 0}.empty-illustration[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:300px;margin-bottom:var(--space-xl);filter:drop-shadow(0 20px 30px rgba(0,0,0,.2))}.empty-layout[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:var(--space-sm)}.empty-layout[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-muted);margin-bottom:var(--space-xl)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0006;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);z-index:1000;display:flex;align-items:center;justify-content:center;padding:var(--space-xl)}.modal-card[_ngcontent-%COMP%]{width:100%;max-width:600px;max-height:90vh;background:var(--color-surface);border-radius:var(--radius-3xl);border:1px solid rgba(255,255,255,.1);overflow:hidden;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_modalIn .4s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_modalIn{0%{opacity:0;transform:translateY(20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header[_ngcontent-%COMP%]{padding:var(--space-xl);display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--color-border)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:800;margin:0}.modal-body[_ngcontent-%COMP%]{padding:var(--space-xl);overflow-y:auto;flex:1}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-xl)}.input-field.full[_ngcontent-%COMP%]{grid-column:span 2}.input-field.half[_ngcontent-%COMP%]{grid-column:span 1}.input-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.85rem;font-weight:600;margin-bottom:8px;color:var(--color-text-muted)}.input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);background:var(--color-bg);padding:.85rem 1rem;border-radius:var(--radius-lg);border:1px solid var(--color-border);transition:all .2s}.input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:var(--color-primary);box-shadow:0 0 0 4px #7c3aed1a}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--color-text);width:100%;outline:none}textarea[_ngcontent-%COMP%]{width:100%;background:var(--color-bg);border:1px solid var(--color-border);border-radius:var(--radius-lg);padding:1rem;color:var(--color-text);outline:none;resize:none}.modal-footer[_ngcontent-%COMP%]{padding:var(--space-xl);display:flex;justify-content:flex-end;gap:var(--space-md);background:#0000000d}.btn-secondary[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--color-border);color:var(--color-text);padding:.75rem 1.5rem;border-radius:var(--radius-lg);font-weight:600;cursor:pointer}.btn-save[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary),#7c3aed);color:#fff;border:none;padding:.75rem 2rem;border-radius:var(--radius-lg);font-weight:700;cursor:pointer}.logo-upload-container[_ngcontent-%COMP%]{margin-top:.5rem}.logo-preview-box[_ngcontent-%COMP%]{position:relative;width:140px;height:140px;border-radius:var(--radius-xl);overflow:hidden;border:2px solid var(--color-primary);box-shadow:0 8px 16px #0000001a;cursor:pointer}.logo-preview-box[_ngcontent-%COMP%]:after{content:"Change Logo";position:absolute;inset:0;background:#0009;color:#fff;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;opacity:0;transition:opacity .3s}.logo-preview-box[_ngcontent-%COMP%]:hover:after{opacity:1}.logo-preview-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.btn-remove-logo[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;background:#ef4444;color:#fff;border:none;border-radius:50%;width:28px;height:28px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;z-index:10}.btn-remove-logo[_ngcontent-%COMP%]:hover{transform:scale(1.1);background:var(--color-danger)}.logo-placeholder[_ngcontent-%COMP%]{position:relative;width:140px;height:140px;border:2px dashed var(--color-border);border-radius:var(--radius-xl);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;color:var(--color-text);cursor:pointer;transition:all .3s;background:var(--color-bg)}.logo-placeholder[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);background:#7c3aed0d;color:var(--color-primary)}.logo-placeholder[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:32px}.logo-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;margin:0}.logo-input[_ngcontent-%COMP%]{position:absolute;inset:0;opacity:0;cursor:pointer}.store-premium-card[_ngcontent-%COMP%]:focus-visible{outline:3px solid var(--color-primary);outline-offset:4px}body.dark-theme[_nghost-%COMP%]   .glass[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .glass[_ngcontent-%COMP%]{background:#0f172a99;border:1px solid rgba(255,255,255,.05)}body.dark-theme[_nghost-%COMP%]   .mini-stat[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .mini-stat[_ngcontent-%COMP%]{background:#1e293b}body.dark-theme[_nghost-%COMP%]   .modal-card[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .modal-card[_ngcontent-%COMP%]{background:#0f172a}']})}}return l})();export{De as StoreManagementComponent};

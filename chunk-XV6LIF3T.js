import{a as K}from"./chunk-KSHKVDE3.js";import{a as X}from"./chunk-VYKVMX3Y.js";import{a as Q,b as B,e as j,h as U,i as L,j as Y,m as G,n as H}from"./chunk-ZPQL42FH.js";import{a as F,d as J}from"./chunk-IO3I47CY.js";import{$a as q,Ca as x,Ea as p,Ga as D,Ia as i,Ja as n,Ka as R,La as C,Ma as h,Na as d,O as k,Sa as s,T as I,Ta as P,Ua as y,Va as V,X as E,Xa as v,Ya as _,Za as f,ab as b,c as w,cb as M,da as l,ea as m,pa as T,q as S,sa as c,ta as O,tb as N,ub as A,xb as W,zb as z}from"./chunk-K7VUYT6X.js";var Z=(()=>{class o{constructor(e){this.http=e,this.apiUrl=J.apiUrl}addReservation(e){return w(this,null,function*(){return yield S(this.http.post(`${this.apiUrl}/reservations`,e)),"reservation-submitted"})}static{this.\u0275fac=function(r){return new(r||o)(I(F))}}static{this.\u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function ne(o,g){if(o&1&&(i(0,"div",5)(1,"div",6),s(2,"\u2705"),n(),i(3,"p"),s(4),n()()),o&2){let e=d();c(4),P(e.successMessage)}}function ie(o,g){if(o&1&&(i(0,"option",31),s(1),n()),o&2){let e=g.$implicit;p("value",e),c(),y(" ",e," ")}}function re(o,g){if(o&1&&R(0,"img",46),o&2){let e=d().$implicit;p("src",e.imageUrl,T)("alt",e.name)}}function oe(o,g){o&1&&(i(0,"div",47),s(1,"\u{1F4E6}"),n())}function ae(o,g){if(o&1){let e=C();i(0,"div",32)(1,"div",33),x(2,re,1,2,"img",34)(3,oe,2,0,"div",35),n(),i(4,"div",36)(5,"h4",37),s(6),n(),i(7,"div",38)(8,"span",39),s(9),b(10,"number"),n(),i(11,"span",40),s(12),n()(),i(13,"div",41)(14,"div",42)(15,"button",43),h("click",function(){let t=l(e).$implicit,a=d(2);return m(a.decrementQty(t))}),s(16," - "),n(),i(17,"input",44),h("input",function(t){let a=l(e).$implicit,u=d(2);return m(u.manualQty(a,t))}),n(),i(18,"button",43),h("click",function(){let t=l(e).$implicit,a=d(2);return m(a.incrementQty(t))}),s(19," + "),n()(),i(20,"button",45),h("click",function(){let t=l(e).$implicit,a=d(2);return m(a.addToOrder(t))}),s(21," Add "),n()()()()}if(o&2){let e=g.$implicit,r=d(2);c(2),p("ngIf",e.imageUrl),c(),p("ngIf",!e.imageUrl),c(3),P(e.name),c(3),y("\u20B1",M(10,9,e.price,"1.2-2"),""),c(2),D("low",e.quantity<10),c(),y("Stock: ",e.quantity,""),c(5),p("value",r.getQty(e))("max",e.quantity)}}function se(o,g){if(o&1){let e=C();i(0,"div",57)(1,"div",58)(2,"span",59),s(3),n(),i(4,"span",60),s(5),b(6,"number"),n()(),i(7,"div",61),s(8),b(9,"number"),i(10,"button",62),h("click",function(){let t=l(e).index,a=d(3);return m(a.removeFromOrder(t))}),s(11," \u2715 "),n()()()}if(o&2){let e=g.$implicit;c(3),P(e.product.name),c(2),V("",e.quantity," x \u20B1",M(6,4,e.product.price,"1.2-2"),""),c(3),y(" \u20B1",M(9,7,e.product.price*e.quantity,"1.2-2")," ")}}function ce(o,g){if(o&1){let e=C();i(0,"section",48)(1,"h3"),s(2,"Order Summary"),n(),i(3,"div",49),x(4,se,12,10,"div",50),n(),i(5,"div",51)(6,"span"),s(7,"Total Amount:"),n(),i(8,"span",52),s(9),b(10,"number"),n()(),i(11,"div",10)(12,"label",53),s(13,"Additional Notes"),n(),i(14,"textarea",54),f("ngModelChange",function(t){l(e);let a=d(2);return _(a.notes,t)||(a.notes=t),m(t)}),n()(),i(15,"div",55)(16,"button",56),h("click",function(){l(e);let t=d(2);return m(t.submitReservation())}),s(17),n()()()}if(o&2){let e=d(2);c(4),p("ngForOf",e.orderItems),c(5),y("\u20B1",M(10,5,e.totalAmount,"1.2-2"),""),c(5),v("ngModel",e.notes),c(2),p("disabled",e.isSubmitting),c(),y(" ",e.isSubmitting?"Submitting...":"Confirm Reservation"," ")}}function de(o,g){o&1&&(i(0,"div",63)(1,"p"),s(2,"Your cart is empty. Add items above."),n()())}function le(o,g){if(o&1){let e=C();i(0,"div",7)(1,"section",8)(2,"h3"),s(3,"\u{1F4CB} Customer Information"),n(),i(4,"div",9)(5,"div",10)(6,"label",11),s(7,"Full Name *"),n(),i(8,"input",12),f("ngModelChange",function(t){l(e);let a=d();return _(a.customerName,t)||(a.customerName=t),m(t)}),n()(),i(9,"div",10)(10,"label",13),s(11,"Phone Number *"),n(),i(12,"input",14),f("ngModelChange",function(t){l(e);let a=d();return _(a.customerContact,t)||(a.customerContact=t),m(t)}),n()(),i(13,"div",15)(14,"label",16),s(15,"Delivery Address *"),n(),i(16,"input",17),f("ngModelChange",function(t){l(e);let a=d();return _(a.customerAddress,t)||(a.customerAddress=t),m(t)}),n()(),i(17,"div",15)(18,"label",18),s(19,"Payment Option (Optional)"),n(),i(20,"select",19),f("ngModelChange",function(t){l(e);let a=d();return _(a.paymentOption,t)||(a.paymentOption=t),m(t)}),i(21,"option",20),s(22,"Select Payment Method"),n(),x(23,ie,2,2,"option",21),n()()(),i(24,"h3",22),s(25,"\u{1F69A} Pickup/Delivery Date"),n(),i(26,"div",9)(27,"div",10)(28,"label",23),s(29,"Date *"),n(),i(30,"input",24),f("ngModelChange",function(t){l(e);let a=d();return _(a.pickupDate,t)||(a.pickupDate=t),m(t)}),n()(),i(31,"div",10)(32,"label",25),s(33,"Time"),n(),i(34,"input",26),f("ngModelChange",function(t){l(e);let a=d();return _(a.pickupTime,t)||(a.pickupTime=t),m(t)}),n()()()(),i(35,"section",8)(36,"h3"),s(37,"Select Items"),n(),i(38,"div",27),x(39,ae,22,12,"div",28),n()(),x(40,ce,18,8,"section",29)(41,de,3,0,"div",30),n()}if(o&2){let e=d();c(8),v("ngModel",e.customerName),c(4),v("ngModel",e.customerContact),c(4),v("ngModel",e.customerAddress),c(4),v("ngModel",e.paymentOption),c(3),p("ngForOf",e.paymentOptions),c(7),v("ngModel",e.pickupDate),c(4),v("ngModel",e.pickupTime),c(5),p("ngForOf",e.products),c(),p("ngIf",e.orderItems.length>0),c(),p("ngIf",e.orderItems.length===0)}}var Ce=(()=>{class o{constructor(e,r,t){this.inventoryService=e,this.reservationService=r,this.customerService=t,this.products=[],this.customerName="",this.customerContact="",this.customerAddress="",this.notes="",this.paymentOption="",this.paymentOptions=["Cash on Delivery","Gcash","Bank Transfer"],this.pickupDate="",this.pickupTime="",this.orderItems=[],this.selectedProduct=null,this.selectedQuantity=1,this.isSubmitting=!1,this.successMessage="",this.tempQuantities={}}ngOnInit(){let e=new Date;e.setDate(e.getDate()+1),this.pickupDate=e.toISOString().split("T")[0],this.loadProducts()}loadProducts(){this.inventoryService.getProducts().subscribe(e=>{this.products=e.filter(r=>r.quantity>0)})}getQty(e){return this.tempQuantities[e.id]||1}incrementQty(e){let r=this.getQty(e);r<e.quantity&&(this.tempQuantities[e.id]=r+1)}decrementQty(e){let r=this.getQty(e);r>1&&(this.tempQuantities[e.id]=r-1)}manualQty(e,r){let t=parseInt(r.target.value,10);!isNaN(t)&&t>=1&&t<=e.quantity&&(this.tempQuantities[e.id]=t)}addToOrder(e){let r=this.getQty(e),t=this.orderItems.find(u=>u.product.id===e.id),a=t?t.quantity:0;if(a+r>e.quantity){alert(`Cannot add more. You already have ${a} in cart. Max stock is ${e.quantity}.`);return}t?t.quantity+=r:this.orderItems.push({product:e,quantity:r}),this.tempQuantities[e.id]=1}removeFromOrder(e){this.orderItems.splice(e,1)}get totalAmount(){return this.orderItems.reduce((e,r)=>e+r.product.price*r.quantity,0)}submitReservation(){return w(this,null,function*(){if(this.orderItems.length===0||!this.customerName||!this.customerContact||!this.pickupDate||!this.customerAddress){alert("Please fill in all required fields and add items to your reservation.");return}this.isSubmitting=!0;try{let e=new Date(this.pickupDate+(this.pickupTime?"T"+this.pickupTime:"T00:00:00")),r=`Payment: ${this.paymentOption||"Not Specified"}

${this.notes}`,t=null;this.customerService.getCustomers().subscribe(u=>{t=u.find($=>$.phoneNumber===this.customerContact)}),yield new Promise(u=>setTimeout(u,100)),t||this.customerService.addCustomer({name:this.customerName,phoneNumber:this.customerContact,deliveryAddress:this.customerAddress}),yield this.reservationService.addReservation({customerName:this.customerName,customerContact:this.customerContact,customerAddress:this.customerAddress,reservationDate:new Date,pickupDate:e,status:"pending",items:this.orderItems.map(u=>({productId:u.product.id,productName:u.product.name,quantity:u.quantity,price:u.product.price})),totalAmount:this.totalAmount,notes:r});let a={name:this.customerName,phoneNumber:this.customerContact,address:this.customerAddress,gpsCoordinates:"",expiresAt:Date.now()+2*60*60*1e3};localStorage.setItem("chatCustomerInfo",JSON.stringify(a)),localStorage.setItem("chatUserName",this.customerName),this.successMessage="Reservation submitted successfully! We will contact you shortly. You can now chat with us!",this.resetForm()}catch(e){console.error("Error submitting reservation",e),alert("Failed to submit reservation. Please try again.")}finally{this.isSubmitting=!1}})}resetForm(){this.orderItems=[],this.customerName="",this.customerContact="",this.customerAddress="",this.paymentOption="",this.notes="",this.selectedProduct=null,this.pickupTime=""}static{this.\u0275fac=function(r){return new(r||o)(O(K),O(Z),O(X))}}static{this.\u0275cmp=E({type:o,selectors:[["app-reservation"]],standalone:!0,features:[q],decls:9,vars:2,consts:[[1,"reservation-page"],[1,"reservation-container"],[1,"reservation-header"],["class","success-alert",4,"ngIf"],["class","reservation-form",4,"ngIf"],[1,"success-alert"],[1,"success-icon"],[1,"reservation-form"],[1,"form-section"],[1,"form-grid"],[1,"form-group"],["for","name"],["type","text","id","name","placeholder","Enter your name","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","contact"],["type","text","id","contact","placeholder","Phone number","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-group","full-width",2,"grid-column","1 / -1"],["for","address"],["type","text","id","address","placeholder","Street, City, Province","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","payment"],["id","payment",1,"form-input",2,"height","42px",3,"ngModelChange","ngModel"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf"],[2,"margin-top","var(--space-lg)"],["for","date"],["type","date","id","date","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","time"],["type","time","id","time",1,"form-input",3,"ngModelChange","ngModel"],[1,"product-grid"],["class","product-card",4,"ngFor","ngForOf"],["class","form-section summary-section",4,"ngIf"],["class","empty-cart-msg",4,"ngIf"],[3,"value"],[1,"product-card"],[1,"card-image"],["loading","lazy",3,"src","alt",4,"ngIf"],["class","placeholder-img",4,"ngIf"],[1,"card-content"],[1,"card-title"],[1,"card-meta"],[1,"price"],[1,"stock"],[1,"card-actions"],[1,"qty-control"],["type","button",1,"qty-btn",3,"click"],["type","number","min","1",1,"qty-input-sm",3,"input","value","max"],[1,"btn-add-card",3,"click"],["loading","lazy",3,"src","alt"],[1,"placeholder-img"],[1,"form-section","summary-section"],[1,"order-list"],["class","order-item",4,"ngFor","ngForOf"],[1,"order-total"],[1,"total-price"],["for","notes"],["id","notes","rows","3","placeholder","Any special requests?",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"actions"],[1,"btn-submit",3,"click","disabled"],[1,"order-item"],[1,"item-info"],[1,"item-name"],[1,"item-details"],[1,"item-total"],["title","Remove",1,"btn-remove",3,"click"],[1,"empty-cart-msg"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),s(4,"\u{1F4C5} Make a Reservation"),n(),i(5,"p"),s(6,"Reserve items for pickup or delivery."),n()(),x(7,ne,5,1,"div",3)(8,le,42,10,"div",4),n()()),r&2&&(c(7),p("ngIf",t.successMessage),c(),p("ngIf",!t.successMessage))},dependencies:[z,N,A,W,H,L,Y,Q,U,B,G,j],styles:[".reservation-page[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:var(--space-md);background:var(--color-bg);background-image:radial-gradient(var(--color-border) 1px,transparent 1px);background-size:20px 20px}.reservation-container[_ngcontent-%COMP%]{width:100%;max-width:800px;background:var(--color-surface);border-radius:var(--radius-xl);box-shadow:0 4px 6px #0000001a;overflow:hidden;border:1px solid var(--color-border)}.reservation-header[_ngcontent-%COMP%]{padding:var(--space-xl) var(--space-lg);background:linear-gradient(135deg,var(--color-primary),var(--color-primary-dark));color:#fff;text-align:center}.reservation-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:var(--space-md);color:#fff}.reservation-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:.9;font-size:1.1rem}.reservation-form[_ngcontent-%COMP%]{padding:var(--space-xl)}.form-section[_ngcontent-%COMP%]{margin-bottom:var(--space-2xl);padding-bottom:var(--space-lg);border-bottom:1px solid var(--color-border)}.form-section[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--color-text);margin-bottom:var(--space-md);text-transform:uppercase;letter-spacing:.5px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--space-md)}.form-group[_ngcontent-%COMP%]{margin-bottom:var(--space-md)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:var(--space-xs);color:var(--color-text);font-weight:500}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:var(--space-sm);border:1px solid var(--color-border);border-radius:var(--radius-md);background:var(--color-bg);color:var(--color-text);font-size:1rem;transition:border-color .2s}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{border-color:var(--color-primary);outline:none;box-shadow:0 0 0 3px #2563eb1a}.product-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:var(--space-sm);max-height:500px;overflow-y:auto;padding-right:4px}.product-card[_ngcontent-%COMP%]{background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-md);overflow:hidden;transition:transform .2s,box-shadow .2s;display:flex;flex-direction:column}.product-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.card-image[_ngcontent-%COMP%]{height:100px;background:var(--color-bg);display:flex;align-items:center;justify-content:center;overflow:hidden}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.placeholder-img[_ngcontent-%COMP%]{font-size:2rem;opacity:.5}.card-content[_ngcontent-%COMP%]{padding:var(--space-sm);flex:1;display:flex;flex-direction:column}.card-title[_ngcontent-%COMP%]{margin:0 0 2px;font-size:.9rem;font-weight:600;color:var(--color-text)}.card-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-sm);font-size:.8rem}.price[_ngcontent-%COMP%]{font-weight:700;color:var(--color-primary)}.stock[_ngcontent-%COMP%]{color:var(--color-text-muted)}.stock.low[_ngcontent-%COMP%]{color:var(--color-warning)}.card-actions[_ngcontent-%COMP%]{margin-top:auto;display:flex;flex-direction:column;gap:6px;align-items:stretch}.qty-control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border:1px solid var(--color-border);border-radius:4px;overflow:hidden;background:var(--color-bg)}.qty-btn[_ngcontent-%COMP%]{background:var(--color-bg);border:none;width:24px;height:24px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8rem;z-index:2}.qty-btn[_ngcontent-%COMP%]:hover{background:var(--color-border)}.qty-input-sm[_ngcontent-%COMP%]{width:30px;border:none;text-align:center;font-size:.85rem;padding:0;height:24px;appearance:textfield}.qty-input-sm[_ngcontent-%COMP%]::-webkit-outer-spin-button, .qty-input-sm[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.btn-add-card[_ngcontent-%COMP%]{flex:1;background:var(--color-primary);color:#fff;border:none;border-radius:4px;height:26px;font-weight:600;cursor:pointer;transition:background .2s;font-size:.85rem}.btn-add-card[_ngcontent-%COMP%]:hover{background:var(--color-primary-dark)}.summary-section[_ngcontent-%COMP%]{background:var(--color-bg);padding:var(--space-lg);border-radius:var(--radius-lg)}.order-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-sm);margin-bottom:var(--space-lg)}.order-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--space-sm);background:var(--color-surface);border-radius:var(--radius-md);border:1px solid var(--color-border)}.item-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-name[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text)}.item-details[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text-muted)}.item-total[_ngcontent-%COMP%]{font-weight:600;color:var(--color-primary);display:flex;align-items:center;gap:var(--space-sm)}.btn-remove[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;border:none;background:var(--color-danger);color:#fff;font-size:.75rem;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:.8;transition:.2s}.btn-remove[_ngcontent-%COMP%]:hover{opacity:1;transform:scale(1.1)}.order-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:var(--space-md);border-top:2px dashed var(--color-border);margin-bottom:var(--space-lg);font-size:1.25rem;font-weight:700;color:var(--color-text)}.total-price[_ngcontent-%COMP%]{color:var(--color-primary)}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.btn-submit[_ngcontent-%COMP%]{padding:var(--space-md) var(--space-2xl);background:var(--color-primary);color:#fff;border:none;border-radius:var(--radius-md);font-size:1.1rem;font-weight:600;cursor:pointer;box-shadow:0 4px 6px #0000001a;transition:transform .2s,box-shadow .2s}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 12px #00000026}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:wait}.empty-cart-msg[_ngcontent-%COMP%]{text-align:center;padding:var(--space-2xl);color:var(--color-text-muted);font-style:italic}.success-alert[_ngcontent-%COMP%]{text-align:center;padding:var(--space-3xl) var(--space-xl)}.success-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:var(--space-md)}.success-alert[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.25rem;color:var(--color-text);margin-bottom:var(--space-xl)}.btn-primary[_ngcontent-%COMP%]{padding:var(--space-md) var(--space-xl);background:var(--color-primary);color:#fff;border:none;border-radius:var(--radius-md);font-weight:600;cursor:pointer}@media (max-width: 640px){.reservation-page[_ngcontent-%COMP%]{padding:0}.reservation-container[_ngcontent-%COMP%]{border-radius:0;min-height:100vh;border:none}.add-item-row[_ngcontent-%COMP%]{flex-wrap:wrap}.btn-add[_ngcontent-%COMP%]{width:100%;margin-bottom:0}}"]})}}return o})();export{Ce as a};

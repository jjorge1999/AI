import{a as n,d as g}from"./chunk-IO3I47CY.js";import{O as l,T as c,j as i}from"./chunk-K7VUYT6X.js";var j=(()=>{class r{constructor(e){this.http=e,this.apiUrl=g.apiUrl,this.logsSubject=new i([]),this.logs$=this.logsSubject.asObservable(),this.fetchLogs()}getCurrentUserId(){return localStorage.getItem("jjm_user_id")||"guest"}fetchLogs(){let e=this.getCurrentUserId();this.http.get(`${this.apiUrl}/logs?limit=200&userId=${e}`).subscribe({next:t=>this.logsSubject.next(t),error:t=>console.error("Error fetching logs:",t)})}logActivity(e,t,a,h,u){let o={action:e,entityType:t,entityId:a,entityName:h,details:u,userId:this.getCurrentUserId()};console.log("Logging activity:",o),this.http.post(`${this.apiUrl}/logs`,o).subscribe({next:s=>{console.log("Activity logged successfully:",s);let p=this.logsSubject.value;this.logsSubject.next([s,...p])},error:s=>{console.error("Error logging activity:",s),console.error("Failed log data:",o)}})}getLogs(){return this.logs$}refreshLogs(){this.fetchLogs()}cleanupOldLogs(){return this.http.post(`${this.apiUrl}/cleanup-logs`,{})}static{this.\u0275fac=function(t){return new(t||r)(c(n))}}static{this.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{j as a};

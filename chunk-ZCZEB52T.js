import{h as T,l as R}from"./chunk-2QKCGDE5.js";import{a as j}from"./chunk-6KUWSICS.js";import{b as z,c as N,f as L,p as F}from"./chunk-WU6DJJUB.js";import{Ab as E,Ba as s,Bb as I,Ca as y,Ra as f,Ta as d,Ua as _,Va as C,Ya as n,Za as o,_ as k,_a as O,ac as V,bb as v,bc as D,cb as u,db as l,dc as G,ga as p,ha as g,ic as B,lb as r,mb as x,nb as b,qb as P,rb as M,sb as w,ub as S}from"./chunk-TA5RWKR2.js";import"./chunk-7QOE2ANW.js";function Y(a,m){if(a&1&&(n(0,"div",7)(1,"span",8),r(2,"Credits"),o(),n(3,"span",9),r(4),o()()),a&2){let e=l();s(4),x(e.credits)}}function A(a,m){if(a&1&&(n(0,"div",17),r(1),o()),a&2){let e=l(2);s(),b(" ",e.verificationError," ")}}function K(a,m){if(a&1){let e=v();n(0,"div",10)(1,"div",11)(2,"h2"),r(3,"\u{1F512} Customer Verification"),o(),n(4,"p"),r(5,"Only registered customers can play."),o(),n(6,"div",12)(7,"label"),r(8,"Enter your Full Name"),o(),n(9,"input",13),w("ngModelChange",function(i){p(e);let c=l();return M(c.verificationName,i)||(c.verificationName=i),g(i)}),u("keyup.enter",function(){p(e);let i=l();return g(i.verifyCustomer())}),o()(),n(10,"div",12)(11,"label"),r(12,"Enter Phone Number"),o(),n(13,"input",14),w("ngModelChange",function(i){p(e);let c=l();return M(c.verificationPhone,i)||(c.verificationPhone=i),g(i)}),u("keyup.enter",function(){p(e);let i=l();return g(i.verifyCustomer())}),o()(),f(14,A,2,1,"div",15),n(15,"button",16),u("click",function(){p(e);let i=l();return g(i.verifyCustomer())}),r(16),o()()()}if(a&2){let e=l();s(9),P("ngModel",e.verificationName),d("disabled",e.isLoadingCustomers),s(4),P("ngModel",e.verificationPhone),d("disabled",e.isLoadingCustomers),s(),d("ngIf",e.verificationError),s(),d("disabled",e.isLoadingCustomers),s(),b(" ",e.isLoadingCustomers?"Checking...":"Verify & Play"," ")}}function H(a,m){if(a&1&&(n(0,"div",31),r(1),o()),a&2){let e=l(2);s(),b(" ",e.dailyBonusMessage," ")}}function $(a,m){if(a&1&&O(0,"div",32),a&2){let e=m.$implicit,t=l(2);_("background-color",t.getColorHex(e))("color",e==="white"||e==="yellow"?"black":"white")}}function J(a,m){if(a&1&&(n(0,"span",38),r(1),o()),a&2){let e=l().$implicit,t=l(2);s(),x(t.bets[e])}}function U(a,m){if(a&1){let e=v();n(0,"div",33),u("click",function(){let i=p(e).$implicit,c=l(2);return g(c.placeBet(i,10))}),n(1,"div",34)(2,"span",35),r(3),E(4,"titlecase"),o(),f(5,J,2,1,"span",36),o(),n(6,"div",37),r(7,"Tap to Bet +10"),o()()}if(a&2){let e=m.$implicit,t=l(2);_("background-color",t.getColorHex(e))("border-color",t.getColorHex(e)),s(),_("color",e==="white"||e==="yellow"?"black":"white"),s(2),x(I(4,8,e)),s(2),d("ngIf",t.bets[e]>0)}}function q(a,m){if(a&1){let e=v();n(0,"div"),f(1,H,2,1,"div",18),n(2,"div",19)(3,"div",20),f(4,$,1,4,"div",21),o(),n(5,"div",22),r(6),o(),n(7,"div",23),f(8,U,8,10,"div",24),o(),n(9,"div",25)(10,"div",26),r(11," Total Bet: "),n(12,"strong"),r(13),o()(),n(14,"div",27)(15,"button",28),u("click",function(){p(e);let i=l();return g(i.clearBets())}),r(16,"Clear Bets"),o(),n(17,"button",29),u("click",function(){p(e);let i=l();return g(i.rollDice())}),r(18,"ROLL!"),o()()()(),n(19,"div",30)(20,"h3"),r(21,"How to Play"),o(),n(22,"p"),r(23,"1. You get "),n(24,"strong"),r(25,"100 Free Credits"),o(),r(26," every day!"),o(),n(27,"p"),r(28,"2. Tap a color to bet 10 credits."),o(),n(29,"p"),r(30,"3. If your color appears on the dice:"),o(),n(31,"ul")(32,"li"),r(33,"1 Match = Win 1x (+Stake)"),o(),n(34,"li"),r(35,"2 Matches = Win 2x (+Stake)"),o(),n(36,"li"),r(37,"3 Matches = Win 3x (+Stake)"),o()()()()}if(a&2){let e=l();s(),d("ngIf",e.dailyBonusMessage),s(2),C("shaking",e.isRolling),s(),d("ngForOf",e.result),s(),C("win",e.message.includes("won")),s(),b(" ",e.message||(e.isRolling?"Rolling...":"Place your bets!")," "),s(),C("disabled",e.isRolling),s(),d("ngForOf",e.colors),s(5),x(e.totalBet),s(2),d("disabled",e.isRolling||e.totalBet===0),s(2),d("disabled",e.isRolling||e.totalBet===0)}}var re=(()=>{class a{get storageKeyCredits(){return`color_game_credits_${this.sanitizedName}`}get storageKeyLastDaily(){return`color_game_last_daily_${this.sanitizedName}`}get sanitizedName(){return(this.verificationName||"guest").trim().toLowerCase().replace(/\s+/g,"_")}constructor(e,t){this.router=e,this.customerService=t,this.credits=0,this.bets={red:0,green:0,blue:0,yellow:0,white:0,pink:0},this.colors=["red","green","blue","yellow","white","pink"],this.result=["white","white","white"],this.isRolling=!1,this.message="",this.dailyBonusMessage="",this.isVerified=!1,this.verificationName="",this.verificationPhone="",this.verificationError="",this.isLoadingCustomers=!1,this.currentCustomerId="",this.currentCustomer=null}goBack(){this.router.navigate(["/login"])}ngOnInit(){this.checkAutoVerification()}checkAutoVerification(){let e=localStorage.getItem("chatCustomerInfo");if(e)try{let t=JSON.parse(e);if(t&&t.name){this.verificationName=t.name;let i=t.phoneNumber||t.phone||"";i&&(this.verificationPhone=i,this.verifyCustomer())}}catch(t){console.error("Error parsing auto-verification info",t)}}verifyCustomer(){if(!this.verificationName.trim()){this.verificationError="Please enter your name.";return}if(!this.verificationPhone.trim()){this.verificationError="Please enter your phone number.";return}this.isLoadingCustomers=!0,this.verificationError="";let e=this.verificationName.trim();this.customerService.getCustomerByName(e).subscribe({next:t=>{this.isLoadingCustomers=!1;let i=t.find(c=>c.name.toLowerCase()===e.toLowerCase());if(i){let c=this.verificationPhone.replace(/\D/g,"").slice(-8),h=(i.phoneNumber||"").replace(/\D/g,"").slice(-8);if(c!==h){this.isVerified=!1,this.verificationError="Verification failed: Phone number mismatch.";return}this.isVerified=!0,this.currentCustomerId=i.id,this.currentCustomer=i,this.verificationError="",this.loadGameData()}else this.isVerified=!1,this.verificationError="Access Denied: Customer not found. Please check your spelling."},error:t=>{console.error("Verification failed",t),this.isLoadingCustomers=!1,this.verificationError="Verification service unavailable."}})}loadGameData(){this.isVerified&&(this.currentCustomer&&this.currentCustomer.credits!==void 0&&this.currentCustomer.credits!==null?(this.credits=this.currentCustomer.credits,localStorage.setItem(this.storageKeyCredits,this.credits.toString())):(console.log("New player detected, giving 100 welcome credits"),this.credits=100,this.message="Welcome! You received 100 Free Credits!",this.saveGameData()))}saveGameData(){this.isVerified&&(localStorage.setItem(this.storageKeyCredits,this.credits.toString()),this.currentCustomerId&&this.customerService.updateCustomer(this.currentCustomerId,{credits:this.credits}).subscribe({error:e=>console.error("Failed to sync credits to database:",e)}))}checkDailyBonus(){if(!this.isVerified)return;let e=localStorage.getItem(this.storageKeyLastDaily),t=new Date().toDateString();e!==t&&(this.credits+=100,localStorage.setItem(this.storageKeyLastDaily,t),this.saveGameData(),this.dailyBonusMessage="\u{1F389} You received 100 Daily Free Credits!",setTimeout(()=>this.dailyBonusMessage="",5e3))}placeBet(e,t){this.isRolling||(this.credits>=t?(this.credits-=t,this.bets[e]+=t,this.saveGameData()):(this.message="Not enough credits!",setTimeout(()=>this.message="",2e3)))}clearBets(){if(this.isRolling)return;let e=0;this.colors.forEach(t=>{e+=this.bets[t],this.bets[t]=0}),this.credits+=e,this.saveGameData()}get totalBet(){return Object.values(this.bets).reduce((e,t)=>e+t,0)}rollDice(){if(this.totalBet===0){this.message="Place a bet first!",setTimeout(()=>this.message="",2e3);return}if(this.isRolling)return;this.isRolling=!0,this.message="";let e=0,t=20,i=setInterval(()=>{this.result=[this.getRandomColor(),this.getRandomColor(),this.getRandomColor()],e++,e>=t&&(clearInterval(i),this.finalizeRoll())},100)}getRandomColor(){let e=new Uint32Array(1);window.crypto.getRandomValues(e);let t=e[0]%this.colors.length;return this.colors[t]}finalizeRoll(){this.isRolling=!1;let e=0,t={red:0,green:0,blue:0,yellow:0,white:0,pink:0};this.result.forEach(i=>t[i]++),this.colors.forEach(i=>{let c=this.bets[i],h=t[i];if(c>0&&h>0){let W=c*h+c;e+=W}}),e>0?(this.credits+=e,this.message=`You won ${e} credits! \u{1F389}`):this.message="Better luck next time!",this.colors.forEach(i=>this.bets[i]=0),this.saveGameData()}getColorHex(e){return{red:"#ef4444",green:"#22c55e",blue:"#3b82f6",yellow:"#eab308",white:"#ffffff",pink:"#ec4899"}[e]}static{this.\u0275fac=function(t){return new(t||a)(y(T),y(j))}}static{this.\u0275cmp=k({type:a,selectors:[["app-color-game"]],standalone:!0,features:[S],decls:10,vars:3,consts:[[1,"game-container"],[1,"header"],[2,"display","flex","align-items","center","gap","10px"],["title","Back to Login",1,"btn","img-btn",3,"click"],["class","credits-box",4,"ngIf"],["class","verification-container",4,"ngIf"],[4,"ngIf"],[1,"credits-box"],[1,"label"],[1,"value"],[1,"verification-container"],[1,"verification-card"],[1,"form-group"],["type","text","placeholder","e.g. John Doe",1,"verify-input",3,"ngModelChange","keyup.enter","ngModel","disabled"],["type","tel","placeholder","e.g. 09171234567",1,"verify-input",3,"ngModelChange","keyup.enter","ngModel","disabled"],["class","error-msg",4,"ngIf"],[1,"btn-verify",3,"click","disabled"],[1,"error-msg"],["class","daily-bonus-alert",4,"ngIf"],[1,"game-area"],[1,"dice-container"],["class","die",3,"background-color","color",4,"ngFor","ngForOf"],[1,"message-area"],[1,"betting-board"],["class","bet-tile",3,"background-color","border-color","click",4,"ngFor","ngForOf"],[1,"controls"],[1,"bet-summary"],[1,"buttons"],[1,"btn","btn-clear",3,"click","disabled"],[1,"btn","btn-roll",3,"click","disabled"],[1,"instructions"],[1,"daily-bonus-alert"],[1,"die"],[1,"bet-tile",3,"click"],[1,"bet-overlay"],[1,"bet-name"],["class","bet-amount",4,"ngIf"],[1,"click-hint"],[1,"bet-amount"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),u("click",function(){return i.goBack()}),r(4,"\u21A9\uFE0F"),o(),n(5,"h1"),r(6,"\u{1F3B2} Color Game"),o()(),f(7,Y,5,1,"div",4),o(),f(8,K,17,7,"div",5)(9,q,38,13,"div",6),o()),t&2&&(s(7),d("ngIf",i.isVerified),s(),d("ngIf",!i.isVerified),s(),d("ngIf",i.isVerified))},dependencies:[B,V,D,G,F,z,N,L,R],styles:[".game-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px;min-height:100vh;min-height:100dvh;background:linear-gradient(135deg,#1e293b,#0f172a);color:#fff;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;box-sizing:border-box}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid rgba(255,255,255,.1)}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.8rem;background:linear-gradient(to right,#fbbf24,#f59e0b);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}.credits-box[_ngcontent-%COMP%]{background:#ffffff1a;padding:10px 20px;border-radius:12px;display:flex;flex-direction:column;align-items:flex-end;border:1px solid rgba(255,255,255,.1)}.credits-box[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.8rem;color:#94a3b8;text-transform:uppercase;letter-spacing:1px}.credits-box[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#fbbf24}.daily-bonus-alert[_ngcontent-%COMP%]{background:linear-gradient(to right,#10b981,#059669);padding:15px;border-radius:12px;text-align:center;margin-bottom:20px;font-weight:700;animation:_ngcontent-%COMP%_slideDown .5s ease-out;box-shadow:0 4px 6px -1px #0000001a}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.game-area[_ngcontent-%COMP%]{background:#1e293b80;border-radius:20px;padding:20px;border:1px solid rgba(255,255,255,.05);box-shadow:0 10px 15px -3px #0000001a}.dice-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;margin-bottom:30px;padding:20px;background:#0003;border-radius:16px;min-height:100px;align-items:center}.dice-container.shaking[_ngcontent-%COMP%]   .die[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .1s infinite}@keyframes _ngcontent-%COMP%_shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}.die[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:16px;box-shadow:inset 0 0 20px #0003,0 5px 10px #0000004d;transition:background-color .2s;display:flex;align-items:center;justify-content:center;font-size:2rem}.message-area[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;margin-bottom:20px;min-height:30px;color:#94a3b8;font-weight:500}.message-area.win[_ngcontent-%COMP%]{color:#fbbf24;font-weight:700;animation:_ngcontent-%COMP%_popIn .3s cubic-bezier(.175,.885,.32,1.275)}@keyframes _ngcontent-%COMP%_popIn{0%{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}.betting-board[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-bottom:30px;transition:opacity .3s}.betting-board.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.bet-tile[_ngcontent-%COMP%]{aspect-ratio:1;border-radius:16px;position:relative;cursor:pointer;transition:transform .1s,filter .2s;border:4px solid transparent;box-shadow:0 4px 6px -1px #0000001a;overflow:hidden}.bet-tile[_ngcontent-%COMP%]:active{transform:scale(.95)}.bet-tile[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}.bet-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;background:#0000001a;text-shadow:0 2px 4px rgba(0,0,0,.5);font-weight:700}.bet-name[_ngcontent-%COMP%]{font-size:1rem;text-transform:uppercase;margin-bottom:5px}.bet-amount[_ngcontent-%COMP%]{font-size:1.5rem;background:#0009;padding:2px 10px;border-radius:20px;color:#fff}.click-hint[_ngcontent-%COMP%]{position:absolute;bottom:5px;left:0;width:100%;text-align:center;font-size:.7rem;opacity:.7;pointer-events:none}.controls[_ngcontent-%COMP%]{background:#0003;padding:20px;border-radius:16px;display:flex;flex-direction:column;gap:15px}.bet-summary[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1.1rem;padding:0 10px;color:#cbd5e1}.buttons[_ngcontent-%COMP%]{display:flex;gap:15px}.btn[_ngcontent-%COMP%]{flex:1;padding:15px;border:none;border-radius:12px;font-size:1.1rem;font-weight:700;cursor:pointer;transition:transform .1s,filter .2s;text-transform:uppercase;letter-spacing:1px}.btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-clear[_ngcontent-%COMP%]{background:#475569;color:#fff}.btn-roll[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff;box-shadow:0 4px 6px -1px #f59e0b4d}.btn-roll[_ngcontent-%COMP%]:hover:not(:disabled){filter:brightness(1.1)}.instructions[_ngcontent-%COMP%]{margin-top:40px;padding:20px;background:#ffffff0d;border-radius:16px;color:#94a3b8}.instructions[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;margin-top:0}.instructions[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px}.instructions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px}@media (max-width: 480px){.dice-container[_ngcontent-%COMP%]{gap:10px}.die[_ngcontent-%COMP%]{width:60px;height:60px}}.img-btn[_ngcontent-%COMP%]{background:#ffffff1a;padding:10px;border-radius:50%;border:1px solid rgba(255,255,255,.2);cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;width:40px;height:40px;font-size:1.2rem;line-height:normal}.img-btn[_ngcontent-%COMP%]:hover{background:#fff3;transform:scale(1.1)}.verification-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:40px 20px;animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.verification-card[_ngcontent-%COMP%]{background:#1e293bcc;border:1px solid rgba(255,255,255,.1);border-radius:20px;padding:30px;max-width:400px;width:100%;text-align:center;box-shadow:0 10px 25px -5px #0000004d;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.verification-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fbbf24;margin-top:0;margin-bottom:10px}.verification-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8;margin-bottom:25px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:left}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:#e2e8f0;margin-bottom:8px;font-size:.9rem}.verify-input[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,.2);background:#0003;color:#fff;font-size:1rem;box-sizing:border-box;transition:all .2s}.verify-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#fbbf24;background:#0000004d}.btn-verify[_ngcontent-%COMP%]{width:100%;padding:12px;border:none;border-radius:10px;background:linear-gradient(135deg,#fbbf24,#d97706);color:#fff;font-weight:700;font-size:1rem;cursor:pointer;transition:transform .1s,filter .2s}.btn-verify[_ngcontent-%COMP%]:hover:not(:disabled){filter:brightness(1.1);transform:translateY(-1px)}.btn-verify[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-verify[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed;background:#64748b}.error-msg[_ngcontent-%COMP%]{color:#ef4444;background:#ef44441a;padding:10px;border-radius:8px;margin-bottom:15px;font-size:.9rem;display:flex;align-items:center;justify-content:center;gap:8px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]})}}return a})();export{re as ColorGameComponent};

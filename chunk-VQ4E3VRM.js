import{a as J}from"./chunk-YBL43BVC.js";import{a as K}from"./chunk-5TFQBXGH.js";import{b as j,e as R,h as $,i as q,j as G,n as H}from"./chunk-ZPQL42FH.js";import{$a as k,Ca as _,Ea as s,Ia as n,Ja as t,La as P,Ma as f,Na as v,Ra as A,Sa as a,Ta as u,Ua as x,Va as I,X as T,Xa as w,Ya as M,Za as O,a as L,ab as C,b as E,bb as S,c as h,cb as F,da as p,ea as g,eb as D,sa as o,ta as b,tb as V,ub as z,vb as N,wb as B,zb as W}from"./chunk-K7VUYT6X.js";function Q(i,c){if(i&1&&(n(0,"option",18),a(1),C(2,"titlecase"),t()),i&2){let e=c.$implicit;s("value",e),o(),x(" ",S(2,2,e)," ")}}function U(i,c){if(i&1&&(n(0,"option",18),a(1),C(2,"titlecase"),t()),i&2){let e=c.$implicit;s("value",e),o(),x(" ",S(2,2,e)," ")}}function X(i,c){if(i&1&&(n(0,"span",33),a(1),t()),i&2){let e=v().$implicit;o(),x("\u2022 ",e.details,"")}}function Y(i,c){if(i&1&&(n(0,"div",21)(1,"div",22)(2,"span",23),a(3),t(),n(4,"span",24),a(5),t()(),n(6,"div",25)(7,"div",26)(8,"span",27),a(9),t(),n(10,"span",28),a(11),t()(),n(12,"div",29)(13,"span",30),a(14),t(),_(15,X,2,1,"span",31),t()(),n(16,"div",32),a(17),C(18,"date"),t()()),i&2){let e=c.$implicit,l=v(2);o(3),u(l.getEntityIcon(e.entityType)),o(2),u(l.getActionIcon(e.action)),o(4),u(e.entityName),o(2),u(e.action),o(3),u(e.entityType),o(),s("ngIf",e.details),o(2),x(" ",F(18,7,e==null?null:e.timestamp,"medium")," ")}}function Z(i,c){if(i&1&&(n(0,"div",19),_(1,Y,19,10,"div",20),t()),i&2){let e=v();o(),s("ngForOf",e.paginatedLogs)}}function ee(i,c){i&1&&(n(0,"div",34)(1,"p"),a(2,"No activity logs found"),t()())}function te(i,c){if(i&1){let e=P();n(0,"div",35)(1,"button",36),f("click",function(){p(e);let r=v();return g(r.prevPage())}),a(2," \u2190 Prev "),t(),n(3,"span",37),a(4),t(),n(5,"button",36),f("click",function(){p(e);let r=v();return g(r.nextPage())}),a(6," Next \u2192 "),t()()}if(i&2){let e=v();o(),s("disabled",e.currentPage===1),o(3),I(" Page ",e.currentPage," of ",e.totalPages," "),o(),s("disabled",e.currentPage===e.totalPages)}}var ce=(()=>{class i{constructor(e,l){this.loggingService=e,this.dialogService=l,this.logs=[],this.filteredLogs=[],this.selectedEntityType="all",this.selectedAction="all",this.currentPage=1,this.pageSize=20,this.entityTypes=["all","product","sale","expense","customer"],this.actions=["all","create","update","delete","restock","complete"]}ngOnInit(){this.loggingService.getLogs().subscribe(e=>{this.logs=e.map(l=>E(L({},l),{timestamp:new Date(l.timestamp?._seconds*1e3||new Date)})),this.applyFilters()})}applyFilters(){this.filteredLogs=this.logs.filter(e=>{let l=this.selectedEntityType==="all"||e.entityType===this.selectedEntityType,r=this.selectedAction==="all"||e.action===this.selectedAction;return l&&r}),this.currentPage=1}get paginatedLogs(){let e=(this.currentPage-1)*this.pageSize,l=e+this.pageSize;return this.filteredLogs.slice(e,l)}get totalPages(){return Math.ceil(this.filteredLogs.length/this.pageSize)}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}prevPage(){this.currentPage>1&&this.currentPage--}refreshLogs(){this.loggingService.refreshLogs()}cleanupOldLogs(){return h(this,null,function*(){(yield this.dialogService.confirm("This will delete all logs older than 30 days. Continue?","Cleanup Logs"))&&this.loggingService.cleanupOldLogs().subscribe({next:e=>h(this,null,function*(){yield this.dialogService.success(`Cleanup completed! Deleted ${e.deletedCount} logs.`),this.refreshLogs()}),error:e=>h(this,null,function*(){console.error("Cleanup error:",e),yield this.dialogService.error("Failed to cleanup logs")})})})}getActionIcon(e){return{create:"\u2795",update:"\u270F\uFE0F",delete:"\u{1F5D1}\uFE0F",restock:"\u{1F4E6}",complete:"\u2705"}[e]||"\u{1F4DD}"}getEntityIcon(e){return{product:"\u{1F4E6}",sale:"\u{1F4B0}",expense:"\u{1F4B8}",customer:"\u{1F464}"}[e]||"\u{1F4C4}"}static{this.\u0275fac=function(l){return new(l||i)(b(J),b(K))}}static{this.\u0275cmp=T({type:i,selectors:[["app-activity-logs"]],standalone:!0,features:[k],decls:29,vars:8,consts:[["noLogs",""],[1,"activity-logs-section"],[1,"card"],[1,"header-section"],[1,"icon"],[1,"badge"],[1,"header-actions"],[1,"btn-refresh",3,"click"],[1,"btn-cleanup",3,"click"],[1,"filters-section"],[1,"filter-group"],["for","entityFilter"],["id","entityFilter",1,"filter-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","actionFilter"],["id","actionFilter",1,"filter-select",3,"ngModelChange","change","ngModel"],["class","logs-list",4,"ngIf","ngIfElse"],["class","pagination",4,"ngIf"],[3,"value"],[1,"logs-list"],["class","log-item",4,"ngFor","ngForOf"],[1,"log-item"],[1,"log-icon"],[1,"entity-icon"],[1,"action-icon"],[1,"log-info"],[1,"log-header"],[1,"log-entity"],[1,"log-action-badge"],[1,"log-details"],[1,"log-type"],["class","log-description",4,"ngIf"],[1,"log-timestamp"],[1,"log-description"],[1,"empty-state"],[1,"pagination"],[1,"pagination-btn",3,"click","disabled"],[1,"page-info"]],template:function(l,r){if(l&1){let d=P();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h3")(4,"span",4),a(5,"\u{1F4CB}"),t(),a(6," Activity Logs "),n(7,"span",5),a(8),t()(),n(9,"div",6)(10,"button",7),f("click",function(){return p(d),g(r.refreshLogs())}),a(11," \u{1F504} Refresh "),t(),n(12,"button",8),f("click",function(){return p(d),g(r.cleanupOldLogs())}),a(13," \u{1F5D1}\uFE0F Cleanup Old Logs "),t()()(),n(14,"div",9)(15,"div",10)(16,"label",11),a(17,"Entity Type:"),t(),n(18,"select",12),O("ngModelChange",function(m){return p(d),M(r.selectedEntityType,m)||(r.selectedEntityType=m),g(m)}),f("change",function(){return p(d),g(r.applyFilters())}),_(19,Q,3,4,"option",13),t()(),n(20,"div",10)(21,"label",14),a(22,"Action:"),t(),n(23,"select",15),O("ngModelChange",function(m){return p(d),M(r.selectedAction,m)||(r.selectedAction=m),g(m)}),f("change",function(){return p(d),g(r.applyFilters())}),_(24,U,3,4,"option",13),t()()(),_(25,Z,2,1,"div",16)(26,ee,3,0,"ng-template",null,0,D)(28,te,7,4,"div",17),t()()}if(l&2){let d=A(27);o(8),u(r.filteredLogs.length),o(10),w("ngModel",r.selectedEntityType),o(),s("ngForOf",r.entityTypes),o(4),w("ngModel",r.selectedAction),o(),s("ngForOf",r.actions),o(),s("ngIf",r.paginatedLogs.length>0)("ngIfElse",d),o(3),s("ngIf",r.totalPages>1)}},dependencies:[W,V,z,N,B,H,q,G,$,j,R],styles:[".activity-logs-section[_ngcontent-%COMP%]{padding:var(--space-lg)}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-lg);flex-wrap:wrap;gap:var(--space-md)}.header-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm)}.btn-refresh[_ngcontent-%COMP%], .btn-cleanup[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md);border:1px solid var(--color-border);background:var(--color-surface);color:var(--color-text);border-radius:var(--radius-md);cursor:pointer;font-size:.875rem;font-weight:500;transition:all var(--transition-base)}.btn-refresh[_ngcontent-%COMP%]:hover{background:var(--color-primary);color:#fff;border-color:var(--color-primary)}.btn-cleanup[_ngcontent-%COMP%]{background:var(--color-danger);color:#fff;border-color:var(--color-danger)}.btn-cleanup[_ngcontent-%COMP%]:hover{background:#dc2626}.filters-section[_ngcontent-%COMP%]{display:flex;gap:var(--space-lg);margin-bottom:var(--space-lg);padding:var(--space-md);background:var(--color-bg);border-radius:var(--radius-md);flex-wrap:wrap}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm)}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text)}.filter-select[_ngcontent-%COMP%]{padding:var(--space-xs) var(--space-sm);border:1px solid var(--color-border);border-radius:var(--radius-md);background:var(--color-surface);color:var(--color-text);font-size:.875rem;cursor:pointer}.logs-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.log-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);padding:8px 12px;background:var(--color-bg);border-radius:var(--radius-sm);border:1px solid var(--color-border);transition:all var(--transition-base)}.log-item[_ngcontent-%COMP%]:hover{background:var(--color-surface);transform:translate(2px)}.log-icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:4px;font-size:1rem;min-width:40px;justify-content:center}.entity-icon[_ngcontent-%COMP%]{font-size:1.1rem}.action-icon[_ngcontent-%COMP%]{font-size:.9rem}.log-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:row;align-items:center;gap:var(--space-sm);flex-wrap:wrap}.log-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-xs)}.log-entity[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text);font-size:.9rem}.log-action-badge[_ngcontent-%COMP%]{padding:1px 6px;background:var(--color-primary);color:#fff;border-radius:var(--radius-sm);font-size:.7rem;font-weight:500;text-transform:uppercase}.log-details[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-xs);font-size:.85rem;color:var(--color-text-muted)}.log-type[_ngcontent-%COMP%]{text-transform:capitalize;font-weight:500}.log-description[_ngcontent-%COMP%]{font-style:italic;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:400px}.log-timestamp[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted);white-space:nowrap}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:var(--space-2xl);color:var(--color-text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:var(--space-md);margin-top:var(--space-lg);padding-top:var(--space-lg);border-top:1px solid var(--color-border)}.pagination-btn[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md);background:var(--color-surface);border:1px solid var(--color-border);color:var(--color-text);border-radius:var(--radius-md);font-size:.875rem;font-weight:500;cursor:pointer;transition:all var(--transition-base)}.pagination-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--color-primary);color:#fff;border-color:var(--color-primary)}.pagination-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.page-info[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text);font-weight:500}@media (max-width: 768px){.header-section[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.filters-section[_ngcontent-%COMP%]{flex-direction:column}.log-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.log-timestamp[_ngcontent-%COMP%]{align-self:flex-end}}"]})}}return i})();export{ce as a};

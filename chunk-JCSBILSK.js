import{A as Yt,B as Jt,C as en,D as At,E as rt,F as bt,G as Le,H as wt,I as tn,J as yt,M as Ke,N as nn,O as rn,P as sn,R as on,c as jt,e as _t,f as $t,g as Wt,h as Gt,o as Vt,u as De,v as Xt,y as Kt,z as Zt}from"./chunk-GUVN6CVQ.js";import{M as qt,R as Qt,g as zt}from"./chunk-GVCJ4KOK.js";import{a as Pe,b as Xe,g as ue}from"./chunk-7QOE2ANW.js";var pn="firebasestorage.googleapis.com",gn="storageBucket",Kn=2*60*1e3,Zn=10*60*1e3,Yn=1e3;var Z=class s extends Vt{constructor(n,a,r=0){super(vt(n),`Firebase Storage: ${a} (${vt(n)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,s.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return vt(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},K=function(s){return s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment",s}(K||{});function vt(s){return"storage/"+s}function xt(){let s="An unknown error occurred, please check the error payload for server response.";return new Z(K.UNKNOWN,s)}function Jn(s){return new Z(K.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function er(s){return new Z(K.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function tr(){let s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Z(K.UNAUTHENTICATED,s)}function nr(){return new Z(K.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function rr(s){return new Z(K.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function mn(){return new Z(K.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _n(){return new Z(K.CANCELED,"User canceled the upload/download.")}function sr(s){return new Z(K.INVALID_URL,"Invalid URL '"+s+"'.")}function ir(s){return new Z(K.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function or(){return new Z(K.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+gn+"' property when initializing the app?")}function An(){return new Z(K.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ar(){return new Z(K.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function lr(){return new Z(K.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function cr(s){return new Z(K.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rt(s){return new Z(K.INVALID_ARGUMENT,s)}function bn(){return new Z(K.APP_DELETED,"The Firebase app was deleted.")}function ur(s){return new Z(K.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ye(s,n){return new Z(K.INVALID_FORMAT,"String does not match format '"+s+"': "+n)}function Ze(s){throw new Z(K.INTERNAL_ERROR,"Internal error: "+s)}var _e=class s{constructor(n,a){this.bucket=n,this.path_=a}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,a){let r;try{r=s.makeFromUrl(n,a)}catch{return new s(n,"")}if(r.path==="")return r;throw ir(n)}static makeFromUrl(n,a){let r=null,e="([A-Za-z0-9.\\-_]+)";function t(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}let l="(/(.*))?$",u=new RegExp("^gs://"+e+l,"i"),g={bucket:1,path:3};function b(S){S.path_=decodeURIComponent(S.path)}let o="v[A-Za-z0-9_]+",c=a.replace(/[.]/g,"\\."),i="(/([^?#]*).*)?$",f=new RegExp(`^https?://${c}/${o}/b/${e}/o${i}`,"i"),_={bucket:1,path:3},R=a===pn?"(?:storage.googleapis.com|storage.cloud.google.com)":a,k="([^?#]*)",w=new RegExp(`^https?://${R}/${e}/${k}`,"i"),x=[{regex:u,indices:g,postModify:t},{regex:f,indices:_,postModify:b},{regex:w,indices:{bucket:1,path:2},postModify:b}];for(let S=0;S<x.length;S++){let B=x[S],A=B.regex.exec(n);if(A){let F=A[B.indices.bucket],d=A[B.indices.path];d||(d=""),r=new s(F,d),B.postModify(r);break}}if(r==null)throw sr(n);return r}},Ut=class{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}};function fr(s,n,a){let r=1,e=null,t=null,l=!1,u=0;function g(){return u===2}let b=!1;function o(...k){b||(b=!0,n.apply(null,k))}function c(k){e=setTimeout(()=>{e=null,s(f,g())},k)}function i(){t&&clearTimeout(t)}function f(k,...w){if(b){i();return}if(k){i(),o.call(null,k,...w);return}if(g()||l){i(),o.call(null,k,...w);return}r<64&&(r*=2);let x;u===1?(u=2,x=0):x=(r+Math.random())*1e3,c(x)}let _=!1;function R(k){_||(_=!0,i(),!b&&(e!==null?(k||(u=2),clearTimeout(e),c(0)):k||(u=1)))}return c(0),t=setTimeout(()=>{l=!0,R(!0)},a),R}function hr(s){s(!1)}function dr(s){return s!==void 0}function pr(s){return typeof s=="function"}function gr(s){return typeof s=="object"&&!Array.isArray(s)}function at(s){return typeof s=="string"||s instanceof String}function an(s){return Ft()&&s instanceof Blob}function Ft(){return typeof Blob<"u"}function ln(s,n,a,r){if(r<n)throw Rt(`Invalid value for '${s}'. Expected ${n} or greater.`);if(r>a)throw Rt(`Invalid value for '${s}'. Expected ${a} or less.`)}function $e(s,n,a){let r=n;return a==null&&(r=`https://${n}`),`${a}://${r}/v0${s}`}function wn(s){let n=encodeURIComponent,a="?";for(let r in s)if(s.hasOwnProperty(r)){let e=n(r)+"="+n(s[r]);a=a+e+"&"}return a=a.slice(0,-1),a}var qe=function(s){return s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT",s}(qe||{});function yn(s,n){let a=s>=500&&s<600,e=[408,429].indexOf(s)!==-1,t=n.indexOf(s)!==-1;return a||e||t}var Tt=class{constructor(n,a,r,e,t,l,u,g,b,o,c,i=!0,f=!1){this.url_=n,this.method_=a,this.headers_=r,this.body_=e,this.successCodes_=t,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=g,this.timeout_=b,this.progressCallback_=o,this.connectionFactory_=c,this.retry=i,this.isUsingEmulator=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,R)=>{this.resolve_=_,this.reject_=R,this.start_()})}start_(){let n=(r,e)=>{if(e){r(!1,new ze(!1,null,!0));return}let t=this.connectionFactory_();this.pendingConnection_=t;let l=u=>{let g=u.loaded,b=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,b)};this.progressCallback_!==null&&t.addUploadProgressListener(l),t.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&t.removeUploadProgressListener(l),this.pendingConnection_=null;let u=t.getErrorCode()===qe.NO_ERROR,g=t.getStatus();if(!u||yn(g,this.additionalRetryCodes_)&&this.retry){let o=t.getErrorCode()===qe.ABORT;r(!1,new ze(!1,null,o));return}let b=this.successCodes_.indexOf(g)!==-1;r(!0,new ze(b,t))})},a=(r,e)=>{let t=this.resolve_,l=this.reject_,u=e.connection;if(e.wasSuccessCode)try{let g=this.callback_(u,u.getResponse());dr(g)?t(g):t()}catch(g){l(g)}else if(u!==null){let g=xt();g.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,g)):l(g)}else if(e.canceled){let g=this.appDelete_?bn():_n();l(g)}else{let g=mn();l(g)}};this.canceled_?a(!1,new ze(!1,null,!0)):this.backoffId_=fr(n,a,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,this.backoffId_!==null&&hr(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},ze=class{constructor(n,a,r){this.wasSuccessCode=n,this.connection=a,this.canceled=!!r}};function mr(s,n){n!==null&&n.length>0&&(s.Authorization="Firebase "+n)}function _r(s,n){s["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}function Ar(s,n){n&&(s["X-Firebase-GMPID"]=n)}function br(s,n){n!==null&&(s["X-Firebase-AppCheck"]=n)}function wr(s,n,a,r,e,t,l=!0,u=!1){let g=wn(s.urlParams),b=s.url+g,o=Object.assign({},s.headers);return Ar(o,n),mr(o,a),_r(o,t),br(o,r),new Tt(b,s.method,o,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,e,l,u)}function yr(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function vr(...s){let n=yr();if(n!==void 0){let a=new n;for(let r=0;r<s.length;r++)a.append(s[r]);return a.getBlob()}else{if(Ft())return new Blob(s);throw new Z(K.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Er(s,n,a){return s.webkitSlice?s.webkitSlice(n,a):s.mozSlice?s.mozSlice(n,a):s.slice?s.slice(n,a):null}function Rr(s){if(typeof atob>"u")throw cr("base-64");return atob(s)}var ye={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Je=class{constructor(n,a){this.data=n,this.contentType=a||null}};function Ur(s,n){switch(s){case ye.RAW:return new Je(vn(n));case ye.BASE64:case ye.BASE64URL:return new Je(En(s,n));case ye.DATA_URL:return new Je(kr(n),Sr(n))}throw xt()}function vn(s){let n=[];for(let a=0;a<s.length;a++){let r=s.charCodeAt(a);if(r<=127)n.push(r);else if(r<=2047)n.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(a<s.length-1&&(s.charCodeAt(a+1)&64512)===56320))n.push(239,191,189);else{let t=r,l=s.charCodeAt(++a);r=65536|(t&1023)<<10|l&1023,n.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?n.push(239,191,189):n.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(n)}function Tr(s){let n;try{n=decodeURIComponent(s)}catch{throw Ye(ye.DATA_URL,"Malformed data URL.")}return vn(n)}function En(s,n){switch(s){case ye.BASE64:{let e=n.indexOf("-")!==-1,t=n.indexOf("_")!==-1;if(e||t)throw Ye(s,"Invalid character '"+(e?"-":"_")+"' found: is it base64url encoded?");break}case ye.BASE64URL:{let e=n.indexOf("+")!==-1,t=n.indexOf("/")!==-1;if(e||t)throw Ye(s,"Invalid character '"+(e?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let a;try{a=Rr(n)}catch(e){throw e.message.includes("polyfill")?e:Ye(s,"Invalid character found")}let r=new Uint8Array(a.length);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e);return r}var it=class{constructor(n){this.base64=!1,this.contentType=null;let a=n.match(/^data:([^,]+)?,/);if(a===null)throw Ye(ye.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=a[1]||null;r!=null&&(this.base64=Ir(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=n.substring(n.indexOf(",")+1)}};function kr(s){let n=new it(s);return n.base64?En(ye.BASE64,n.rest):Tr(n.rest)}function Sr(s){return new it(s).contentType}function Ir(s,n){return s.length>=n.length?s.substring(s.length-n.length)===n:!1}var ot=class s{constructor(n,a){let r=0,e="";an(n)?(this.data_=n,r=n.size,e=n.type):n instanceof ArrayBuffer?(a?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),r=this.data_.length):n instanceof Uint8Array&&(a?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),r=n.length),this.size_=r,this.type_=e}size(){return this.size_}type(){return this.type_}slice(n,a){if(an(this.data_)){let r=this.data_,e=Er(r,n,a);return e===null?null:new s(e)}else{let r=new Uint8Array(this.data_.buffer,n,a-n);return new s(r,!0)}}static getBlob(...n){if(Ft()){let a=n.map(r=>r instanceof s?r.data_:r);return new s(vr.apply(null,a))}else{let a=n.map(l=>at(l)?Ur(ye.RAW,l).data:l.data_),r=0;a.forEach(l=>{r+=l.byteLength});let e=new Uint8Array(r),t=0;return a.forEach(l=>{for(let u=0;u<l.length;u++)e[t++]=l[u]}),new s(e,!0)}}uploadData(){return this.data_}};function Rn(s){let n;try{n=JSON.parse(s)}catch{return null}return gr(n)?n:null}function Cr(s){if(s.length===0)return null;let n=s.lastIndexOf("/");return n===-1?"":s.slice(0,n)}function xr(s,n){let a=n.split("/").filter(r=>r.length>0).join("/");return s.length===0?a:s+"/"+a}function Un(s){let n=s.lastIndexOf("/",s.length-2);return n===-1?s:s.slice(n+1)}function Fr(s,n){return n}var se=class{constructor(n,a,r,e){this.server=n,this.local=a||n,this.writable=!!r,this.xform=e||Fr}},st=null;function Or(s){return!at(s)||s.length<2?s:Un(s)}function Tn(){if(st)return st;let s=[];s.push(new se("bucket")),s.push(new se("generation")),s.push(new se("metageneration")),s.push(new se("name","fullPath",!0));function n(t,l){return Or(l)}let a=new se("name");a.xform=n,s.push(a);function r(t,l){return l!==void 0?Number(l):l}let e=new se("size");return e.xform=r,s.push(e),s.push(new se("timeCreated")),s.push(new se("updated")),s.push(new se("md5Hash",null,!0)),s.push(new se("cacheControl",null,!0)),s.push(new se("contentDisposition",null,!0)),s.push(new se("contentEncoding",null,!0)),s.push(new se("contentLanguage",null,!0)),s.push(new se("contentType",null,!0)),s.push(new se("metadata","customMetadata",!0)),st=s,st}function Pr(s,n){function a(){let r=s.bucket,e=s.fullPath,t=new _e(r,e);return n._makeStorageReference(t)}Object.defineProperty(s,"ref",{get:a})}function Br(s,n,a){let r={};r.type="file";let e=a.length;for(let t=0;t<e;t++){let l=a[t];r[l.local]=l.xform(r,n[l.server])}return Pr(r,s),r}function kn(s,n,a){let r=Rn(n);return r===null?null:Br(s,r,a)}function Mr(s,n,a,r){let e=Rn(n);if(e===null||!at(e.downloadTokens))return null;let t=e.downloadTokens;if(t.length===0)return null;let l=encodeURIComponent;return t.split(",").map(b=>{let o=s.bucket,c=s.fullPath,i="/b/"+l(o)+"/o/"+l(c),f=$e(i,a,r),_=wn({alt:"media",token:b});return f+_})[0]}function Sn(s,n){let a={},r=n.length;for(let e=0;e<r;e++){let t=n[e];t.writable&&(a[t.server]=s[t.local])}return JSON.stringify(a)}var Ue=class{constructor(n,a,r,e){this.url=n,this.method=a,this.handler=r,this.timeout=e,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Re(s){if(!s)throw xt()}function Ot(s,n){function a(r,e){let t=kn(s,e,n);return Re(t!==null),t}return a}function Nr(s,n){function a(r,e){let t=kn(s,e,n);return Re(t!==null),Mr(t,e,s.host,s._protocol)}return a}function tt(s){function n(a,r){let e;return a.getStatus()===401?a.getErrorText().includes("Firebase App Check token is invalid")?e=nr():e=tr():a.getStatus()===402?e=er(s.bucket):a.getStatus()===403?e=rr(s.path):e=r,e.status=a.getStatus(),e.serverResponse=r.serverResponse,e}return n}function Pt(s){let n=tt(s);function a(r,e){let t=n(r,e);return r.getStatus()===404&&(t=Jn(s.path)),t.serverResponse=e.serverResponse,t}return a}function Dr(s,n,a){let r=n.fullServerUrl(),e=$e(r,s.host,s._protocol),t="GET",l=s.maxOperationRetryTime,u=new Ue(e,t,Ot(s,a),l);return u.errorHandler=Pt(n),u}function Lr(s,n,a){let r=n.fullServerUrl(),e=$e(r,s.host,s._protocol),t="GET",l=s.maxOperationRetryTime,u=new Ue(e,t,Nr(s,a),l);return u.errorHandler=Pt(n),u}function Hr(s,n){let a=n.fullServerUrl(),r=$e(a,s.host,s._protocol),e="DELETE",t=s.maxOperationRetryTime;function l(g,b){}let u=new Ue(r,e,l,t);return u.successCodes=[200,204],u.errorHandler=Pt(n),u}function zr(s,n){return s&&s.contentType||n&&n.type()||"application/octet-stream"}function In(s,n,a){let r=Object.assign({},a);return r.fullPath=s.path,r.size=n.size(),r.contentType||(r.contentType=zr(null,n)),r}function qr(s,n,a,r,e){let t=n.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let x="";for(let S=0;S<2;S++)x=x+Math.random().toString().slice(2);return x}let g=u();l["Content-Type"]="multipart/related; boundary="+g;let b=In(n,r,e),o=Sn(b,a),c="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+o+`\r
--`+g+`\r
Content-Type: `+b.contentType+`\r
\r
`,i=`\r
--`+g+"--",f=ot.getBlob(c,r,i);if(f===null)throw An();let _={name:b.fullPath},R=$e(t,s.host,s._protocol),k="POST",w=s.maxUploadRetryTime,M=new Ue(R,k,Ot(s,a),w);return M.urlParams=_,M.headers=l,M.body=f.uploadData(),M.errorHandler=tt(n),M}var Qe=class{constructor(n,a,r,e){this.current=n,this.total=a,this.finalized=!!r,this.metadata=e||null}};function Bt(s,n){let a=null;try{a=s.getResponseHeader("X-Goog-Upload-Status")}catch{Re(!1)}return Re(!!a&&(n||["active"]).indexOf(a)!==-1),a}function Qr(s,n,a,r,e){let t=n.bucketOnlyServerUrl(),l=In(n,r,e),u={name:l.fullPath},g=$e(t,s.host,s._protocol),b="POST",o={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},c=Sn(l,a),i=s.maxUploadRetryTime;function f(R){Bt(R);let k;try{k=R.getResponseHeader("X-Goog-Upload-URL")}catch{Re(!1)}return Re(at(k)),k}let _=new Ue(g,b,f,i);return _.urlParams=u,_.headers=o,_.body=c,_.errorHandler=tt(n),_}function jr(s,n,a,r){let e={"X-Goog-Upload-Command":"query"};function t(b){let o=Bt(b,["active","final"]),c=null;try{c=b.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Re(!1)}c||Re(!1);let i=Number(c);return Re(!isNaN(i)),new Qe(i,r.size(),o==="final")}let l="POST",u=s.maxUploadRetryTime,g=new Ue(a,l,t,u);return g.headers=e,g.errorHandler=tt(n),g}var cn=256*1024;function $r(s,n,a,r,e,t,l,u){let g=new Qe(0,0);if(l?(g.current=l.current,g.total=l.total):(g.current=0,g.total=r.size()),r.size()!==g.total)throw ar();let b=g.total-g.current,o=b;e>0&&(o=Math.min(o,e));let c=g.current,i=c+o,f="";o===0?f="finalize":b===o?f="upload, finalize":f="upload";let _={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${g.current}`},R=r.slice(c,i);if(R===null)throw An();function k(S,B){let A=Bt(S,["active","final"]),F=g.current+o,d=r.size(),p;return A==="final"?p=Ot(n,t)(S,B):p=null,new Qe(F,d,A==="final",p)}let w="POST",M=n.maxUploadRetryTime,x=new Ue(a,w,k,M);return x.headers=_,x.body=R.uploadData(),x.progressCallback=u||null,x.errorHandler=tt(s),x}var fe={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Et(s){switch(s){case"running":case"pausing":case"canceling":return fe.RUNNING;case"paused":return fe.PAUSED;case"success":return fe.SUCCESS;case"canceled":return fe.CANCELED;case"error":return fe.ERROR;default:return fe.ERROR}}var kt=class{constructor(n,a,r){if(pr(n)||a!=null||r!=null)this.next=n,this.error=a??void 0,this.complete=r??void 0;else{let t=n;this.next=t.next,this.error=t.error,this.complete=t.complete}}};function He(s){return(...n)=>{Promise.resolve().then(()=>s(...n))}}var un=null,St=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qe.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qe.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qe.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,a,r,e,t){if(this.sent_)throw Ze("cannot .send() more than once");if(_t(n)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(a,n,!0),t!==void 0)for(let l in t)t.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,t[l].toString());return e!==void 0?this.xhr_.send(e):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ze("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ze("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ze("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ze("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",n)}},It=class extends St{initXhr(){this.xhr_.responseType="text"}};function Be(){return un?un():new It}var Ct=class{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(n,a,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=n,this._blob=a,this._metadata=r,this._mappings=Tn(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(K.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let t=this.isExponentialBackoffExpired();if(yn(e.status,[]))if(t)e=mn();else{this.sleepTime=Math.max(this.sleepTime*2,Yn),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(K.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){let n=this._transferred;return a=>this._updateProgress(n+a)}_shouldDoResumable(n){return n.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(n){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([a,r])=>{switch(this._state){case"running":n(a,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((n,a)=>{let r=Qr(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),e=this._ref.storage._makeRequest(r,Be,n,a);this._request=e,e.getPromise().then(t=>{this._request=void 0,this._uploadUrl=t,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let n=this._uploadUrl;this._resolveToken((a,r)=>{let e=jr(this._ref.storage,this._ref._location,n,this._blob),t=this._ref.storage._makeRequest(e,Be,a,r);this._request=t,t.getPromise().then(l=>{l=l,this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let n=cn*this._chunkMultiplier,a=new Qe(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((e,t)=>{let l;try{l=$r(this._ref._location,this._ref.storage,r,this._blob,n,this._mappings,a,this._makeProgressCallback())}catch(g){this._error=g,this._transition("error");return}let u=this._ref.storage._makeRequest(l,Be,e,t,!1);this._request=u,u.getPromise().then(g=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(g.current),g.finalized?(this._metadata=g.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){cn*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((n,a)=>{let r=Dr(this._ref.storage,this._ref._location,this._mappings),e=this._ref.storage._makeRequest(r,Be,n,a);this._request=e,e.getPromise().then(t=>{this._request=void 0,this._metadata=t,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((n,a)=>{let r=qr(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),e=this._ref.storage._makeRequest(r,Be,n,a);this._request=e,e.getPromise().then(t=>{this._request=void 0,this._metadata=t,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(n){let a=this._transferred;this._transferred=n,this._transferred!==a&&this._notifyObservers()}_transition(n){if(this._state!==n)switch(n){case"canceling":case"pausing":this._state=n,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let a=this._state==="paused";this._state=n,a&&(this._notifyObservers(),this._start());break;case"paused":this._state=n,this._notifyObservers();break;case"canceled":this._error=_n(),this._state=n,this._notifyObservers();break;case"error":this._state=n,this._notifyObservers();break;case"success":this._state=n,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let n=Et(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:n,metadata:this._metadata,task:this,ref:this._ref}}on(n,a,r,e){let t=new kt(a||void 0,r||void 0,e||void 0);return this._addObserver(t),()=>{this._removeObserver(t)}}then(n,a){return this._promise.then(n,a)}catch(n){return this.then(null,n)}_addObserver(n){this._observers.push(n),this._notifyObserver(n)}_removeObserver(n){let a=this._observers.indexOf(n);a!==-1&&this._observers.splice(a,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(a=>{this._notifyObserver(a)})}_finishPromise(){if(this._resolve!==void 0){let n=!0;switch(Et(this._state)){case fe.SUCCESS:He(this._resolve.bind(null,this.snapshot))();break;case fe.CANCELED:case fe.ERROR:let a=this._reject;He(a.bind(null,this._error))();break;default:n=!1;break}n&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(n){switch(Et(this._state)){case fe.RUNNING:case fe.PAUSED:n.next&&He(n.next.bind(n,this.snapshot))();break;case fe.SUCCESS:n.complete&&He(n.complete.bind(n))();break;case fe.CANCELED:case fe.ERROR:n.error&&He(n.error.bind(n,this._error))();break;default:n.error&&He(n.error.bind(n,this._error))()}}resume(){let n=this._state==="paused"||this._state==="pausing";return n&&this._transition("running"),n}pause(){let n=this._state==="running";return n&&this._transition("pausing"),n}cancel(){let n=this._state==="running"||this._state==="pausing";return n&&this._transition("canceling"),n}};var je=class s{constructor(n,a){this._service=n,a instanceof _e?this._location=a:this._location=_e.makeFromUrl(a,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,a){return new s(n,a)}get root(){let n=new _e(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Un(this._location.path)}get storage(){return this._service}get parent(){let n=Cr(this._location.path);if(n===null)return null;let a=new _e(this._location.bucket,n);return new s(this._service,a)}_throwIfRoot(n){if(this._location.path==="")throw ur(n)}};function Wr(s,n,a){return s._throwIfRoot("uploadBytesResumable"),new Ct(s,new ot(n),a)}function Gr(s){s._throwIfRoot("getDownloadURL");let n=Lr(s.storage,s._location,Tn());return s.storage.makeRequestWithTokens(n,Be).then(a=>{if(a===null)throw lr();return a})}function Vr(s){s._throwIfRoot("deleteObject");let n=Hr(s.storage,s._location);return s.storage.makeRequestWithTokens(n,Be)}function Xr(s,n){let a=xr(s._location.path,n),r=new _e(s._location.bucket,a);return new je(s.storage,r)}function Kr(s){return/^[A-Za-z]+:\/\//.test(s)}function Zr(s,n){return new je(s,n)}function Cn(s,n){if(s instanceof et){let a=s;if(a._bucket==null)throw or();let r=new je(a,a._bucket);return n!=null?Cn(r,n):r}else return n!==void 0?Xr(s,n):s}function Yr(s,n){if(n&&Kr(n)){if(s instanceof et)return Zr(s,n);throw Rt("To use ref(service, url), the first argument must be a Storage instance.")}else return Cn(s,n)}function fn(s,n){let a=n?.[gn];return a==null?null:_e.makeFromBucketSpec(a,s)}function Jr(s,n,a,r={}){s.host=`${n}:${a}`;let e=_t(n);e&&($t(`https://${s.host}/b`),Gt("Storage",!0)),s._isUsingEmulator=!0,s._protocol=e?"https":"http";let{mockUserToken:t}=r;t&&(s._overrideAuthToken=typeof t=="string"?t:Wt(t,s.app.options.projectId))}var et=class{constructor(n,a,r,e,t,l=!1){this.app=n,this._authProvider=a,this._appCheckProvider=r,this._url=e,this._firebaseVersion=t,this._isUsingEmulator=l,this._bucket=null,this._host=pn,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Kn,this._maxUploadRetryTime=Zn,this._requests=new Set,e!=null?this._bucket=_e.makeFromBucketSpec(e,this._host):this._bucket=fn(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._url!=null?this._bucket=_e.makeFromBucketSpec(this._url,n):this._bucket=fn(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){ln("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){ln("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}_getAuthToken(){return ue(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let n=this._authProvider.getImmediate({optional:!0});if(n){let a=yield n.getToken();if(a!==null)return a.accessToken}return null})}_getAppCheckToken(){return ue(this,null,function*(){if(Yt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let n=this._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new je(this,n)}_makeRequest(n,a,r,e,t=!0){if(this._deleted)return new Ut(bn());{let l=wr(n,this._appId,r,e,a,this._firebaseVersion,t,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}makeRequestWithTokens(n,a){return ue(this,null,function*(){let[r,e]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(n,a,r,e).getPromise()})}},hn="@firebase/storage",dn="0.14.0";var xn="storage";function Fn(s,n,a){return s=De(s),Wr(s,n,a)}function On(s){return s=De(s),Gr(s)}function Pn(s){return s=De(s),Vr(s)}function lt(s,n){return s=De(s),Yr(s,n)}function Bn(s=en(),n){s=De(s);let r=Zt(s,xn).getImmediate({identifier:n}),e=jt("storage");return e&&es(r,...e),r}function es(s,n,a,r={}){Jr(s,n,a,r)}function ts(s,{instanceIdentifier:n}){let a=s.getProvider("app").getImmediate(),r=s.getProvider("auth-internal"),e=s.getProvider("app-check-internal");return new et(a,r,e,n,Jt)}function ns(){Kt(new Xt(xn,ts,"PUBLIC").setMultipleInstances(!0)),At(hn,dn,""),At(hn,dn,"esm2020")}ns();function rs(s,n){return n.forEach(function(a){a&&typeof a!="string"&&!Array.isArray(a)&&Object.keys(a).forEach(function(r){if(r!=="default"&&!(r in s)){var e=Object.getOwnPropertyDescriptor(a,r);Object.defineProperty(s,r,e.get?e:{enumerable:!0,get:function(){return a[r]}})}})}),Object.freeze(s)}function Nn(s,n){return new Promise(function(a,r){let e;return ss(s).then(function(t){try{return e=t,a(new Blob([n.slice(0,2),e,n.slice(2)],{type:"image/jpeg"}))}catch(l){return r(l)}},r)})}var ss=s=>new Promise((n,a)=>{let r=new FileReader;r.addEventListener("load",({target:{result:e}})=>{let t=new DataView(e),l=0;if(t.getUint16(l)!==65496)return a("not a valid JPEG");for(l+=2;;){let u=t.getUint16(l);if(u===65498)break;let g=t.getUint16(l+2);if(u===65505&&t.getUint32(l+4)===1165519206){let b=l+10,o;switch(t.getUint16(b)){case 18761:o=!0;break;case 19789:o=!1;break;default:return a("TIFF header contains invalid endian")}if(t.getUint16(b+2,o)!==42)return a("TIFF header contains invalid version");let c=t.getUint32(b+4,o),i=b+c+2+12*t.getUint16(b+c,o);for(let f=b+c+2;f<i;f+=12)if(t.getUint16(f,o)==274){if(t.getUint16(f+2,o)!==3)return a("Orientation data type is invalid");if(t.getUint32(f+4,o)!==1)return a("Orientation data count is invalid");t.setUint16(f+8,1,o);break}return n(e.slice(l,l+2+g))}l+=2+g}return n(new Blob)}),r.readAsArrayBuffer(s)}),ut={},is={get exports(){return ut},set exports(s){ut=s}};(function(s){var n,a,r={};is.exports=r,r.parse=function(e,t){for(var l=r.bin.readUshort,u=r.bin.readUint,g=0,b={},o=new Uint8Array(e),c=o.length-4;u(o,c)!=101010256;)c--;g=c,g+=4;var i=l(o,g+=4);l(o,g+=2);var f=u(o,g+=2),_=u(o,g+=4);g+=4,g=_;for(var R=0;R<i;R++){u(o,g),g+=4,g+=4,g+=4,u(o,g+=4),f=u(o,g+=4);var k=u(o,g+=4),w=l(o,g+=4),M=l(o,g+2),x=l(o,g+4);g+=6;var S=u(o,g+=8);g+=4,g+=w+M+x,r._readLocal(o,S,b,f,k,t)}return b},r._readLocal=function(e,t,l,u,g,b){var o=r.bin.readUshort,c=r.bin.readUint;c(e,t),o(e,t+=4),o(e,t+=2);var i=o(e,t+=2);c(e,t+=2),c(e,t+=4),t+=4;var f=o(e,t+=8),_=o(e,t+=2);t+=2;var R=r.bin.readUTF8(e,t,f);if(t+=f,t+=_,b)l[R]={size:g,csize:u};else{var k=new Uint8Array(e.buffer,t);if(i==0)l[R]=new Uint8Array(k.buffer.slice(t,t+u));else{if(i!=8)throw"unknown compression method: "+i;var w=new Uint8Array(g);r.inflateRaw(k,w),l[R]=w}}},r.inflateRaw=function(e,t){return r.F.inflate(e,t)},r.inflate=function(e,t){return e[0],e[1],r.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},r.deflate=function(e,t){t==null&&(t={level:6});var l=0,u=new Uint8Array(50+Math.floor(1.1*e.length));u[l]=120,u[l+1]=156,l+=2,l=r.F.deflateRaw(e,u,l,t.level);var g=r.adler(e,0,e.length);return u[l+0]=g>>>24&255,u[l+1]=g>>>16&255,u[l+2]=g>>>8&255,u[l+3]=g>>>0&255,new Uint8Array(u.buffer,0,l+4)},r.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),u=r.F.deflateRaw(e,l,u,t.level);return new Uint8Array(l.buffer,0,u)},r.encode=function(e,t){t==null&&(t=!1);var l=0,u=r.bin.writeUint,g=r.bin.writeUshort,b={};for(var o in e){var c=!r._noNeed(o)&&!t,i=e[o],f=r.crc.crc(i,0,i.length);b[o]={cpr:c,usize:i.length,crc:f,file:c?r.deflateRaw(i):i}}for(var o in b)l+=b[o].file.length+30+46+2*r.bin.sizeUTF8(o);l+=22;var _=new Uint8Array(l),R=0,k=[];for(var o in b){var w=b[o];k.push(R),R=r._writeHeader(_,R,o,w,0)}var M=0,x=R;for(var o in b)w=b[o],k.push(R),R=r._writeHeader(_,R,o,w,1,k[M++]);var S=R-x;return u(_,R,101010256),R+=4,g(_,R+=4,M),g(_,R+=2,M),u(_,R+=2,S),u(_,R+=4,x),R+=4,R+=2,_.buffer},r._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},r._writeHeader=function(e,t,l,u,g,b){var o=r.bin.writeUint,c=r.bin.writeUshort,i=u.file;return o(e,t,g==0?67324752:33639248),t+=4,g==1&&(t+=2),c(e,t,20),c(e,t+=2,0),c(e,t+=2,u.cpr?8:0),o(e,t+=2,0),o(e,t+=4,u.crc),o(e,t+=4,i.length),o(e,t+=4,u.usize),c(e,t+=4,r.bin.sizeUTF8(l)),c(e,t+=2,0),t+=2,g==1&&(t+=2,t+=2,o(e,t+=6,b),t+=4),t+=r.bin.writeUTF8(e,t,l),g==0&&(e.set(i,t),t+=i.length),t},r.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,u=0;u<8;u++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e}(),update:function(e,t,l,u){for(var g=0;g<u;g++)e=r.crc.table[255&(e^t[l+g])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^r.crc.update(4294967295,e,t,l)}},r.adler=function(e,t,l){for(var u=1,g=0,b=t,o=t+l;b<o;){for(var c=Math.min(b+5552,o);b<c;)g+=u+=e[b++];u%=65521,g%=65521}return g<<16|u},r.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var u="",g=0;g<l;g++)u+=String.fromCharCode(e[t+g]);return u},writeASCII:function(e,t,l){for(var u=0;u<l.length;u++)e[t+u]=l.charCodeAt(u)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var u,g="",b=0;b<l;b++)g+="%"+r.bin.pad(e[t+b].toString(16));try{u=decodeURIComponent(g)}catch{return r.bin.readASCII(e,t,l)}return u},writeUTF8:function(e,t,l){for(var u=l.length,g=0,b=0;b<u;b++){var o=l.charCodeAt(b);if(!(4294967168&o))e[t+g]=o,g++;else if(!(4294965248&o))e[t+g]=192|o>>6,e[t+g+1]=128|o>>0&63,g+=2;else if(!(4294901760&o))e[t+g]=224|o>>12,e[t+g+1]=128|o>>6&63,e[t+g+2]=128|o>>0&63,g+=3;else{if(4292870144&o)throw"e";e[t+g]=240|o>>18,e[t+g+1]=128|o>>12&63,e[t+g+2]=128|o>>6&63,e[t+g+3]=128|o>>0&63,g+=4}}return g},sizeUTF8:function(e){for(var t=e.length,l=0,u=0;u<t;u++){var g=e.charCodeAt(u);if(!(4294967168&g))l++;else if(!(4294965248&g))l+=2;else if(!(4294901760&g))l+=3;else{if(4292870144&g)throw"e";l+=4}}return l}},r.F={},r.F.deflateRaw=function(e,t,l,u){var g=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][u],b=r.F.U,o=r.F._goodIndex;r.F._hash;var c=r.F._putsE,i=0,f=l<<3,_=0,R=e.length;if(u==0){for(;i<R;)c(t,f,i+(U=Math.min(65535,R-i))==R?1:0),f=r.F._copyExact(e,i,U,t,f+8),i+=U;return f>>>3}var k=b.lits,w=b.strt,M=b.prev,x=0,S=0,B=0,A=0,F=0,d=0;for(R>2&&(w[d=r.F._hash(e,0)]=0),i=0;i<R;i++){if(F=d,i+1<R-2){d=r.F._hash(e,i+1);var p=i+1&32767;M[p]=w[d],w[d]=p}if(_<=i){(x>14e3||S>26697)&&R-i>100&&(_<i&&(k[x]=i-_,x+=2,_=i),f=r.F._writeBlock(i==R-1||_==R?1:0,k,x,A,e,B,i-B,t,f),x=S=A=0,B=i);var v=0;i<R-2&&(v=r.F._bestMatch(e,i,M,F,Math.min(g[2],R-i),g[3]));var U=v>>>16,E=65535&v;if(v!=0){E=65535&v;var T=o(U=v>>>16,b.of0);b.lhst[257+T]++;var y=o(E,b.df0);b.dhst[y]++,A+=b.exb[T]+b.dxb[y],k[x]=U<<23|i-_,k[x+1]=E<<16|T<<8|y,x+=2,_=i+U}else b.lhst[e[i]]++;S++}}for(B==i&&e.length!=0||(_<i&&(k[x]=i-_,x+=2,_=i),f=r.F._writeBlock(1,k,x,A,e,B,i-B,t,f),x=0,S=0,x=S=A=0,B=i);7&f;)f++;return f>>>3},r.F._bestMatch=function(e,t,l,u,g,b){var o=32767&t,c=l[o],i=o-c+32768&32767;if(c==o||u!=r.F._hash(e,t-i))return 0;for(var f=0,_=0,R=Math.min(32767,t);i<=R&&--b!=0&&c!=o;){if(f==0||e[t+f]==e[t+f-i]){var k=r.F._howLong(e,t,i);if(k>f){if(_=i,(f=k)>=g)break;i+2<k&&(k=i+2);for(var w=0,M=0;M<k-2;M++){var x=t-i+M+32768&32767,S=x-l[x]+32768&32767;S>w&&(w=S,c=x)}}}i+=(o=c)-(c=l[o])+32768&32767}return f<<16|_},r.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var u=t,g=Math.min(e.length,t+258);for(t+=3;t<g&&e[t]==e[t-l];)t++;return t-u},r.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(e,t,l,u,g,b,o,c,i){var f,_,R,k,w,M,x,S,B,A=r.F.U,F=r.F._putsF,d=r.F._putsE;A.lhst[256]++,_=(f=r.F.getTrees())[0],R=f[1],k=f[2],w=f[3],M=f[4],x=f[5],S=f[6],B=f[7];var p=32+(i+3&7?8-(i+3&7):0)+(o<<3),v=u+r.F.contSize(A.fltree,A.lhst)+r.F.contSize(A.fdtree,A.dhst),U=u+r.F.contSize(A.ltree,A.lhst)+r.F.contSize(A.dtree,A.dhst);U+=14+3*x+r.F.contSize(A.itree,A.ihst)+(2*A.ihst[16]+3*A.ihst[17]+7*A.ihst[18]);for(var E=0;E<286;E++)A.lhst[E]=0;for(E=0;E<30;E++)A.dhst[E]=0;for(E=0;E<19;E++)A.ihst[E]=0;var T=p<v&&p<U?0:v<U?1:2;if(F(c,i,e),F(c,i+1,T),i+=3,T==0){for(;7&i;)i++;i=r.F._copyExact(g,b,o,c,i)}else{var y,I;if(T==1&&(y=A.fltree,I=A.fdtree),T==2){r.F.makeCodes(A.ltree,_),r.F.revCodes(A.ltree,_),r.F.makeCodes(A.dtree,R),r.F.revCodes(A.dtree,R),r.F.makeCodes(A.itree,k),r.F.revCodes(A.itree,k),y=A.ltree,I=A.dtree,d(c,i,w-257),d(c,i+=5,M-1),d(c,i+=5,x-4),i+=4;for(var m=0;m<x;m++)d(c,i+3*m,A.itree[1+(A.ordr[m]<<1)]);i+=3*x,i=r.F._codeTiny(S,A.itree,c,i),i=r.F._codeTiny(B,A.itree,c,i)}for(var h=b,N=0;N<l;N+=2){for(var C=t[N],P=C>>>23,z=h+(8388607&C);h<z;)i=r.F._writeLit(g[h++],y,c,i);if(P!=0){var L=t[N+1],H=L>>16,D=L>>8&255,O=255&L;d(c,i=r.F._writeLit(257+D,y,c,i),P-A.of0[D]),i+=A.exb[D],F(c,i=r.F._writeLit(O,I,c,i),H-A.df0[O]),i+=A.dxb[O],h+=P}}i=r.F._writeLit(256,y,c,i)}return i},r.F._copyExact=function(e,t,l,u,g){var b=g>>>3;return u[b]=l,u[b+1]=l>>>8,u[b+2]=255-u[b],u[b+3]=255-u[b+1],b+=4,u.set(new Uint8Array(e.buffer,t,l),b),g+(l+4<<3)},r.F.getTrees=function(){for(var e=r.F.U,t=r.F._hufTree(e.lhst,e.ltree,15),l=r.F._hufTree(e.dhst,e.dtree,15),u=[],g=r.F._lenCodes(e.ltree,u),b=[],o=r.F._lenCodes(e.dtree,b),c=0;c<u.length;c+=2)e.ihst[u[c]]++;for(c=0;c<b.length;c+=2)e.ihst[b[c]]++;for(var i=r.F._hufTree(e.ihst,e.itree,7),f=19;f>4&&e.itree[1+(e.ordr[f-1]<<1)]==0;)f--;return[t,l,i,g,o,f,u,b]},r.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},r.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},r.F.contSize=function(e,t){for(var l=0,u=0;u<t.length;u++)l+=t[u]*e[1+(u<<1)];return l},r.F._codeTiny=function(e,t,l,u){for(var g=0;g<e.length;g+=2){var b=e[g],o=e[g+1];u=r.F._writeLit(b,t,l,u);var c=b==16?2:b==17?3:7;b>15&&(r.F._putsE(l,u,o,c),u+=c)}return u},r.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var u=0;u<l;u+=2){var g=e[u+1],b=u+3<l?e[u+3]:-1,o=u+5<l?e[u+5]:-1,c=u==0?-1:e[u-1];if(g==0&&b==g&&o==g){for(var i=u+5;i+2<l&&e[i+2]==g;)i+=2;(f=Math.min(i+1-u>>>1,138))<11?t.push(17,f-3):t.push(18,f-11),u+=2*f-2}else if(g==c&&b==g&&o==g){for(i=u+5;i+2<l&&e[i+2]==g;)i+=2;var f=Math.min(i+1-u>>>1,6);t.push(16,f-3),u+=2*f-2}else t.push(g,0)}return l>>>1},r.F._hufTree=function(e,t,l){var u=[],g=e.length,b=t.length,o=0;for(o=0;o<b;o+=2)t[o]=0,t[o+1]=0;for(o=0;o<g;o++)e[o]!=0&&u.push({lit:o,f:e[o]});var c=u.length,i=u.slice(0);if(c==0)return 0;if(c==1){var f=u[0].lit;return i=f==0?1:0,t[1+(f<<1)]=1,t[1+(i<<1)]=1,1}u.sort(function(S,B){return S.f-B.f});var _=u[0],R=u[1],k=0,w=1,M=2;for(u[0]={lit:-1,f:_.f+R.f,l:_,r:R,d:0};w!=c-1;)_=k!=w&&(M==c||u[k].f<u[M].f)?u[k++]:u[M++],R=k!=w&&(M==c||u[k].f<u[M].f)?u[k++]:u[M++],u[w++]={lit:-1,f:_.f+R.f,l:_,r:R};var x=r.F.setDepth(u[w-1],0);for(x>l&&(r.F.restrictDepth(i,l,x),x=l),o=0;o<c;o++)t[1+(i[o].lit<<1)]=i[o].d;return x},r.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(r.F.setDepth(e.l,t+1),r.F.setDepth(e.r,t+1))},r.F.restrictDepth=function(e,t,l){var u=0,g=1<<l-t,b=0;for(e.sort(function(c,i){return i.d==c.d?c.f-i.f:i.d-c.d}),u=0;u<e.length&&e[u].d>t;u++){var o=e[u].d;e[u].d=t,b+=g-(1<<l-o)}for(b>>>=l-t;b>0;)(o=e[u].d)<t?(e[u].d++,b-=1<<t-o-1):u++;for(;u>=0;u--)e[u].d==t&&b<0&&(e[u].d--,b++);b!=0&&console.log("debt left")},r.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},r.F._writeLit=function(e,t,l,u){return r.F._putsF(l,u,t[e<<1]),u+t[1+(e<<1)]},r.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var u=r.F,g=u._bitsF,b=u._bitsE,o=u._decodeTiny,c=u.makeCodes,i=u.codes2map,f=u._get17,_=u.U,R=t==null;R&&(t=new l(e.length>>>2<<3));for(var k,w,M=0,x=0,S=0,B=0,A=0,F=0,d=0,p=0,v=0;M==0;)if(M=g(e,v,1),x=g(e,v+1,2),v+=3,x!=0){if(R&&(t=r.F._check(t,p+(1<<17))),x==1&&(k=_.flmap,w=_.fdmap,F=511,d=31),x==2){S=b(e,v,5)+257,B=b(e,v+5,5)+1,A=b(e,v+10,4)+4,v+=14;for(var U=0;U<38;U+=2)_.itree[U]=0,_.itree[U+1]=0;var E=1;for(U=0;U<A;U++){var T=b(e,v+3*U,3);_.itree[1+(_.ordr[U]<<1)]=T,T>E&&(E=T)}v+=3*A,c(_.itree,E),i(_.itree,E,_.imap),k=_.lmap,w=_.dmap,v=o(_.imap,(1<<E)-1,S+B,e,v,_.ttree);var y=u._copyOut(_.ttree,0,S,_.ltree);F=(1<<y)-1;var I=u._copyOut(_.ttree,S,B,_.dtree);d=(1<<I)-1,c(_.ltree,y),i(_.ltree,y,k),c(_.dtree,I),i(_.dtree,I,w)}for(;;){var m=k[f(e,v)&F];v+=15&m;var h=m>>>4;if(!(h>>>8))t[p++]=h;else{if(h==256)break;var N=p+h-254;if(h>264){var C=_.ldef[h-257];N=p+(C>>>3)+b(e,v,7&C),v+=7&C}var P=w[f(e,v)&d];v+=15&P;var z=P>>>4,L=_.ddef[z],H=(L>>>4)+g(e,v,15&L);for(v+=15&L,R&&(t=r.F._check(t,p+(1<<17)));p<N;)t[p]=t[p++-H],t[p]=t[p++-H],t[p]=t[p++-H],t[p]=t[p++-H];p=N}}}else{7&v&&(v+=8-(7&v));var D=4+(v>>>3),O=e[D-4]|e[D-3]<<8;R&&(t=r.F._check(t,p+O)),t.set(new l(e.buffer,e.byteOffset+D,O),p),v=D+O<<3,p+=O}return t.length==p?t:t.slice(0,p)},r.F._check=function(e,t){var l=e.length;if(t<=l)return e;var u=new Uint8Array(Math.max(l<<1,t));return u.set(e,0),u},r.F._decodeTiny=function(e,t,l,u,g,b){for(var o=r.F._bitsE,c=r.F._get17,i=0;i<l;){var f=e[c(u,g)&t];g+=15&f;var _=f>>>4;if(_<=15)b[i]=_,i++;else{var R=0,k=0;_==16?(k=3+o(u,g,2),g+=2,R=b[i-1]):_==17?(k=3+o(u,g,3),g+=3):_==18&&(k=11+o(u,g,7),g+=7);for(var w=i+k;i<w;)b[i]=R,i++}}return g},r.F._copyOut=function(e,t,l,u){for(var g=0,b=0,o=u.length>>>1;b<l;){var c=e[b+t];u[b<<1]=0,u[1+(b<<1)]=c,c>g&&(g=c),b++}for(;b<o;)u[b<<1]=0,u[1+(b<<1)]=0,b++;return g},r.F.makeCodes=function(e,t){for(var l,u,g,b,o=r.F.U,c=e.length,i=o.bl_count,f=0;f<=t;f++)i[f]=0;for(f=1;f<c;f+=2)i[e[f]]++;var _=o.next_code;for(l=0,i[0]=0,u=1;u<=t;u++)l=l+i[u-1]<<1,_[u]=l;for(g=0;g<c;g+=2)(b=e[g+1])!=0&&(e[g]=_[b],_[b]++)},r.F.codes2map=function(e,t,l){for(var u=e.length,g=r.F.U.rev15,b=0;b<u;b+=2)if(e[b+1]!=0)for(var o=b>>1,c=e[b+1],i=o<<4|c,f=t-c,_=e[b]<<f,R=_+(1<<f);_!=R;)l[g[_]>>>15-t]=i,_++},r.F.revCodes=function(e,t){for(var l=r.F.U.rev15,u=15-t,g=0;g<e.length;g+=2){var b=e[g]<<t-e[g+1];e[g]=l[b]>>>u}},r.F._putsE=function(e,t,l){l<<=7&t;var u=t>>>3;e[u]|=l,e[u+1]|=l>>>8},r.F._putsF=function(e,t,l){l<<=7&t;var u=t>>>3;e[u]|=l,e[u+1]|=l>>>8,e[u+2]|=l>>>16},r.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},r.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},r.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},r.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},r.F.U=(n=Uint16Array,a=Uint32Array,{next_code:new n(16),bl_count:new n(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new n(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new a(32),flmap:new n(512),fltree:[],fdmap:new n(32),fdtree:[],lmap:new n(32768),ltree:[],ttree:[],dmap:new n(32768),dtree:[],imap:new n(512),itree:[],rev15:new n(32768),lhst:new a(286),dhst:new a(30),ihst:new a(19),lits:new a(15e3),strt:new n(65536),prev:new n(32768)}),function(){for(var e=r.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function u(g,b,o){for(;b--!=0;)g.push(0,o)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];u(e.fltree,144,8),u(e.fltree,112,9),u(e.fltree,24,7),u(e.fltree,8,8),r.F.makeCodes(e.fltree,9),r.F.codes2map(e.fltree,9,e.flmap),r.F.revCodes(e.fltree,9),u(e.fdtree,32,5),r.F.makeCodes(e.fdtree,5),r.F.codes2map(e.fdtree,5,e.fdmap),r.F.revCodes(e.fdtree,5),u(e.itree,19,0),u(e.ltree,286,0),u(e.dtree,30,0),u(e.ttree,320,0)}()})();var os=rs({__proto__:null,default:ut},[ut]),Ae=function(){var s={nextZero(o,c){for(;o[c]!=0;)c++;return c},readUshort:(o,c)=>o[c]<<8|o[c+1],writeUshort(o,c,i){o[c]=i>>8&255,o[c+1]=255&i},readUint:(o,c)=>16777216*o[c]+(o[c+1]<<16|o[c+2]<<8|o[c+3]),writeUint(o,c,i){o[c]=i>>24&255,o[c+1]=i>>16&255,o[c+2]=i>>8&255,o[c+3]=255&i},readASCII(o,c,i){let f="";for(let _=0;_<i;_++)f+=String.fromCharCode(o[c+_]);return f},writeASCII(o,c,i){for(let f=0;f<i.length;f++)o[c+f]=i.charCodeAt(f)},readBytes(o,c,i){let f=[];for(let _=0;_<i;_++)f.push(o[c+_]);return f},pad:o=>o.length<2?`0${o}`:o,readUTF8(o,c,i){let f,_="";for(let R=0;R<i;R++)_+=`%${s.pad(o[c+R].toString(16))}`;try{f=decodeURIComponent(_)}catch{return s.readASCII(o,c,i)}return f}};function n(o,c,i,f){let _=c*i,R=t(f),k=Math.ceil(c*R/8),w=new Uint8Array(4*_),M=new Uint32Array(w.buffer),{ctype:x}=f,{depth:S}=f,B=s.readUshort;if(x==6){let C=_<<2;if(S==8)for(var A=0;A<C;A+=4)w[A]=o[A],w[A+1]=o[A+1],w[A+2]=o[A+2],w[A+3]=o[A+3];if(S==16)for(A=0;A<C;A++)w[A]=o[A<<1]}else if(x==2){let C=f.tabs.tRNS;if(C==null){if(S==8)for(A=0;A<_;A++){var F=3*A;M[A]=255<<24|o[F+2]<<16|o[F+1]<<8|o[F]}if(S==16)for(A=0;A<_;A++)F=6*A,M[A]=255<<24|o[F+4]<<16|o[F+2]<<8|o[F]}else{var d=C[0];let P=C[1],z=C[2];if(S==8)for(A=0;A<_;A++){var p=A<<2;F=3*A,M[A]=255<<24|o[F+2]<<16|o[F+1]<<8|o[F],o[F]==d&&o[F+1]==P&&o[F+2]==z&&(w[p+3]=0)}if(S==16)for(A=0;A<_;A++)p=A<<2,F=6*A,M[A]=255<<24|o[F+4]<<16|o[F+2]<<8|o[F],B(o,F)==d&&B(o,F+2)==P&&B(o,F+4)==z&&(w[p+3]=0)}}else if(x==3){let C=f.tabs.PLTE,P=f.tabs.tRNS,z=P?P.length:0;if(S==1)for(var v=0;v<i;v++){var U=v*k,E=v*c;for(A=0;A<c;A++){p=E+A<<2;var T=3*(y=o[U+(A>>3)]>>7-((7&A)<<0)&1);w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255}}if(S==2)for(v=0;v<i;v++)for(U=v*k,E=v*c,A=0;A<c;A++)p=E+A<<2,T=3*(y=o[U+(A>>2)]>>6-((3&A)<<1)&3),w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255;if(S==4)for(v=0;v<i;v++)for(U=v*k,E=v*c,A=0;A<c;A++)p=E+A<<2,T=3*(y=o[U+(A>>1)]>>4-((1&A)<<2)&15),w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255;if(S==8)for(A=0;A<_;A++){var y;p=A<<2,T=3*(y=o[A]),w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255}}else if(x==4){if(S==8)for(A=0;A<_;A++){p=A<<2;var I=o[m=A<<1];w[p]=I,w[p+1]=I,w[p+2]=I,w[p+3]=o[m+1]}if(S==16)for(A=0;A<_;A++){var m;p=A<<2,I=o[m=A<<2],w[p]=I,w[p+1]=I,w[p+2]=I,w[p+3]=o[m+2]}}else if(x==0)for(d=f.tabs.tRNS?f.tabs.tRNS:-1,v=0;v<i;v++){let C=v*k,P=v*c;if(S==1)for(var h=0;h<c;h++){var N=(I=255*(o[C+(h>>>3)]>>>7-(7&h)&1))==255*d?0:255;M[P+h]=N<<24|I<<16|I<<8|I}else if(S==2)for(h=0;h<c;h++)N=(I=85*(o[C+(h>>>2)]>>>6-((3&h)<<1)&3))==85*d?0:255,M[P+h]=N<<24|I<<16|I<<8|I;else if(S==4)for(h=0;h<c;h++)N=(I=17*(o[C+(h>>>1)]>>>4-((1&h)<<2)&15))==17*d?0:255,M[P+h]=N<<24|I<<16|I<<8|I;else if(S==8)for(h=0;h<c;h++)N=(I=o[C+h])==d?0:255,M[P+h]=N<<24|I<<16|I<<8|I;else if(S==16)for(h=0;h<c;h++)I=o[C+(h<<1)],N=B(o,C+(h<<1))==d?0:255,M[P+h]=N<<24|I<<16|I<<8|I}return w}function a(o,c,i,f){let _=t(o),R=Math.ceil(i*_/8),k=new Uint8Array((R+1+o.interlace)*f);return c=o.tabs.CgBI?e(c,k):r(c,k),o.interlace==0?c=l(c,o,0,i,f):o.interlace==1&&(c=function(M,x){let S=x.width,B=x.height,A=t(x),F=A>>3,d=Math.ceil(S*A/8),p=new Uint8Array(B*d),v=0,U=[0,0,4,0,2,0,1],E=[0,4,0,2,0,1,0],T=[8,8,8,4,4,2,2],y=[8,8,4,4,2,2,1],I=0;for(;I<7;){let h=T[I],N=y[I],C=0,P=0,z=U[I];for(;z<B;)z+=h,P++;let L=E[I];for(;L<S;)L+=N,C++;let H=Math.ceil(C*A/8);l(M,x,v,C,P);let D=0,O=U[I];for(;O<B;){let q=E[I],V=v+D*H<<3;for(;q<S;){var m;if(A==1&&(m=(m=M[V>>3])>>7-(7&V)&1,p[O*d+(q>>3)]|=m<<7-((7&q)<<0)),A==2&&(m=(m=M[V>>3])>>6-(7&V)&3,p[O*d+(q>>2)]|=m<<6-((3&q)<<1)),A==4&&(m=(m=M[V>>3])>>4-(7&V)&15,p[O*d+(q>>1)]|=m<<4-((1&q)<<2)),A>=8){let j=O*d+q*F;for(let Q=0;Q<F;Q++)p[j+Q]=M[(V>>3)+Q]}V+=A,q+=N}D++,O+=h}C*P!=0&&(v+=P*(1+H)),I+=1}return p}(c,o)),c}function r(o,c){return e(new Uint8Array(o.buffer,2,o.length-6),c)}var e=function(){let o={H:{}};return o.H.N=function(c,i){let f=Uint8Array,_,R,k=0,w=0,M=0,x=0,S=0,B=0,A=0,F=0,d=0;if(c[0]==3&&c[1]==0)return i||new f(0);let p=o.H,v=p.b,U=p.e,E=p.R,T=p.n,y=p.A,I=p.Z,m=p.m,h=i==null;for(h&&(i=new f(c.length>>>2<<5));k==0;)if(k=v(c,d,1),w=v(c,d+1,2),d+=3,w!=0){if(h&&(i=o.H.W(i,F+(1<<17))),w==1&&(_=m.J,R=m.h,B=511,A=31),w==2){M=U(c,d,5)+257,x=U(c,d+5,5)+1,S=U(c,d+10,4)+4,d+=14;let C=1;for(var N=0;N<38;N+=2)m.Q[N]=0,m.Q[N+1]=0;for(N=0;N<S;N++){let L=U(c,d+3*N,3);m.Q[1+(m.X[N]<<1)]=L,L>C&&(C=L)}d+=3*S,T(m.Q,C),y(m.Q,C,m.u),_=m.w,R=m.d,d=E(m.u,(1<<C)-1,M+x,c,d,m.v);let P=p.V(m.v,0,M,m.C);B=(1<<P)-1;let z=p.V(m.v,M,x,m.D);A=(1<<z)-1,T(m.C,P),y(m.C,P,_),T(m.D,z),y(m.D,z,R)}for(;;){let C=_[I(c,d)&B];d+=15&C;let P=C>>>4;if(!(P>>>8))i[F++]=P;else{if(P==256)break;{let z=F+P-254;if(P>264){let q=m.q[P-257];z=F+(q>>>3)+U(c,d,7&q),d+=7&q}let L=R[I(c,d)&A];d+=15&L;let H=L>>>4,D=m.c[H],O=(D>>>4)+v(c,d,15&D);for(d+=15&D;F<z;)i[F]=i[F++-O],i[F]=i[F++-O],i[F]=i[F++-O],i[F]=i[F++-O];F=z}}}}else{7&d&&(d+=8-(7&d));let C=4+(d>>>3),P=c[C-4]|c[C-3]<<8;h&&(i=o.H.W(i,F+P)),i.set(new f(c.buffer,c.byteOffset+C,P),F),d=C+P<<3,F+=P}return i.length==F?i:i.slice(0,F)},o.H.W=function(c,i){let f=c.length;if(i<=f)return c;let _=new Uint8Array(f<<1);return _.set(c,0),_},o.H.R=function(c,i,f,_,R,k){let w=o.H.e,M=o.H.Z,x=0;for(;x<f;){let S=c[M(_,R)&i];R+=15&S;let B=S>>>4;if(B<=15)k[x]=B,x++;else{let A=0,F=0;B==16?(F=3+w(_,R,2),R+=2,A=k[x-1]):B==17?(F=3+w(_,R,3),R+=3):B==18&&(F=11+w(_,R,7),R+=7);let d=x+F;for(;x<d;)k[x]=A,x++}}return R},o.H.V=function(c,i,f,_){let R=0,k=0,w=_.length>>>1;for(;k<f;){let M=c[k+i];_[k<<1]=0,_[1+(k<<1)]=M,M>R&&(R=M),k++}for(;k<w;)_[k<<1]=0,_[1+(k<<1)]=0,k++;return R},o.H.n=function(c,i){let f=o.H.m,_=c.length,R,k,w,M,x=f.j;for(var S=0;S<=i;S++)x[S]=0;for(S=1;S<_;S+=2)x[c[S]]++;let B=f.K;for(R=0,x[0]=0,k=1;k<=i;k++)R=R+x[k-1]<<1,B[k]=R;for(w=0;w<_;w+=2)M=c[w+1],M!=0&&(c[w]=B[M],B[M]++)},o.H.A=function(c,i,f){let _=c.length,R=o.H.m.r;for(let k=0;k<_;k+=2)if(c[k+1]!=0){let w=k>>1,M=c[k+1],x=w<<4|M,S=i-M,B=c[k]<<S,A=B+(1<<S);for(;B!=A;)f[R[B]>>>15-i]=x,B++}},o.H.l=function(c,i){let f=o.H.m.r,_=15-i;for(let R=0;R<c.length;R+=2){let k=c[R]<<i-c[R+1];c[R]=f[k]>>>_}},o.H.M=function(c,i,f){f<<=7&i;let _=i>>>3;c[_]|=f,c[_+1]|=f>>>8},o.H.I=function(c,i,f){f<<=7&i;let _=i>>>3;c[_]|=f,c[_+1]|=f>>>8,c[_+2]|=f>>>16},o.H.e=function(c,i,f){return(c[i>>>3]|c[1+(i>>>3)]<<8)>>>(7&i)&(1<<f)-1},o.H.b=function(c,i,f){return(c[i>>>3]|c[1+(i>>>3)]<<8|c[2+(i>>>3)]<<16)>>>(7&i)&(1<<f)-1},o.H.Z=function(c,i){return(c[i>>>3]|c[1+(i>>>3)]<<8|c[2+(i>>>3)]<<16)>>>(7&i)},o.H.i=function(c,i){return(c[i>>>3]|c[1+(i>>>3)]<<8|c[2+(i>>>3)]<<16|c[3+(i>>>3)]<<24)>>>(7&i)},o.H.m=function(){let c=Uint16Array,i=Uint32Array;return{K:new c(16),j:new c(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new c(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new i(32),J:new c(512),_:[],h:new c(32),$:[],w:new c(32768),C:[],v:[],d:new c(32768),D:[],u:new c(512),Q:[],r:new c(32768),s:new i(286),Y:new i(30),a:new i(19),t:new i(15e3),k:new c(65536),g:new c(32768)}}(),function(){let c=o.H.m;for(var i=0;i<32768;i++){let _=i;_=(2863311530&_)>>>1|(1431655765&_)<<1,_=(3435973836&_)>>>2|(858993459&_)<<2,_=(4042322160&_)>>>4|(252645135&_)<<4,_=(4278255360&_)>>>8|(16711935&_)<<8,c.r[i]=(_>>>16|_<<16)>>>17}function f(_,R,k){for(;R--!=0;)_.push(0,k)}for(i=0;i<32;i++)c.q[i]=c.S[i]<<3|c.T[i],c.c[i]=c.p[i]<<4|c.z[i];f(c._,144,8),f(c._,112,9),f(c._,24,7),f(c._,8,8),o.H.n(c._,9),o.H.A(c._,9,c.J),o.H.l(c._,9),f(c.$,32,5),o.H.n(c.$,5),o.H.A(c.$,5,c.h),o.H.l(c.$,5),f(c.Q,19,0),f(c.C,286,0),f(c.D,30,0),f(c.v,320,0)}(),o.H.N}();function t(o){return[1,null,3,1,2,null,4][o.ctype]*o.depth}function l(o,c,i,f,_){let R=t(c),k=Math.ceil(f*R/8),w,M;R=Math.ceil(R/8);let x=o[i],S=0;if(x>1&&(o[i]=[0,0,1][x-2]),x==3)for(S=R;S<k;S++)o[S+1]=o[S+1]+(o[S+1-R]>>>1)&255;for(let B=0;B<_;B++)if(w=i+B*k,M=w+B+1,x=o[M-1],S=0,x==0)for(;S<k;S++)o[w+S]=o[M+S];else if(x==1){for(;S<R;S++)o[w+S]=o[M+S];for(;S<k;S++)o[w+S]=o[M+S]+o[w+S-R]}else if(x==2)for(;S<k;S++)o[w+S]=o[M+S]+o[w+S-k];else if(x==3){for(;S<R;S++)o[w+S]=o[M+S]+(o[w+S-k]>>>1);for(;S<k;S++)o[w+S]=o[M+S]+(o[w+S-k]+o[w+S-R]>>>1)}else{for(;S<R;S++)o[w+S]=o[M+S]+u(0,o[w+S-k],0);for(;S<k;S++)o[w+S]=o[M+S]+u(o[w+S-R],o[w+S-k],o[w+S-R-k])}return o}function u(o,c,i){let f=o+c-i,_=f-o,R=f-c,k=f-i;return _*_<=R*R&&_*_<=k*k?o:R*R<=k*k?c:i}function g(o,c,i){i.width=s.readUint(o,c),c+=4,i.height=s.readUint(o,c),c+=4,i.depth=o[c],c++,i.ctype=o[c],c++,i.compress=o[c],c++,i.filter=o[c],c++,i.interlace=o[c],c++}function b(o,c,i,f,_,R,k,w,M){let x=Math.min(c,_),S=Math.min(i,R),B=0,A=0;for(let I=0;I<S;I++)for(let m=0;m<x;m++)if(k>=0&&w>=0?(B=I*c+m<<2,A=(w+I)*_+k+m<<2):(B=(-w+I)*c-k+m<<2,A=I*_+m<<2),M==0)f[A]=o[B],f[A+1]=o[B+1],f[A+2]=o[B+2],f[A+3]=o[B+3];else if(M==1){var F=o[B+3]*.00392156862745098,d=o[B]*F,p=o[B+1]*F,v=o[B+2]*F,U=f[A+3]*(1/255),E=f[A]*U,T=f[A+1]*U,y=f[A+2]*U;let h=1-F,N=F+U*h,C=N==0?0:1/N;f[A+3]=255*N,f[A+0]=(d+E*h)*C,f[A+1]=(p+T*h)*C,f[A+2]=(v+y*h)*C}else if(M==2)F=o[B+3],d=o[B],p=o[B+1],v=o[B+2],U=f[A+3],E=f[A],T=f[A+1],y=f[A+2],F==U&&d==E&&p==T&&v==y?(f[A]=0,f[A+1]=0,f[A+2]=0,f[A+3]=0):(f[A]=d,f[A+1]=p,f[A+2]=v,f[A+3]=F);else if(M==3){if(F=o[B+3],d=o[B],p=o[B+1],v=o[B+2],U=f[A+3],E=f[A],T=f[A+1],y=f[A+2],F==U&&d==E&&p==T&&v==y)continue;if(F<220&&U>20)return!1}return!0}return{decode:function(c){let i=new Uint8Array(c),f=8,_=s,R=_.readUshort,k=_.readUint,w={tabs:{},frames:[]},M=new Uint8Array(i.length),x,S=0,B=0,A=[137,80,78,71,13,10,26,10];for(var F=0;F<8;F++)if(i[F]!=A[F])throw"The input is not a PNG file!";for(;f<i.length;){let I=_.readUint(i,f);f+=4;let m=_.readASCII(i,f,4);if(f+=4,m=="IHDR")g(i,f,w);else if(m=="iCCP"){for(var d=f;i[d]!=0;)d++;_.readASCII(i,f,d-f),i[d+1];let h=i.slice(d+2,f+I),N=null;try{N=r(h)}catch{N=e(h)}w.tabs[m]=N}else if(m=="CgBI")w.tabs[m]=i.slice(f,f+4);else if(m=="IDAT"){for(F=0;F<I;F++)M[S+F]=i[f+F];S+=I}else if(m=="acTL")w.tabs[m]={num_frames:k(i,f),num_plays:k(i,f+4)},x=new Uint8Array(i.length);else if(m=="fcTL"){B!=0&&((y=w.frames[w.frames.length-1]).data=a(w,x.slice(0,B),y.rect.width,y.rect.height),B=0);let h={x:k(i,f+12),y:k(i,f+16),width:k(i,f+4),height:k(i,f+8)},N=R(i,f+22);N=R(i,f+20)/(N==0?100:N);let C={rect:h,delay:Math.round(1e3*N),dispose:i[f+24],blend:i[f+25]};w.frames.push(C)}else if(m=="fdAT"){for(F=0;F<I-4;F++)x[B+F]=i[f+F+4];B+=I-4}else if(m=="pHYs")w.tabs[m]=[_.readUint(i,f),_.readUint(i,f+4),i[f+8]];else if(m=="cHRM")for(w.tabs[m]=[],F=0;F<8;F++)w.tabs[m].push(_.readUint(i,f+4*F));else if(m=="tEXt"||m=="zTXt"){w.tabs[m]==null&&(w.tabs[m]={});var p=_.nextZero(i,f),v=_.readASCII(i,f,p-f),U=f+I-p-1;if(m=="tEXt")T=_.readASCII(i,p+1,U);else{var E=r(i.slice(p+2,p+2+U));T=_.readUTF8(E,0,E.length)}w.tabs[m][v]=T}else if(m=="iTXt"){w.tabs[m]==null&&(w.tabs[m]={}),p=0,d=f,p=_.nextZero(i,d),v=_.readASCII(i,d,p-d);let h=i[d=p+1];var T;i[d+1],d+=2,p=_.nextZero(i,d),_.readASCII(i,d,p-d),d=p+1,p=_.nextZero(i,d),_.readUTF8(i,d,p-d),U=I-((d=p+1)-f),h==0?T=_.readUTF8(i,d,U):(E=r(i.slice(d,d+U)),T=_.readUTF8(E,0,E.length)),w.tabs[m][v]=T}else if(m=="PLTE")w.tabs[m]=_.readBytes(i,f,I);else if(m=="hIST"){let h=w.tabs.PLTE.length/3;for(w.tabs[m]=[],F=0;F<h;F++)w.tabs[m].push(R(i,f+2*F))}else if(m=="tRNS")w.ctype==3?w.tabs[m]=_.readBytes(i,f,I):w.ctype==0?w.tabs[m]=R(i,f):w.ctype==2&&(w.tabs[m]=[R(i,f),R(i,f+2),R(i,f+4)]);else if(m=="gAMA")w.tabs[m]=_.readUint(i,f)/1e5;else if(m=="sRGB")w.tabs[m]=i[f];else if(m=="bKGD")w.ctype==0||w.ctype==4?w.tabs[m]=[R(i,f)]:w.ctype==2||w.ctype==6?w.tabs[m]=[R(i,f),R(i,f+2),R(i,f+4)]:w.ctype==3&&(w.tabs[m]=i[f]);else if(m=="IEND")break;f+=I,_.readUint(i,f),f+=4}var y;return B!=0&&((y=w.frames[w.frames.length-1]).data=a(w,x.slice(0,B),y.rect.width,y.rect.height)),w.data=a(w,M,w.width,w.height),delete w.compress,delete w.interlace,delete w.filter,w},toRGBA8:function(c){let i=c.width,f=c.height;if(c.tabs.acTL==null)return[n(c.data,i,f,c).buffer];let _=[];c.frames[0].data==null&&(c.frames[0].data=c.data);let R=i*f*4,k=new Uint8Array(R),w=new Uint8Array(R),M=new Uint8Array(R);for(let S=0;S<c.frames.length;S++){let B=c.frames[S],A=B.rect.x,F=B.rect.y,d=B.rect.width,p=B.rect.height,v=n(B.data,d,p,c);if(S!=0)for(var x=0;x<R;x++)M[x]=k[x];if(B.blend==0?b(v,d,p,k,i,f,A,F,0):B.blend==1&&b(v,d,p,k,i,f,A,F,1),_.push(k.buffer.slice(0)),B.dispose!=0){if(B.dispose==1)b(w,d,p,k,i,f,A,F,0);else if(B.dispose==2)for(x=0;x<R;x++)k[x]=M[x]}}return _},_paeth:u,_copyTile:b,_bin:s}}();(function(){let{_copyTile:s}=Ae,{_bin:n}=Ae,a=Ae._paeth;var r={table:function(){let d=new Uint32Array(256);for(let p=0;p<256;p++){let v=p;for(let U=0;U<8;U++)1&v?v=3988292384^v>>>1:v>>>=1;d[p]=v}return d}(),update(d,p,v,U){for(let E=0;E<U;E++)d=r.table[255&(d^p[v+E])]^d>>>8;return d},crc:(d,p,v)=>4294967295^r.update(4294967295,d,p,v)};function e(d,p,v,U){p[v]+=d[0]*U>>4,p[v+1]+=d[1]*U>>4,p[v+2]+=d[2]*U>>4,p[v+3]+=d[3]*U>>4}function t(d){return Math.max(0,Math.min(255,d))}function l(d,p){let v=d[0]-p[0],U=d[1]-p[1],E=d[2]-p[2],T=d[3]-p[3];return v*v+U*U+E*E+T*T}function u(d,p,v,U,E,T,y){y==null&&(y=1);let I=U.length,m=[];for(var h=0;h<I;h++){let O=U[h];m.push([O>>>0&255,O>>>8&255,O>>>16&255,O>>>24&255])}for(h=0;h<I;h++){let O=4294967295;for(var N=0,C=0;C<I;C++){var P=l(m[h],m[C]);C!=h&&P<O&&(O=P,N=C)}}let z=new Uint32Array(E.buffer),L=new Int16Array(p*v*4),H=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(h=0;h<H.length;h++)H[h]=255*((H[h]+.5)/16-.5);for(let O=0;O<v;O++)for(let q=0;q<p;q++){var D;h=4*(O*p+q),y!=2?D=[t(d[h]+L[h]),t(d[h+1]+L[h+1]),t(d[h+2]+L[h+2]),t(d[h+3]+L[h+3])]:(P=H[4*(3&O)+(3&q)],D=[t(d[h]+P),t(d[h+1]+P),t(d[h+2]+P),t(d[h+3]+P)]),N=0;let V=16777215;for(C=0;C<I;C++){let $=l(D,m[C]);$<V&&(V=$,N=C)}let j=m[N],Q=[D[0]-j[0],D[1]-j[1],D[2]-j[2],D[3]-j[3]];y==1&&(q!=p-1&&e(Q,L,h+4,7),O!=v-1&&(q!=0&&e(Q,L,h+4*p-4,3),e(Q,L,h+4*p,5),q!=p-1&&e(Q,L,h+4*p+4,1))),T[h>>2]=N,z[h>>2]=U[N]}}function g(d,p,v,U,E){E==null&&(E={});let{crc:T}=r,y=n.writeUint,I=n.writeUshort,m=n.writeASCII,h=8,N=d.frames.length>1,C,P=!1,z=33+(N?20:0);if(E.sRGB!=null&&(z+=13),E.pHYs!=null&&(z+=21),E.iCCP!=null&&(C=pako.deflate(E.iCCP),z+=21+C.length+4),d.ctype==3){for(var L=d.plte.length,H=0;H<L;H++)d.plte[H]>>>24!=255&&(P=!0);z+=8+3*L+4+(P?8+1*L+4:0)}for(var D=0;D<d.frames.length;D++)N&&(z+=38),z+=(j=d.frames[D]).cimg.length+12,D!=0&&(z+=4);z+=12;let O=new Uint8Array(z),q=[137,80,78,71,13,10,26,10];for(H=0;H<8;H++)O[H]=q[H];if(y(O,h,13),h+=4,m(O,h,"IHDR"),h+=4,y(O,h,p),h+=4,y(O,h,v),h+=4,O[h]=d.depth,h++,O[h]=d.ctype,h++,O[h]=0,h++,O[h]=0,h++,O[h]=0,h++,y(O,h,T(O,h-17,17)),h+=4,E.sRGB!=null&&(y(O,h,1),h+=4,m(O,h,"sRGB"),h+=4,O[h]=E.sRGB,h++,y(O,h,T(O,h-5,5)),h+=4),E.iCCP!=null){let Q=13+C.length;y(O,h,Q),h+=4,m(O,h,"iCCP"),h+=4,m(O,h,"ICC profile"),h+=11,h+=2,O.set(C,h),h+=C.length,y(O,h,T(O,h-(Q+4),Q+4)),h+=4}if(E.pHYs!=null&&(y(O,h,9),h+=4,m(O,h,"pHYs"),h+=4,y(O,h,E.pHYs[0]),h+=4,y(O,h,E.pHYs[1]),h+=4,O[h]=E.pHYs[2],h++,y(O,h,T(O,h-13,13)),h+=4),N&&(y(O,h,8),h+=4,m(O,h,"acTL"),h+=4,y(O,h,d.frames.length),h+=4,y(O,h,E.loop!=null?E.loop:0),h+=4,y(O,h,T(O,h-12,12)),h+=4),d.ctype==3){for(y(O,h,3*(L=d.plte.length)),h+=4,m(O,h,"PLTE"),h+=4,H=0;H<L;H++){let Q=3*H,$=d.plte[H],J=255&$,ne=$>>>8&255,Ie=$>>>16&255;O[h+Q+0]=J,O[h+Q+1]=ne,O[h+Q+2]=Ie}if(h+=3*L,y(O,h,T(O,h-3*L-4,3*L+4)),h+=4,P){for(y(O,h,L),h+=4,m(O,h,"tRNS"),h+=4,H=0;H<L;H++)O[h+H]=d.plte[H]>>>24&255;h+=L,y(O,h,T(O,h-L-4,L+4)),h+=4}}let V=0;for(D=0;D<d.frames.length;D++){var j=d.frames[D];N&&(y(O,h,26),h+=4,m(O,h,"fcTL"),h+=4,y(O,h,V++),h+=4,y(O,h,j.rect.width),h+=4,y(O,h,j.rect.height),h+=4,y(O,h,j.rect.x),h+=4,y(O,h,j.rect.y),h+=4,I(O,h,U[D]),h+=2,I(O,h,1e3),h+=2,O[h]=j.dispose,h++,O[h]=j.blend,h++,y(O,h,T(O,h-30,30)),h+=4);let Q=j.cimg;y(O,h,(L=Q.length)+(D==0?0:4)),h+=4;let $=h;m(O,h,D==0?"IDAT":"fdAT"),h+=4,D!=0&&(y(O,h,V++),h+=4),O.set(Q,h),h+=L,y(O,h,T(O,$,h-$)),h+=4}return y(O,h,0),h+=4,m(O,h,"IEND"),h+=4,y(O,h,T(O,h-4,4)),h+=4,O.buffer}function b(d,p,v){for(let U=0;U<d.frames.length;U++){let E=d.frames[U];E.rect.width;let T=E.rect.height,y=new Uint8Array(T*E.bpl+T);E.cimg=f(E.img,T,E.bpp,E.bpl,y,p,v)}}function o(d,p,v,U,E){let T=E[0],y=E[1],I=E[2],m=E[3],h=E[4],N=E[5],C=6,P=8,z=255;for(var L=0;L<d.length;L++){let oe=new Uint8Array(d[L]);for(var H=oe.length,D=0;D<H;D+=4)z&=oe[D+3]}let O=z!=255,q=function(X,W,re,le,ee,de){let te=[];for(var G=0;G<X.length;G++){let ce=new Uint8Array(X[G]),me=new Uint32Array(ce.buffer);var pe;let ge=0,Ee=0,we=W,xe=re,gt=le?1:0;if(G!=0){let Vn=de||le||G==1||te[G-2].dispose!=0?1:2,mt=0,Lt=1e9;for(let Ge=0;Ge<Vn;Ge++){var Te=new Uint8Array(X[G-1-Ge]);let Xn=new Uint32Array(X[G-1-Ge]),ke=W,Se=re,Ne=-1,Ve=-1;for(let Fe=0;Fe<re;Fe++)for(let Oe=0;Oe<W;Oe++)me[ae=Fe*W+Oe]!=Xn[ae]&&(Oe<ke&&(ke=Oe),Oe>Ne&&(Ne=Oe),Fe<Se&&(Se=Fe),Fe>Ve&&(Ve=Fe));Ne==-1&&(ke=Se=Ne=Ve=0),ee&&((1&ke)==1&&ke--,(1&Se)==1&&Se--);let Ht=(Ne-ke+1)*(Ve-Se+1);Ht<Lt&&(Lt=Ht,mt=Ge,ge=ke,Ee=Se,we=Ne-ke+1,xe=Ve-Se+1)}Te=new Uint8Array(X[G-1-mt]),mt==1&&(te[G-1].dispose=2),pe=new Uint8Array(we*xe*4),s(Te,W,re,pe,we,xe,-ge,-Ee,0),gt=s(ce,W,re,pe,we,xe,-ge,-Ee,3)?1:0,gt==1?i(ce,W,re,pe,{x:ge,y:Ee,width:we,height:xe}):s(ce,W,re,pe,we,xe,-ge,-Ee,0)}else pe=ce.slice(0);te.push({rect:{x:ge,y:Ee,width:we,height:xe},img:pe,blend:gt,dispose:0})}if(le)for(G=0;G<te.length;G++){if((Ce=te[G]).blend==1)continue;let ce=Ce.rect,me=te[G-1].rect,ge=Math.min(ce.x,me.x),Ee=Math.min(ce.y,me.y),we={x:ge,y:Ee,width:Math.max(ce.x+ce.width,me.x+me.width)-ge,height:Math.max(ce.y+ce.height,me.y+me.height)-Ee};te[G-1].dispose=1,G-1!=0&&c(X,W,re,te,G-1,we,ee),c(X,W,re,te,G,we,ee)}let nt=0;if(X.length!=1)for(var ae=0;ae<te.length;ae++){var Ce;nt+=(Ce=te[ae]).rect.width*Ce.rect.height}return te}(d,p,v,T,y,I),V={},j=[],Q=[];if(U!=0){let oe=[];for(D=0;D<q.length;D++)oe.push(q[D].img.buffer);let X=function(ee){let de=0;for(var te=0;te<ee.length;te++)de+=ee[te].byteLength;let G=new Uint8Array(de),pe=0;for(te=0;te<ee.length;te++){let Te=new Uint8Array(ee[te]),nt=Te.length;for(let ae=0;ae<nt;ae+=4){let Ce=Te[ae],ce=Te[ae+1],me=Te[ae+2],ge=Te[ae+3];ge==0&&(Ce=ce=me=0),G[pe+ae]=Ce,G[pe+ae+1]=ce,G[pe+ae+2]=me,G[pe+ae+3]=ge}pe+=nt}return G.buffer}(oe),W=R(X,U);for(D=0;D<W.plte.length;D++)j.push(W.plte[D].est.rgba);let re=0;for(D=0;D<q.length;D++){let le=(J=q[D]).img.length;var $=new Uint8Array(W.inds.buffer,re>>2,le>>2);Q.push($);let ee=new Uint8Array(W.abuf,re,le);N&&u(J.img,J.rect.width,J.rect.height,j,ee,$),J.img.set(ee),re+=le}}else for(L=0;L<q.length;L++){var J=q[L];let oe=new Uint32Array(J.img.buffer);var ne=J.rect.width;for(H=oe.length,$=new Uint8Array(H),Q.push($),D=0;D<H;D++){let X=oe[D];if(D!=0&&X==oe[D-1])$[D]=$[D-1];else if(D>ne&&X==oe[D-ne])$[D]=$[D-ne];else{let W=V[X];if(W==null&&(V[X]=W=j.length,j.push(X),j.length>=300))break;$[D]=W}}}let Ie=j.length;for(Ie<=256&&h==0&&(P=Ie<=2?1:Ie<=4?2:Ie<=16?4:8,P=Math.max(P,m)),L=0;L<q.length;L++){(J=q[L]).rect.x,J.rect.y,ne=J.rect.width;let oe=J.rect.height,X=J.img;new Uint32Array(X.buffer);let W=4*ne,re=4;if(Ie<=256&&h==0){W=Math.ceil(P*ne/8);var be=new Uint8Array(W*oe);let le=Q[L];for(let ee=0;ee<oe;ee++){D=ee*W;let de=ee*ne;if(P==8)for(var Y=0;Y<ne;Y++)be[D+Y]=le[de+Y];else if(P==4)for(Y=0;Y<ne;Y++)be[D+(Y>>1)]|=le[de+Y]<<4-4*(1&Y);else if(P==2)for(Y=0;Y<ne;Y++)be[D+(Y>>2)]|=le[de+Y]<<6-2*(3&Y);else if(P==1)for(Y=0;Y<ne;Y++)be[D+(Y>>3)]|=le[de+Y]<<7-1*(7&Y)}X=be,C=3,re=1}else if(O==0&&q.length==1){be=new Uint8Array(ne*oe*3);let le=ne*oe;for(D=0;D<le;D++){let ee=3*D,de=4*D;be[ee]=X[de],be[ee+1]=X[de+1],be[ee+2]=X[de+2]}X=be,C=2,re=3,W=3*ne}J.img=X,J.bpl=W,J.bpp=re}return{ctype:C,depth:P,plte:j,frames:q}}function c(d,p,v,U,E,T,y){let I=Uint8Array,m=Uint32Array,h=new I(d[E-1]),N=new m(d[E-1]),C=E+1<d.length?new I(d[E+1]):null,P=new I(d[E]),z=new m(P.buffer),L=p,H=v,D=-1,O=-1;for(let V=0;V<T.height;V++)for(let j=0;j<T.width;j++){let Q=T.x+j,$=T.y+V,J=$*p+Q,ne=z[J];ne==0||U[E-1].dispose==0&&N[J]==ne&&(C==null||C[4*J+3]!=0)||(Q<L&&(L=Q),Q>D&&(D=Q),$<H&&(H=$),$>O&&(O=$))}D==-1&&(L=H=D=O=0),y&&((1&L)==1&&L--,(1&H)==1&&H--),T={x:L,y:H,width:D-L+1,height:O-H+1};let q=U[E];q.rect=T,q.blend=1,q.img=new Uint8Array(T.width*T.height*4),U[E-1].dispose==0?(s(h,p,v,q.img,T.width,T.height,-T.x,-T.y,0),i(P,p,v,q.img,T)):s(P,p,v,q.img,T.width,T.height,-T.x,-T.y,0)}function i(d,p,v,U,E){s(d,p,v,U,E.width,E.height,-E.x,-E.y,2)}function f(d,p,v,U,E,T,y){let I=[],m,h=[0,1,2,3,4];T!=-1?h=[T]:(p*U>5e5||v==1)&&(h=[0]),y&&(m={level:0});let N=os;for(var C=0;C<h.length;C++){for(let L=0;L<p;L++)_(E,d,L,U,v,h[C]);I.push(N.deflate(E,m))}let P,z=1e9;for(C=0;C<I.length;C++)I[C].length<z&&(P=C,z=I[C].length);return I[P]}function _(d,p,v,U,E,T){let y=v*U,I=y+v;if(d[I]=T,I++,T==0)if(U<500)for(var m=0;m<U;m++)d[I+m]=p[y+m];else d.set(new Uint8Array(p.buffer,y,U),I);else if(T==1){for(m=0;m<E;m++)d[I+m]=p[y+m];for(m=E;m<U;m++)d[I+m]=p[y+m]-p[y+m-E]+256&255}else if(v==0){for(m=0;m<E;m++)d[I+m]=p[y+m];if(T==2)for(m=E;m<U;m++)d[I+m]=p[y+m];if(T==3)for(m=E;m<U;m++)d[I+m]=p[y+m]-(p[y+m-E]>>1)+256&255;if(T==4)for(m=E;m<U;m++)d[I+m]=p[y+m]-a(p[y+m-E],0,0)+256&255}else{if(T==2)for(m=0;m<U;m++)d[I+m]=p[y+m]+256-p[y+m-U]&255;if(T==3){for(m=0;m<E;m++)d[I+m]=p[y+m]+256-(p[y+m-U]>>1)&255;for(m=E;m<U;m++)d[I+m]=p[y+m]+256-(p[y+m-U]+p[y+m-E]>>1)&255}if(T==4){for(m=0;m<E;m++)d[I+m]=p[y+m]+256-a(0,p[y+m-U],0)&255;for(m=E;m<U;m++)d[I+m]=p[y+m]+256-a(p[y+m-E],p[y+m-U],p[y+m-E-U])&255}}}function R(d,p){let v=new Uint8Array(d),U=v.slice(0),E=new Uint32Array(U.buffer),T=k(U,p),y=T[0],I=T[1],m=v.length,h=new Uint8Array(m>>2),N;if(v.length<2e7)for(var C=0;C<m;C+=4)N=w(y,P=v[C]*(1/255),z=v[C+1]*(1/255),L=v[C+2]*(1/255),H=v[C+3]*(1/255)),h[C>>2]=N.ind,E[C>>2]=N.est.rgba;else for(C=0;C<m;C+=4){var P=v[C]*.00392156862745098,z=v[C+1]*(1/255),L=v[C+2]*(1/255),H=v[C+3]*(1/255);for(N=y;N.left;)N=M(N.est,P,z,L,H)<=0?N.left:N.right;h[C>>2]=N.ind,E[C>>2]=N.est.rgba}return{abuf:U.buffer,inds:h,plte:I}}function k(d,p,v){v==null&&(v=1e-4);let U=new Uint32Array(d.buffer),E={i0:0,i1:d.length,bst:null,est:null,tdst:0,left:null,right:null};E.bst=B(d,E.i0,E.i1),E.est=A(E.bst);let T=[E];for(;T.length<p;){let I=0,m=0;for(var y=0;y<T.length;y++)T[y].est.L>I&&(I=T[y].est.L,m=y);if(I<v)break;let h=T[m],N=x(d,U,h.i0,h.i1,h.est.e,h.est.eMq255);if(h.i0>=N||h.i1<=N){h.est.L=0;continue}let C={i0:h.i0,i1:N,bst:null,est:null,tdst:0,left:null,right:null};C.bst=B(d,C.i0,C.i1),C.est=A(C.bst);let P={i0:N,i1:h.i1,bst:null,est:null,tdst:0,left:null,right:null};for(P.bst={R:[],m:[],N:h.bst.N-C.bst.N},y=0;y<16;y++)P.bst.R[y]=h.bst.R[y]-C.bst.R[y];for(y=0;y<4;y++)P.bst.m[y]=h.bst.m[y]-C.bst.m[y];P.est=A(P.bst),h.left=C,h.right=P,T[m]=C,T.push(P)}for(T.sort((I,m)=>m.bst.N-I.bst.N),y=0;y<T.length;y++)T[y].ind=y;return[E,T]}function w(d,p,v,U,E){if(d.left==null)return d.tdst=function(C,P,z,L,H){let D=P-C[0],O=z-C[1],q=L-C[2],V=H-C[3];return D*D+O*O+q*q+V*V}(d.est.q,p,v,U,E),d;let T=M(d.est,p,v,U,E),y=d.left,I=d.right;T>0&&(y=d.right,I=d.left);let m=w(y,p,v,U,E);if(m.tdst<=T*T)return m;let h=w(I,p,v,U,E);return h.tdst<m.tdst?h:m}function M(d,p,v,U,E){let{e:T}=d;return T[0]*p+T[1]*v+T[2]*U+T[3]*E-d.eMq}function x(d,p,v,U,E,T){for(U-=4;v<U;){for(;S(d,v,E)<=T;)v+=4;for(;S(d,U,E)>T;)U-=4;if(v>=U)break;let y=p[v>>2];p[v>>2]=p[U>>2],p[U>>2]=y,v+=4,U-=4}for(;S(d,v,E)>T;)v-=4;return v+4}function S(d,p,v){return d[p]*v[0]+d[p+1]*v[1]+d[p+2]*v[2]+d[p+3]*v[3]}function B(d,p,v){let U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],E=[0,0,0,0],T=v-p>>2;for(let y=p;y<v;y+=4){let I=d[y]*.00392156862745098,m=d[y+1]*(1/255),h=d[y+2]*(1/255),N=d[y+3]*(1/255);E[0]+=I,E[1]+=m,E[2]+=h,E[3]+=N,U[0]+=I*I,U[1]+=I*m,U[2]+=I*h,U[3]+=I*N,U[5]+=m*m,U[6]+=m*h,U[7]+=m*N,U[10]+=h*h,U[11]+=h*N,U[15]+=N*N}return U[4]=U[1],U[8]=U[2],U[9]=U[6],U[12]=U[3],U[13]=U[7],U[14]=U[11],{R:U,m:E,N:T}}function A(d){let{R:p}=d,{m:v}=d,{N:U}=d,E=v[0],T=v[1],y=v[2],I=v[3],m=U==0?0:1/U,h=[p[0]-E*E*m,p[1]-E*T*m,p[2]-E*y*m,p[3]-E*I*m,p[4]-T*E*m,p[5]-T*T*m,p[6]-T*y*m,p[7]-T*I*m,p[8]-y*E*m,p[9]-y*T*m,p[10]-y*y*m,p[11]-y*I*m,p[12]-I*E*m,p[13]-I*T*m,p[14]-I*y*m,p[15]-I*I*m],N=h,C=F,P=[Math.random(),Math.random(),Math.random(),Math.random()],z=0,L=0;if(U!=0)for(let D=0;D<16&&(P=C.multVec(N,P),L=Math.sqrt(C.dot(P,P)),P=C.sml(1/L,P),!(D!=0&&Math.abs(L-z)<1e-9));D++)z=L;let H=[E*m,T*m,y*m,I*m];return{Cov:h,q:H,e:P,L:z,eMq255:C.dot(C.sml(255,H),P),eMq:C.dot(P,H),rgba:(Math.round(255*H[3])<<24|Math.round(255*H[2])<<16|Math.round(255*H[1])<<8|Math.round(255*H[0])<<0)>>>0}}var F={multVec:(d,p)=>[d[0]*p[0]+d[1]*p[1]+d[2]*p[2]+d[3]*p[3],d[4]*p[0]+d[5]*p[1]+d[6]*p[2]+d[7]*p[3],d[8]*p[0]+d[9]*p[1]+d[10]*p[2]+d[11]*p[3],d[12]*p[0]+d[13]*p[1]+d[14]*p[2]+d[15]*p[3]],dot:(d,p)=>d[0]*p[0]+d[1]*p[1]+d[2]*p[2]+d[3]*p[3],sml:(d,p)=>[d*p[0],d*p[1],d*p[2],d*p[3]]};Ae.encode=function(p,v,U,E,T,y,I){E==null&&(E=0),I==null&&(I=!1);let m=o(p,v,U,E,[!1,!1,!1,0,I,!1]);return b(m,-1),g(m,v,U,T,y)},Ae.encodeLL=function(p,v,U,E,T,y,I,m){let h={ctype:0+(E==1?0:2)+(T==0?0:4),depth:y,frames:[]},N=(E+T)*y,C=N*v;for(let P=0;P<p.length;P++)h.frames.push({rect:{x:0,y:0,width:v,height:U},img:new Uint8Array(p[P]),blend:0,dispose:1,bpp:Math.ceil(N/8),bpl:Math.ceil(C/8)});return b(h,0,!0),g(h,v,U,I,m)},Ae.encode.compress=o,Ae.encode.dither=u,Ae.quantize=R,Ae.quantize.getKDtree=k,Ae.quantize.getNearest=w})();var Dn={toArrayBuffer(s,n){let a=s.width,r=s.height,e=a<<2,t=s.getContext("2d").getImageData(0,0,a,r),l=new Uint32Array(t.data.buffer),u=(32*a+31)/32<<2,g=u*r,b=122+g,o=new ArrayBuffer(b),c=new DataView(o),i=1<<20,f,_,R,k,w=i,M=0,x=0,S=0;function B(d){c.setUint16(x,d,!0),x+=2}function A(d){c.setUint32(x,d,!0),x+=4}function F(d){x+=d}B(19778),A(b),F(4),A(122),A(108),A(a),A(-r>>>0),B(1),B(32),A(3),A(g),A(2835),A(2835),F(8),A(16711680),A(65280),A(255),A(4278190080),A(1466527264),function d(){for(;M<r&&w>0;){for(k=122+M*u,f=0;f<e;)w--,_=l[S++],R=_>>>24,c.setUint32(k+f,_<<8|R),f+=4;M++}S<l.length?(w=i,setTimeout(d,Dn._dly)):n(o)}()},toBlob(s,n){this.toArrayBuffer(s,a=>{n(new Blob([a],{type:"image/bmp"}))})},_dly:9},he={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},as={[he.CHROME]:16384,[he.FIREFOX]:11180,[he.DESKTOP_SAFARI]:16384,[he.IE]:8192,[he.IOS]:4096,[he.ETC]:8192},Nt=typeof window<"u",Ln=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,ft=Nt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),ls=(Nt||Ln)&&(ft&&ft.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Hn=(Nt||Ln)&&(ft&&ft.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Dt(s,n,a=Date.now()){return new Promise(r=>{let e=s.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]),u=l.length,g=new Uint8Array(u);for(;u--;)g[u]=l.charCodeAt(u);let b=new Blob([g],{type:t});b.name=n,b.lastModified=a,r(b)})}function zn(s){return new Promise((n,a)=>{let r=new Hn;r.onload=()=>n(r.result),r.onerror=e=>a(e),r.readAsDataURL(s)})}function qn(s){return new Promise((n,a)=>{let r=new Image;r.onload=()=>n(r),r.onerror=e=>a(e),r.src=s})}function Me(){if(Me.cachedResult!==void 0)return Me.cachedResult;let s=he.ETC,{userAgent:n}=navigator;return/Chrom(e|ium)/i.test(n)?s=he.CHROME:/iP(ad|od|hone)/i.test(n)&&/WebKit/i.test(n)?s=he.IOS:/Safari/i.test(n)?s=he.DESKTOP_SAFARI:/Firefox/i.test(n)?s=he.FIREFOX:(/MSIE/i.test(n)||document.documentMode)&&(s=he.IE),Me.cachedResult=s,Me.cachedResult}function Qn(s,n){let a=Me(),r=as[a],e=s,t=n,l=e*t,u=e>t?t/e:e/t;for(;l>r*r;){let g=(r+e)/2,b=(r+t)/2;g<b?(t=b,e=b*u):(t=g*u,e=g),l=e*t}return{width:e,height:t}}function pt(s,n){let a,r;try{if(a=new OffscreenCanvas(s,n),r=a.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{a=document.createElement("canvas"),r=a.getContext("2d")}return a.width=s,a.height=n,[a,r]}function jn(s,n){let{width:a,height:r}=Qn(s.width,s.height),[e,t]=pt(a,r);return n&&/jpe?g/.test(n)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(s,0,0,e.width,e.height),e}function ct(){return ct.cachedResult!==void 0||(ct.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),ct.cachedResult}function ht(s,n={}){return new Promise(function(a,r){let e,t;var l=function(){try{return t=jn(e,n.fileType||s.type),a([e,t])}catch(g){return r(g)}},u=function(g){try{var b=function(o){try{throw o}catch(c){return r(c)}};try{let o;return zn(s).then(function(c){try{return o=c,qn(o).then(function(i){try{return e=i,function(){try{return l()}catch(f){return r(f)}}()}catch(f){return b(f)}},b)}catch(i){return b(i)}},b)}catch(o){b(o)}}catch(o){return r(o)}};try{if(ct()||[he.DESKTOP_SAFARI,he.MOBILE_SAFARI].includes(Me()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(s).then(function(g){try{return e=g,l()}catch{return u()}},u)}catch{u()}})}function dt(s,n,a,r,e=1){return new Promise(function(t,l){let u;if(n==="image/png"){let c,i,f;return c=s.getContext("2d"),{data:i}=c.getImageData(0,0,s.width,s.height),f=Ae.encode([i.buffer],s.width,s.height,4096*e),u=new Blob([f],{type:n}),u.name=a,u.lastModified=r,g.call(this)}{let c=function(){return g.call(this)};var b=c;if(n==="image/bmp")return new Promise(i=>Dn.toBlob(s,i)).then(function(i){try{return u=i,u.name=a,u.lastModified=r,c.call(this)}catch(f){return l(f)}}.bind(this),l);{let i=function(){return c.call(this)};var o=i;if(typeof OffscreenCanvas=="function"&&s instanceof OffscreenCanvas)return s.convertToBlob({type:n,quality:e}).then(function(f){try{return u=f,u.name=a,u.lastModified=r,i.call(this)}catch(_){return l(_)}}.bind(this),l);{let f;return f=s.toDataURL(n,e),Dt(f,a,r).then(function(_){try{return u=_,i.call(this)}catch(R){return l(R)}}.bind(this),l)}}}function g(){return t(u)}})}function ve(s){s.width=0,s.height=0}function We(){return new Promise(function(s,n){let a,r,e,t,l;return We.cachedResult!==void 0?s(We.cachedResult):(a="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==",Dt("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(u){try{return r=u,ht(r).then(function(g){try{return e=g[1],dt(e,r.type,r.name,r.lastModified).then(function(b){try{return t=b,ve(e),ht(t).then(function(o){try{return l=o[0],We.cachedResult=l.width===1&&l.height===2,s(We.cachedResult)}catch(c){return n(c)}},n)}catch(o){return n(o)}},n)}catch(b){return n(b)}},n)}catch(g){return n(g)}},n))})}function $n(s){return new Promise((n,a)=>{let r=new Hn;r.onload=e=>{let t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return n(-2);let l=t.byteLength,u=2;for(;u<l;){if(t.getUint16(u+2,!1)<=8)return n(-1);let g=t.getUint16(u,!1);if(u+=2,g==65505){if(t.getUint32(u+=2,!1)!=1165519206)return n(-1);let b=t.getUint16(u+=6,!1)==18761;u+=t.getUint32(u+4,b);let o=t.getUint16(u,b);u+=2;for(let c=0;c<o;c++)if(t.getUint16(u+12*c,b)==274)return n(t.getUint16(u+12*c+8,b))}else{if((65280&g)!=65280)break;u+=t.getUint16(u,!1)}}return n(-1)},r.onerror=e=>a(e),r.readAsArrayBuffer(s)})}function Wn(s,n){let{width:a}=s,{height:r}=s,{maxWidthOrHeight:e}=n,t,l=s;return isFinite(e)&&(a>e||r>e)&&([l,t]=pt(a,r),a>r?(l.width=e,l.height=r/a*e):(l.width=a/r*e,l.height=e),t.drawImage(s,0,0,l.width,l.height),ve(s)),l}function Gn(s,n){let{width:a}=s,{height:r}=s,[e,t]=pt(a,r);switch(n>4&&n<9?(e.width=r,e.height=a):(e.width=a,e.height=r),n){case 2:t.transform(-1,0,0,1,a,0);break;case 3:t.transform(-1,0,0,-1,a,r);break;case 4:t.transform(1,0,0,-1,0,r);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,r,0);break;case 7:t.transform(0,-1,-1,0,r,a);break;case 8:t.transform(0,-1,1,0,0,a)}return t.drawImage(s,0,0,a,r),ve(s),e}function Mn(s,n,a=0){return new Promise(function(r,e){let t,l,u,g,b,o,c,i,f,_,R,k,w,M,x,S,B,A,F,d;function p(U=5){if(n.signal&&n.signal.aborted)throw n.signal.reason;t+=U,n.onProgress(Math.min(t,100))}function v(U){if(n.signal&&n.signal.aborted)throw n.signal.reason;t=Math.min(Math.max(U,t),100),n.onProgress(t)}return t=a,l=n.maxIteration||10,u=1024*n.maxSizeMB*1024,p(),ht(s,n).then(function(U){try{return[,g]=U,p(),b=Wn(g,n),p(),new Promise(function(E,T){var y;if(!(y=n.exifOrientation))return $n(s).then(function(m){try{return y=m,I.call(this)}catch(h){return T(h)}}.bind(this),T);function I(){return E(y)}return I.call(this)}).then(function(E){try{return o=E,p(),We().then(function(T){try{return c=T?b:Gn(b,o),p(),i=n.initialQuality||1,f=n.fileType||s.type,dt(c,f,s.name,s.lastModified,i).then(function(y){try{{let N=function(){if(l--&&(x>u||x>w)){let P,z;return P=d?.95*F.width:F.width,z=d?.95*F.height:F.height,[B,A]=pt(P,z),A.drawImage(F,0,0,P,z),i*=f==="image/png"?.85:.95,dt(B,f,s.name,s.lastModified,i).then(function(L){try{return S=L,ve(F),F=B,x=S.size,v(Math.min(99,Math.floor((M-x)/(M-u)*100))),N}catch(H){return e(H)}},e)}return[1]},C=function(){return ve(F),ve(B),ve(b),ve(c),ve(g),v(100),r(S)};var m=N,h=C;if(_=y,p(),R=_.size>u,k=_.size>s.size,!R&&!k)return v(100),r(_);var I;return w=s.size,M=_.size,x=M,F=c,d=!n.alwaysKeepResolution&&R,(I=function(P){for(;P;){if(P.then)return void P.then(I,e);try{if(P.pop){if(P.length)return P.pop()?C.call(this):P;P=N}else P=P.call(this)}catch(z){return e(z)}}}.bind(this))(N)}}catch(N){return e(N)}}.bind(this),e)}catch(y){return e(y)}}.bind(this),e)}catch(T){return e(T)}}.bind(this),e)}catch(E){return e(E)}}.bind(this),e)})}var cs=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`,Mt;function us(s,n){return new Promise((a,r)=>{Mt||(Mt=function(l){let u=[];return typeof l=="function"?u.push(`(${l})()`):u.push(l),URL.createObjectURL(new Blob(u))}(cs));let e=new Worker(Mt);e.addEventListener("message",function(l){if(n.signal&&n.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return r(new Error(l.data.error)),void e.terminate();a(l.data.file),e.terminate()}else n.onProgress(l.data.progress)}),e.addEventListener("error",r),n.signal&&n.signal.addEventListener("abort",()=>{r(n.signal.reason),e.terminate()}),e.postMessage({file:s,imageCompressionLibUrl:n.libURL,options:Xe(Pe({},n),{onProgress:void 0,signal:void 0})})})}function ie(s,n){return new Promise(function(a,r){let e,t,l,u,g,b;if(e=Pe({},n),l=0,{onProgress:u}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,g=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=f=>{l=f,typeof u=="function"&&u(l)},!(s instanceof Blob||s instanceof ls))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(s.type))return r(new Error("The file given is not an image"));if(b=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!g||typeof Worker!="function"||b)return Mn(s,e).then(function(f){try{return t=f,i.call(this)}catch(_){return r(_)}}.bind(this),r);var o=function(){try{return i.call(this)}catch(f){return r(f)}}.bind(this),c=function(f){try{return Mn(s,e).then(function(_){try{return t=_,o()}catch(R){return r(R)}},r)}catch(_){return r(_)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",us(s,e).then(function(f){try{return t=f,o()}catch{return c()}},c)}catch{c()}function i(){try{t.name=s.name,t.lastModified=s.lastModified}catch{}try{e.preserveExif&&s.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===s.type)&&(t=Nn(s,t))}catch{}return a(t)}})}ie.getDataUrlFromFile=zn,ie.getFilefromDataUrl=Dt,ie.loadImage=qn,ie.drawImageInCanvas=jn,ie.drawFileInCanvas=ht,ie.canvasToFile=dt,ie.getExifOrientation=$n,ie.handleMaxWidthOrHeight=Wn,ie.followExifOrientation=Gn,ie.cleanupCanvasMemory=ve,ie.isAutoOrientationInBrowser=We,ie.approximateBelowMaximumCanvasSizeOfBrowser=Qn,ie.copyExifWithoutOrientation=Nn,ie.getBrowserName=Me,ie.version="2.0.2";var Ts=(()=>{class s{constructor(a){this.firebaseService=a,this.adsSubject=new zt([]),this.ads$=this.adsSubject.asObservable(),this.unsubscribe=null,this.db=this.firebaseService.db,this.storage=Bn(this.firebaseService.app),this.testStorageConnection()}testStorageConnection(){return ue(this,null,function*(){try{let a=lt(this.storage,"ads/");console.log("\u2705 Firebase Storage initialized successfully"),console.log("Storage bucket:",this.storage.app.options.storageBucket)}catch(a){console.error("\u274C Firebase Storage connection failed:",a),console.error("Please ensure Firebase Storage is enabled in your Firebase console")}})}startListening(a){let r=bt(this.db,"ads"),e=wt(r,yt("uploadDate","desc"));a&&(e=wt(r,tn("createdBy","==",a),yt("uploadDate","desc"))),this.unsubscribe=sn(e,t=>{let l=t.docs.map(u=>{let g=u.data();return Xe(Pe({id:u.id},g),{uploadDate:g.uploadDate?.toDate()||new Date,updatedAt:g.updatedAt?.toDate()})});this.adsSubject.next(l)})}stopListening(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}getAds(){return this.ads$}createAd(a,r){return ue(this,null,function*(){try{let e="",t="";a.mediaFile&&(e=yield this.uploadFile(a.mediaFile,"ads/media")),a.thumbnailFile?t=yield this.uploadFile(a.thumbnailFile,"ads/thumbnails"):t=a.type==="image"?e:"";let l=this.getResolutionFromAspectRatio(a.aspectRatio),u={title:a.title,type:a.type,status:a.status||"draft",thumbnailUrl:t,mediaUrl:e,aspectRatio:a.aspectRatio,resolution:l,description:a.description||"",targetUrl:a.targetUrl||"",uploadDate:rt.now(),createdBy:r,views:0,impressions:0,clicks:0,ctr:0};return(yield rn(bt(this.db,"ads"),u)).id}catch(e){throw console.error("Error creating ad:",e),e}})}updateAd(a,r){return ue(this,null,function*(){try{let e=Le(this.db,"ads",a),t=Xe(Pe({},r),{updatedAt:rt.now()});r.mediaFile&&(t.mediaUrl=yield this.uploadFile(r.mediaFile,"ads/media"),delete t.mediaFile),r.thumbnailFile&&(t.thumbnailUrl=yield this.uploadFile(r.thumbnailFile,"ads/thumbnails"),delete t.thumbnailFile),r.aspectRatio&&(t.resolution=this.getResolutionFromAspectRatio(r.aspectRatio)),yield Ke(e,t)}catch(e){throw console.error("Error updating ad:",e),e}})}deleteAd(a){return ue(this,null,function*(){try{let e=this.adsSubject.value.find(l=>l.id===a);e&&(e.mediaUrl&&(yield this.deleteFileFromUrl(e.mediaUrl)),e.thumbnailUrl&&e.thumbnailUrl!==e.mediaUrl&&(yield this.deleteFileFromUrl(e.thumbnailUrl)));let t=Le(this.db,"ads",a);yield nn(t)}catch(r){throw console.error("Error deleting ad:",r),r}})}updateAdStatus(a,r){return ue(this,null,function*(){try{let e=Le(this.db,"ads",a);yield Ke(e,{status:r,updatedAt:rt.now()})}catch(e){throw console.error("Error updating ad status:",e),e}})}incrementViews(a){return ue(this,null,function*(){try{let e=this.adsSubject.value.find(t=>t.id===a);if(e){let t=Le(this.db,"ads",a);yield Ke(t,{views:(e.views||0)+1})}}catch(r){throw console.error("Error incrementing views:",r),r}})}incrementClicks(a){return ue(this,null,function*(){try{let e=this.adsSubject.value.find(t=>t.id===a);if(e){let t=(e.clicks||0)+1,l=e.impressions||1,u=t/l*100,g=Le(this.db,"ads",a);yield Ke(g,{clicks:t,ctr:parseFloat(u.toFixed(2))})}}catch(r){throw console.error("Error incrementing clicks:",r),r}})}compressFile(a){return ue(this,null,function*(){let r=a.type;if(r.startsWith("image/"))try{console.log("Compressing image:",a.name,"Original size:",(a.size/1024/1024).toFixed(2),"MB");let t=yield ie(a,{maxSizeMB:2,maxWidthOrHeight:1920,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8});if(console.log("Image compressed:",t.name,"New size:",(t.size/1024/1024).toFixed(2),"MB","Reduction:",((1-t.size/a.size)*100).toFixed(1)+"%"),a.type==="image/jpeg"||a.type==="image/jpg")return new File([t],a.name,{type:t.type});let l=a.name.replace(/\.[^/.]+$/,".jpg");return new File([t],l,{type:"image/jpeg"})}catch(e){return console.error("Image compression failed, using original file:",e),a}if(r.startsWith("video/")){let e=a.size/1024/1024;return console.log("Video file size:",e.toFixed(2),"MB"),e>50&&console.warn("Video file is large (>50MB). Consider compressing it externally for better performance."),a}return a})}uploadFile(a,r){return ue(this,null,function*(){try{let e=yield this.compressFile(a),l=`${new Date().getTime()}_${e.name}`,u=lt(this.storage,`${r}/${l}`),g={contentType:e.type,customMetadata:{uploadedAt:new Date().toISOString(),originalSize:a.size.toString(),compressedSize:e.size.toString()}};console.log("Uploading file:",l,"Type:",e.type,"Size:",(e.size/1024/1024).toFixed(2),"MB");let b=Fn(u,e,g);yield new Promise((c,i)=>{b.on("state_changed",f=>{let _=f.bytesTransferred/f.totalBytes*100;console.log(`Upload is ${_.toFixed(2)}% done`)},f=>{console.error("\u274C Upload task error:",f),i(f)},()=>{c()})});let o=yield On(u);return console.log("Download URL:",o),o}catch(e){console.error("Error uploading file:",e);let t="Failed to upload media file. Please try again.";throw e.code==="storage/unauthorized"?t="Upload failed: You do not have permission to upload files. Check Firebase Storage rules.":e.code==="storage/quota-exceeded"?t="Upload failed: Storage quota exceeded. Contact admin.":e.code==="storage/unknown"&&(t="Upload failed: Unknown storage error. Verify Firebase Storage is enabled and bucket configuration."),new Error(t)}})}deleteFileFromUrl(a){return ue(this,null,function*(){try{let r=decodeURIComponent(a),e=r.indexOf("/o/")+3,t=r.indexOf("?"),l=r.substring(e,t),u=lt(this.storage,l);yield Pn(u)}catch(r){console.error("Error deleting file:",r)}})}getResolutionFromAspectRatio(a){return{"16:9":"1920x1080","9:16":"1080x1920","1:1":"1080x1080","4:5":"1080x1350","4:3":"1024x768","21:9":"2560x1080"}[a]||"1920x1080"}getVideoDuration(a){return new Promise((r,e)=>{let t=document.createElement("video");t.preload="metadata",t.onloadedmetadata=()=>{window.URL.revokeObjectURL(t.src);let l=Math.floor(t.duration),u=Math.floor(l/60),g=l%60;r(`${u.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}`)},t.onerror=()=>{e(new Error("Failed to load video metadata"))},t.src=URL.createObjectURL(a)})}static{this.\u0275fac=function(r){return new(r||s)(Qt(on))}}static{this.\u0275prov=qt({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{Ts as a};

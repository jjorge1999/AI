import{a as h,d as l}from"./chunk-IO3I47CY.js";import{O as a,T as m,a as i,b as c,j as n}from"./chunk-K7VUYT6X.js";var j=(()=>{class s{constructor(e){this.http=e,this.apiUrl=l.apiUrl,this.customersSubject=new n([]),this.customers$=this.customersSubject.asObservable(),this.loadInitialData()}loadInitialData(){this.fetchCustomers()}getCurrentUser(){return localStorage.getItem("jjm_user_id")||"guest"}reloadData(){this.loadInitialData()}fetchCustomers(){let e=this.getCurrentUser();this.http.get(`${this.apiUrl}/customers?userId=${e}`).subscribe({next:t=>this.customersSubject.next(t),error:t=>console.error("Error fetching customers:",t)})}getCustomers(){return this.customers$}addCustomer(e){let t=c(i({},e),{userId:this.getCurrentUser()});this.http.post(`${this.apiUrl}/customers`,t).subscribe({next:r=>{let o=this.customersSubject.value;this.customersSubject.next([...o,r])},error:r=>console.error("Error adding customer:",r)})}updateCustomer(e,t){this.http.put(`${this.apiUrl}/customers/${e}`,t).subscribe({next:()=>{let o=this.customersSubject.value.map(u=>u.id===e?i(i({},u),t):u);this.customersSubject.next(o)},error:r=>console.error("Error updating customer:",r)})}deleteCustomer(e){this.http.delete(`${this.apiUrl}/customers/${e}`).subscribe({next:()=>{let r=this.customersSubject.value.filter(o=>o.id!==e);this.customersSubject.next(r)},error:t=>console.error("Error deleting customer:",t)})}getCustomerById(e){return this.customersSubject.value.find(t=>t.id===e)}static{this.\u0275fac=function(t){return new(t||s)(m(h))}}static{this.\u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{j as a};

import{A as zt,B as qt,C as Qt,D as ft,E as Ke,F as ht,G as Be,H as dt,I as jt,J as pt,M as Qe,N as $t,O as Wt,P as Gt,R as Vt,c as Ot,e as ut,f as Pt,g as Bt,h as Mt,o as Nt,u as Pe,v as Dt,y as Lt,z as Ht}from"./chunk-GUVN6CVQ.js";import{M as xt,R as Ft,g as Ct}from"./chunk-GVCJ4KOK.js";import{a as xe,b as qe,g as ue}from"./chunk-7QOE2ANW.js";var tn="firebasestorage.googleapis.com",nn="storageBucket",Bn=2*60*1e3,Mn=10*60*1e3;var Z=class n extends Nt{constructor(s,u,r=0){super(gt(s),`Firebase Storage: ${u} (${gt(s)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(s){this.status_=s}_codeEquals(s){return gt(s)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(s){this.customData.serverResponse=s,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},J=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(J||{});function gt(n){return"storage/"+n}function yt(){let n="An unknown error occurred, please check the error payload for server response.";return new Z(J.UNKNOWN,n)}function Nn(n){return new Z(J.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Dn(n){return new Z(J.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Ln(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Z(J.UNAUTHENTICATED,n)}function Hn(){return new Z(J.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function zn(n){return new Z(J.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function qn(){return new Z(J.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Qn(){return new Z(J.CANCELED,"User canceled the upload/download.")}function jn(n){return new Z(J.INVALID_URL,"Invalid URL '"+n+"'.")}function $n(n){return new Z(J.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Wn(){return new Z(J.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+nn+"' property when initializing the app?")}function Gn(){return new Z(J.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Vn(){return new Z(J.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Xn(n){return new Z(J.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function mt(n){return new Z(J.INVALID_ARGUMENT,n)}function rn(){return new Z(J.APP_DELETED,"The Firebase app was deleted.")}function Kn(n){return new Z(J.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $e(n,s){return new Z(J.INVALID_FORMAT,"String does not match format '"+n+"': "+s)}function je(n){throw new Z(J.INTERNAL_ERROR,"Internal error: "+n)}var me=class n{constructor(s,u){this.bucket=s,this.path_=u}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let s=encodeURIComponent;return"/b/"+s(this.bucket)+"/o/"+s(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(s,u){let r;try{r=n.makeFromUrl(s,u)}catch{return new n(s,"")}if(r.path==="")return r;throw $n(s)}static makeFromUrl(s,u){let r=null,e="([A-Za-z0-9.\\-_]+)";function t(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}let a="(/(.*))?$",c=new RegExp("^gs://"+e+a,"i"),m={bucket:1,path:3};function b(k){k.path_=decodeURIComponent(k.path)}let o="v[A-Za-z0-9_]+",l=u.replace(/[.]/g,"\\."),i="(/([^?#]*).*)?$",f=new RegExp(`^https?://${l}/${o}/b/${e}/o${i}`,"i"),_={bucket:1,path:3},U=u===tn?"(?:storage.googleapis.com|storage.cloud.google.com)":u,S="([^?#]*)",w=new RegExp(`^https?://${U}/${e}/${S}`,"i"),x=[{regex:c,indices:m,postModify:t},{regex:f,indices:_,postModify:b},{regex:w,indices:{bucket:1,path:2},postModify:b}];for(let k=0;k<x.length;k++){let B=x[k],A=B.regex.exec(s);if(A){let O=A[B.indices.bucket],d=A[B.indices.path];d||(d=""),r=new n(O,d),B.postModify(r);break}}if(r==null)throw jn(s);return r}},_t=class{constructor(s){this.promise_=Promise.reject(s)}getPromise(){return this.promise_}cancel(s=!1){}};function Zn(n,s,u){let r=1,e=null,t=null,a=!1,c=0;function m(){return c===2}let b=!1;function o(...S){b||(b=!0,s.apply(null,S))}function l(S){e=setTimeout(()=>{e=null,n(f,m())},S)}function i(){t&&clearTimeout(t)}function f(S,...w){if(b){i();return}if(S){i(),o.call(null,S,...w);return}if(m()||a){i(),o.call(null,S,...w);return}r<64&&(r*=2);let x;c===1?(c=2,x=0):x=(r+Math.random())*1e3,l(x)}let _=!1;function U(S){_||(_=!0,i(),!b&&(e!==null?(S||(c=2),clearTimeout(e),l(0)):S||(c=1)))}return l(0),t=setTimeout(()=>{a=!0,U(!0)},u),U}function Yn(n){n(!1)}function Jn(n){return n!==void 0}function er(n){return typeof n=="object"&&!Array.isArray(n)}function vt(n){return typeof n=="string"||n instanceof String}function Xt(n){return Et()&&n instanceof Blob}function Et(){return typeof Blob<"u"}function Kt(n,s,u,r){if(r<s)throw mt(`Invalid value for '${n}'. Expected ${s} or greater.`);if(r>u)throw mt(`Invalid value for '${n}'. Expected ${u} or less.`)}function et(n,s,u){let r=s;return u==null&&(r=`https://${s}`),`${u}://${r}/v0${n}`}function sn(n){let s=encodeURIComponent,u="?";for(let r in n)if(n.hasOwnProperty(r)){let e=s(r)+"="+s(n[r]);u=u+e+"&"}return u=u.slice(0,-1),u}var Ne=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Ne||{});function tr(n,s){let u=n>=500&&n<600,e=[408,429].indexOf(n)!==-1,t=s.indexOf(n)!==-1;return u||e||t}var At=class{constructor(s,u,r,e,t,a,c,m,b,o,l,i=!0,f=!1){this.url_=s,this.method_=u,this.headers_=r,this.body_=e,this.successCodes_=t,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=m,this.timeout_=b,this.progressCallback_=o,this.connectionFactory_=l,this.retry=i,this.isUsingEmulator=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,U)=>{this.resolve_=_,this.reject_=U,this.start_()})}start_(){let s=(r,e)=>{if(e){r(!1,new Me(!1,null,!0));return}let t=this.connectionFactory_();this.pendingConnection_=t;let a=c=>{let m=c.loaded,b=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,b)};this.progressCallback_!==null&&t.addUploadProgressListener(a),t.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&t.removeUploadProgressListener(a),this.pendingConnection_=null;let c=t.getErrorCode()===Ne.NO_ERROR,m=t.getStatus();if(!c||tr(m,this.additionalRetryCodes_)&&this.retry){let o=t.getErrorCode()===Ne.ABORT;r(!1,new Me(!1,null,o));return}let b=this.successCodes_.indexOf(m)!==-1;r(!0,new Me(b,t))})},u=(r,e)=>{let t=this.resolve_,a=this.reject_,c=e.connection;if(e.wasSuccessCode)try{let m=this.callback_(c,c.getResponse());Jn(m)?t(m):t()}catch(m){a(m)}else if(c!==null){let m=yt();m.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,m)):a(m)}else if(e.canceled){let m=this.appDelete_?rn():Qn();a(m)}else{let m=qn();a(m)}};this.canceled_?u(!1,new Me(!1,null,!0)):this.backoffId_=Zn(s,u,this.timeout_)}getPromise(){return this.promise_}cancel(s){this.canceled_=!0,this.appDelete_=s||!1,this.backoffId_!==null&&Yn(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Me=class{constructor(s,u,r){this.wasSuccessCode=s,this.connection=u,this.canceled=!!r}};function nr(n,s){s!==null&&s.length>0&&(n.Authorization="Firebase "+s)}function rr(n,s){n["X-Firebase-Storage-Version"]="webjs/"+(s??"AppManager")}function sr(n,s){s&&(n["X-Firebase-GMPID"]=s)}function ir(n,s){s!==null&&(n["X-Firebase-AppCheck"]=s)}function or(n,s,u,r,e,t,a=!0,c=!1){let m=sn(n.urlParams),b=n.url+m,o=Object.assign({},n.headers);return sr(o,s),nr(o,u),rr(o,t),ir(o,r),new At(b,n.method,o,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,e,a,c)}function ar(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function lr(...n){let s=ar();if(s!==void 0){let u=new s;for(let r=0;r<n.length;r++)u.append(n[r]);return u.getBlob()}else{if(Et())return new Blob(n);throw new Z(J.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function cr(n,s,u){return n.webkitSlice?n.webkitSlice(s,u):n.mozSlice?n.mozSlice(s,u):n.slice?n.slice(s,u):null}function ur(n){if(typeof atob>"u")throw Xn("base-64");return atob(n)}var we={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},We=class{constructor(s,u){this.data=s,this.contentType=u||null}};function fr(n,s){switch(n){case we.RAW:return new We(on(s));case we.BASE64:case we.BASE64URL:return new We(an(n,s));case we.DATA_URL:return new We(dr(s),pr(s))}throw yt()}function on(n){let s=[];for(let u=0;u<n.length;u++){let r=n.charCodeAt(u);if(r<=127)s.push(r);else if(r<=2047)s.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(u<n.length-1&&(n.charCodeAt(u+1)&64512)===56320))s.push(239,191,189);else{let t=r,a=n.charCodeAt(++u);r=65536|(t&1023)<<10|a&1023,s.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?s.push(239,191,189):s.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(s)}function hr(n){let s;try{s=decodeURIComponent(n)}catch{throw $e(we.DATA_URL,"Malformed data URL.")}return on(s)}function an(n,s){switch(n){case we.BASE64:{let e=s.indexOf("-")!==-1,t=s.indexOf("_")!==-1;if(e||t)throw $e(n,"Invalid character '"+(e?"-":"_")+"' found: is it base64url encoded?");break}case we.BASE64URL:{let e=s.indexOf("+")!==-1,t=s.indexOf("/")!==-1;if(e||t)throw $e(n,"Invalid character '"+(e?"+":"/")+"' found: is it base64 encoded?");s=s.replace(/-/g,"+").replace(/_/g,"/");break}}let u;try{u=ur(s)}catch(e){throw e.message.includes("polyfill")?e:$e(n,"Invalid character found")}let r=new Uint8Array(u.length);for(let e=0;e<u.length;e++)r[e]=u.charCodeAt(e);return r}var Ye=class{constructor(s){this.base64=!1,this.contentType=null;let u=s.match(/^data:([^,]+)?,/);if(u===null)throw $e(we.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=u[1]||null;r!=null&&(this.base64=gr(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=s.substring(s.indexOf(",")+1)}};function dr(n){let s=new Ye(n);return s.base64?an(we.BASE64,s.rest):hr(s.rest)}function pr(n){return new Ye(n).contentType}function gr(n,s){return n.length>=s.length?n.substring(n.length-s.length)===s:!1}var Je=class n{constructor(s,u){let r=0,e="";Xt(s)?(this.data_=s,r=s.size,e=s.type):s instanceof ArrayBuffer?(u?this.data_=new Uint8Array(s):(this.data_=new Uint8Array(s.byteLength),this.data_.set(new Uint8Array(s))),r=this.data_.length):s instanceof Uint8Array&&(u?this.data_=s:(this.data_=new Uint8Array(s.length),this.data_.set(s)),r=s.length),this.size_=r,this.type_=e}size(){return this.size_}type(){return this.type_}slice(s,u){if(Xt(this.data_)){let r=this.data_,e=cr(r,s,u);return e===null?null:new n(e)}else{let r=new Uint8Array(this.data_.buffer,s,u-s);return new n(r,!0)}}static getBlob(...s){if(Et()){let u=s.map(r=>r instanceof n?r.data_:r);return new n(lr.apply(null,u))}else{let u=s.map(a=>vt(a)?fr(we.RAW,a).data:a.data_),r=0;u.forEach(a=>{r+=a.byteLength});let e=new Uint8Array(r),t=0;return u.forEach(a=>{for(let c=0;c<a.length;c++)e[t++]=a[c]}),new n(e,!0)}}uploadData(){return this.data_}};function ln(n){let s;try{s=JSON.parse(n)}catch{return null}return er(s)?s:null}function mr(n){if(n.length===0)return null;let s=n.lastIndexOf("/");return s===-1?"":n.slice(0,s)}function _r(n,s){let u=s.split("/").filter(r=>r.length>0).join("/");return n.length===0?u:n+"/"+u}function cn(n){let s=n.lastIndexOf("/",n.length-2);return s===-1?n:n.slice(s+1)}function Ar(n,s){return s}var se=class{constructor(s,u,r,e){this.server=s,this.local=u||s,this.writable=!!r,this.xform=e||Ar}},Ze=null;function br(n){return!vt(n)||n.length<2?n:cn(n)}function un(){if(Ze)return Ze;let n=[];n.push(new se("bucket")),n.push(new se("generation")),n.push(new se("metageneration")),n.push(new se("name","fullPath",!0));function s(t,a){return br(a)}let u=new se("name");u.xform=s,n.push(u);function r(t,a){return a!==void 0?Number(a):a}let e=new se("size");return e.xform=r,n.push(e),n.push(new se("timeCreated")),n.push(new se("updated")),n.push(new se("md5Hash",null,!0)),n.push(new se("cacheControl",null,!0)),n.push(new se("contentDisposition",null,!0)),n.push(new se("contentEncoding",null,!0)),n.push(new se("contentLanguage",null,!0)),n.push(new se("contentType",null,!0)),n.push(new se("metadata","customMetadata",!0)),Ze=n,Ze}function wr(n,s){function u(){let r=n.bucket,e=n.fullPath,t=new me(r,e);return s._makeStorageReference(t)}Object.defineProperty(n,"ref",{get:u})}function yr(n,s,u){let r={};r.type="file";let e=u.length;for(let t=0;t<e;t++){let a=u[t];r[a.local]=a.xform(r,s[a.server])}return wr(r,n),r}function fn(n,s,u){let r=ln(s);return r===null?null:yr(n,r,u)}function vr(n,s,u,r){let e=ln(s);if(e===null||!vt(e.downloadTokens))return null;let t=e.downloadTokens;if(t.length===0)return null;let a=encodeURIComponent;return t.split(",").map(b=>{let o=n.bucket,l=n.fullPath,i="/b/"+a(o)+"/o/"+a(l),f=et(i,u,r),_=sn({alt:"media",token:b});return f+_})[0]}function Er(n,s){let u={},r=s.length;for(let e=0;e<r;e++){let t=s[e];t.writable&&(u[t.server]=n[t.local])}return JSON.stringify(u)}var Ge=class{constructor(s,u,r,e){this.url=s,this.method=u,this.handler=r,this.timeout=e,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function hn(n){if(!n)throw yt()}function Rr(n,s){function u(r,e){let t=fn(n,e,s);return hn(t!==null),t}return u}function Ur(n,s){function u(r,e){let t=fn(n,e,s);return hn(t!==null),vr(t,e,n.host,n._protocol)}return u}function dn(n){function s(u,r){let e;return u.getStatus()===401?u.getErrorText().includes("Firebase App Check token is invalid")?e=Hn():e=Ln():u.getStatus()===402?e=Dn(n.bucket):u.getStatus()===403?e=zn(n.path):e=r,e.status=u.getStatus(),e.serverResponse=r.serverResponse,e}return s}function pn(n){let s=dn(n);function u(r,e){let t=s(r,e);return r.getStatus()===404&&(t=Nn(n.path)),t.serverResponse=e.serverResponse,t}return u}function Tr(n,s,u){let r=s.fullServerUrl(),e=et(r,n.host,n._protocol),t="GET",a=n.maxOperationRetryTime,c=new Ge(e,t,Ur(n,u),a);return c.errorHandler=pn(s),c}function kr(n,s){let u=s.fullServerUrl(),r=et(u,n.host,n._protocol),e="DELETE",t=n.maxOperationRetryTime;function a(m,b){}let c=new Ge(r,e,a,t);return c.successCodes=[200,204],c.errorHandler=pn(s),c}function Sr(n,s){return n&&n.contentType||s&&s.type()||"application/octet-stream"}function Ir(n,s,u){let r=Object.assign({},u);return r.fullPath=n.path,r.size=s.size(),r.contentType||(r.contentType=Sr(null,s)),r}function Cr(n,s,u,r,e){let t=s.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let x="";for(let k=0;k<2;k++)x=x+Math.random().toString().slice(2);return x}let m=c();a["Content-Type"]="multipart/related; boundary="+m;let b=Ir(s,r,e),o=Er(b,u),l="--"+m+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+o+`\r
--`+m+`\r
Content-Type: `+b.contentType+`\r
\r
`,i=`\r
--`+m+"--",f=Je.getBlob(l,r,i);if(f===null)throw Gn();let _={name:b.fullPath},U=et(t,n.host,n._protocol),S="POST",w=n.maxUploadRetryTime,M=new Ge(U,S,Rr(n,u),w);return M.urlParams=_,M.headers=a,M.body=f.uploadData(),M.errorHandler=dn(s),M}var Jr=256*1024;var Zt=null,bt=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ne.NO_ERROR,this.sendPromise_=new Promise(s=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ne.ABORT,s()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ne.NETWORK_ERROR,s()}),this.xhr_.addEventListener("load",()=>{s()})})}send(s,u,r,e,t){if(this.sent_)throw je("cannot .send() more than once");if(ut(s)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(u,s,!0),t!==void 0)for(let a in t)t.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,t[a].toString());return e!==void 0?this.xhr_.send(e):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw je("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw je("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw je("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw je("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(s){return this.xhr_.getResponseHeader(s)}addUploadProgressListener(s){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",s)}removeUploadProgressListener(s){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",s)}},wt=class extends bt{initXhr(){this.xhr_.responseType="text"}};function Rt(){return Zt?Zt():new wt}var De=class n{constructor(s,u){this._service=s,u instanceof me?this._location=u:this._location=me.makeFromUrl(u,s.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(s,u){return new n(s,u)}get root(){let s=new me(this._location.bucket,"");return this._newRef(this._service,s)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cn(this._location.path)}get storage(){return this._service}get parent(){let s=mr(this._location.path);if(s===null)return null;let u=new me(this._location.bucket,s);return new n(this._service,u)}_throwIfRoot(s){if(this._location.path==="")throw Kn(s)}};function xr(n,s,u){n._throwIfRoot("uploadBytes");let r=Cr(n.storage,n._location,un(),new Je(s,!0),u);return n.storage.makeRequestWithTokens(r,Rt).then(e=>({metadata:e,ref:n}))}function Fr(n){n._throwIfRoot("getDownloadURL");let s=Tr(n.storage,n._location,un());return n.storage.makeRequestWithTokens(s,Rt).then(u=>{if(u===null)throw Vn();return u})}function Or(n){n._throwIfRoot("deleteObject");let s=kr(n.storage,n._location);return n.storage.makeRequestWithTokens(s,Rt)}function Pr(n,s){let u=_r(n._location.path,s),r=new me(n._location.bucket,u);return new De(n.storage,r)}function Br(n){return/^[A-Za-z]+:\/\//.test(n)}function Mr(n,s){return new De(n,s)}function gn(n,s){if(n instanceof Ve){let u=n;if(u._bucket==null)throw Wn();let r=new De(u,u._bucket);return s!=null?gn(r,s):r}else return s!==void 0?Pr(n,s):n}function Nr(n,s){if(s&&Br(s)){if(n instanceof Ve)return Mr(n,s);throw mt("To use ref(service, url), the first argument must be a Storage instance.")}else return gn(n,s)}function Yt(n,s){let u=s?.[nn];return u==null?null:me.makeFromBucketSpec(u,n)}function Dr(n,s,u,r={}){n.host=`${s}:${u}`;let e=ut(s);e&&(Pt(`https://${n.host}/b`),Mt("Storage",!0)),n._isUsingEmulator=!0,n._protocol=e?"https":"http";let{mockUserToken:t}=r;t&&(n._overrideAuthToken=typeof t=="string"?t:Bt(t,n.app.options.projectId))}var Ve=class{constructor(s,u,r,e,t,a=!1){this.app=s,this._authProvider=u,this._appCheckProvider=r,this._url=e,this._firebaseVersion=t,this._isUsingEmulator=a,this._bucket=null,this._host=tn,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Bn,this._maxUploadRetryTime=Mn,this._requests=new Set,e!=null?this._bucket=me.makeFromBucketSpec(e,this._host):this._bucket=Yt(this._host,this.app.options)}get host(){return this._host}set host(s){this._host=s,this._url!=null?this._bucket=me.makeFromBucketSpec(this._url,s):this._bucket=Yt(s,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(s){Kt("time",0,Number.POSITIVE_INFINITY,s),this._maxUploadRetryTime=s}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(s){Kt("time",0,Number.POSITIVE_INFINITY,s),this._maxOperationRetryTime=s}_getAuthToken(){return ue(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let s=this._authProvider.getImmediate({optional:!0});if(s){let u=yield s.getToken();if(u!==null)return u.accessToken}return null})}_getAppCheckToken(){return ue(this,null,function*(){if(zt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let s=this._appCheckProvider.getImmediate({optional:!0});return s?(yield s.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(s=>s.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(s){return new De(this,s)}_makeRequest(s,u,r,e,t=!0){if(this._deleted)return new _t(rn());{let a=or(s,this._appId,r,e,u,this._firebaseVersion,t,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(s,u){return ue(this,null,function*(){let[r,e]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(s,u,r,e).getPromise()})}},Jt="@firebase/storage",en="0.14.0";var mn="storage";function _n(n,s,u){return n=Pe(n),xr(n,s,u)}function An(n){return n=Pe(n),Fr(n)}function bn(n){return n=Pe(n),Or(n)}function tt(n,s){return n=Pe(n),Nr(n,s)}function wn(n=Qt(),s){n=Pe(n);let r=Ht(n,mn).getImmediate({identifier:s}),e=Ot("storage");return e&&Lr(r,...e),r}function Lr(n,s,u,r={}){Dr(n,s,u,r)}function Hr(n,{instanceIdentifier:s}){let u=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),e=n.getProvider("app-check-internal");return new Ve(u,r,e,s,qt)}function zr(){Lt(new Dt(mn,Hr,"PUBLIC").setMultipleInstances(!0)),ft(Jt,en,""),ft(Jt,en,"esm2020")}zr();function qr(n,s){return s.forEach(function(u){u&&typeof u!="string"&&!Array.isArray(u)&&Object.keys(u).forEach(function(r){if(r!=="default"&&!(r in n)){var e=Object.getOwnPropertyDescriptor(u,r);Object.defineProperty(n,r,e.get?e:{enumerable:!0,get:function(){return u[r]}})}})}),Object.freeze(n)}function vn(n,s){return new Promise(function(u,r){let e;return Qr(n).then(function(t){try{return e=t,u(new Blob([s.slice(0,2),e,s.slice(2)],{type:"image/jpeg"}))}catch(a){return r(a)}},r)})}var Qr=n=>new Promise((s,u)=>{let r=new FileReader;r.addEventListener("load",({target:{result:e}})=>{let t=new DataView(e),a=0;if(t.getUint16(a)!==65496)return u("not a valid JPEG");for(a+=2;;){let c=t.getUint16(a);if(c===65498)break;let m=t.getUint16(a+2);if(c===65505&&t.getUint32(a+4)===1165519206){let b=a+10,o;switch(t.getUint16(b)){case 18761:o=!0;break;case 19789:o=!1;break;default:return u("TIFF header contains invalid endian")}if(t.getUint16(b+2,o)!==42)return u("TIFF header contains invalid version");let l=t.getUint32(b+4,o),i=b+l+2+12*t.getUint16(b+l,o);for(let f=b+l+2;f<i;f+=12)if(t.getUint16(f,o)==274){if(t.getUint16(f+2,o)!==3)return u("Orientation data type is invalid");if(t.getUint32(f+4,o)!==1)return u("Orientation data count is invalid");t.setUint16(f+8,1,o);break}return s(e.slice(a,a+2+m))}a+=2+m}return s(new Blob)}),r.readAsArrayBuffer(n)}),rt={},jr={get exports(){return rt},set exports(n){rt=n}};(function(n){var s,u,r={};jr.exports=r,r.parse=function(e,t){for(var a=r.bin.readUshort,c=r.bin.readUint,m=0,b={},o=new Uint8Array(e),l=o.length-4;c(o,l)!=101010256;)l--;m=l,m+=4;var i=a(o,m+=4);a(o,m+=2);var f=c(o,m+=2),_=c(o,m+=4);m+=4,m=_;for(var U=0;U<i;U++){c(o,m),m+=4,m+=4,m+=4,c(o,m+=4),f=c(o,m+=4);var S=c(o,m+=4),w=a(o,m+=4),M=a(o,m+2),x=a(o,m+4);m+=6;var k=c(o,m+=8);m+=4,m+=w+M+x,r._readLocal(o,k,b,f,S,t)}return b},r._readLocal=function(e,t,a,c,m,b){var o=r.bin.readUshort,l=r.bin.readUint;l(e,t),o(e,t+=4),o(e,t+=2);var i=o(e,t+=2);l(e,t+=2),l(e,t+=4),t+=4;var f=o(e,t+=8),_=o(e,t+=2);t+=2;var U=r.bin.readUTF8(e,t,f);if(t+=f,t+=_,b)a[U]={size:m,csize:c};else{var S=new Uint8Array(e.buffer,t);if(i==0)a[U]=new Uint8Array(S.buffer.slice(t,t+c));else{if(i!=8)throw"unknown compression method: "+i;var w=new Uint8Array(m);r.inflateRaw(S,w),a[U]=w}}},r.inflateRaw=function(e,t){return r.F.inflate(e,t)},r.inflate=function(e,t){return e[0],e[1],r.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},r.deflate=function(e,t){t==null&&(t={level:6});var a=0,c=new Uint8Array(50+Math.floor(1.1*e.length));c[a]=120,c[a+1]=156,a+=2,a=r.F.deflateRaw(e,c,a,t.level);var m=r.adler(e,0,e.length);return c[a+0]=m>>>24&255,c[a+1]=m>>>16&255,c[a+2]=m>>>8&255,c[a+3]=m>>>0&255,new Uint8Array(c.buffer,0,a+4)},r.deflateRaw=function(e,t){t==null&&(t={level:6});var a=new Uint8Array(50+Math.floor(1.1*e.length)),c=r.F.deflateRaw(e,a,c,t.level);return new Uint8Array(a.buffer,0,c)},r.encode=function(e,t){t==null&&(t=!1);var a=0,c=r.bin.writeUint,m=r.bin.writeUshort,b={};for(var o in e){var l=!r._noNeed(o)&&!t,i=e[o],f=r.crc.crc(i,0,i.length);b[o]={cpr:l,usize:i.length,crc:f,file:l?r.deflateRaw(i):i}}for(var o in b)a+=b[o].file.length+30+46+2*r.bin.sizeUTF8(o);a+=22;var _=new Uint8Array(a),U=0,S=[];for(var o in b){var w=b[o];S.push(U),U=r._writeHeader(_,U,o,w,0)}var M=0,x=U;for(var o in b)w=b[o],S.push(U),U=r._writeHeader(_,U,o,w,1,S[M++]);var k=U-x;return c(_,U,101010256),U+=4,m(_,U+=4,M),m(_,U+=2,M),c(_,U+=2,k),c(_,U+=4,x),U+=4,U+=2,_.buffer},r._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},r._writeHeader=function(e,t,a,c,m,b){var o=r.bin.writeUint,l=r.bin.writeUshort,i=c.file;return o(e,t,m==0?67324752:33639248),t+=4,m==1&&(t+=2),l(e,t,20),l(e,t+=2,0),l(e,t+=2,c.cpr?8:0),o(e,t+=2,0),o(e,t+=4,c.crc),o(e,t+=4,i.length),o(e,t+=4,c.usize),l(e,t+=4,r.bin.sizeUTF8(a)),l(e,t+=2,0),t+=2,m==1&&(t+=2,t+=2,o(e,t+=6,b),t+=4),t+=r.bin.writeUTF8(e,t,a),m==0&&(e.set(i,t),t+=i.length),t},r.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var a=t,c=0;c<8;c++)1&a?a=3988292384^a>>>1:a>>>=1;e[t]=a}return e}(),update:function(e,t,a,c){for(var m=0;m<c;m++)e=r.crc.table[255&(e^t[a+m])]^e>>>8;return e},crc:function(e,t,a){return 4294967295^r.crc.update(4294967295,e,t,a)}},r.adler=function(e,t,a){for(var c=1,m=0,b=t,o=t+a;b<o;){for(var l=Math.min(b+5552,o);b<l;)m+=c+=e[b++];c%=65521,m%=65521}return m<<16|c},r.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,a){e[t]=255&a,e[t+1]=a>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,a){e[t]=255&a,e[t+1]=a>>8&255,e[t+2]=a>>16&255,e[t+3]=a>>24&255},readASCII:function(e,t,a){for(var c="",m=0;m<a;m++)c+=String.fromCharCode(e[t+m]);return c},writeASCII:function(e,t,a){for(var c=0;c<a.length;c++)e[t+c]=a.charCodeAt(c)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,a){for(var c,m="",b=0;b<a;b++)m+="%"+r.bin.pad(e[t+b].toString(16));try{c=decodeURIComponent(m)}catch{return r.bin.readASCII(e,t,a)}return c},writeUTF8:function(e,t,a){for(var c=a.length,m=0,b=0;b<c;b++){var o=a.charCodeAt(b);if(!(4294967168&o))e[t+m]=o,m++;else if(!(4294965248&o))e[t+m]=192|o>>6,e[t+m+1]=128|o>>0&63,m+=2;else if(!(4294901760&o))e[t+m]=224|o>>12,e[t+m+1]=128|o>>6&63,e[t+m+2]=128|o>>0&63,m+=3;else{if(4292870144&o)throw"e";e[t+m]=240|o>>18,e[t+m+1]=128|o>>12&63,e[t+m+2]=128|o>>6&63,e[t+m+3]=128|o>>0&63,m+=4}}return m},sizeUTF8:function(e){for(var t=e.length,a=0,c=0;c<t;c++){var m=e.charCodeAt(c);if(!(4294967168&m))a++;else if(!(4294965248&m))a+=2;else if(!(4294901760&m))a+=3;else{if(4292870144&m)throw"e";a+=4}}return a}},r.F={},r.F.deflateRaw=function(e,t,a,c){var m=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][c],b=r.F.U,o=r.F._goodIndex;r.F._hash;var l=r.F._putsE,i=0,f=a<<3,_=0,U=e.length;if(c==0){for(;i<U;)l(t,f,i+(R=Math.min(65535,U-i))==U?1:0),f=r.F._copyExact(e,i,R,t,f+8),i+=R;return f>>>3}var S=b.lits,w=b.strt,M=b.prev,x=0,k=0,B=0,A=0,O=0,d=0;for(U>2&&(w[d=r.F._hash(e,0)]=0),i=0;i<U;i++){if(O=d,i+1<U-2){d=r.F._hash(e,i+1);var p=i+1&32767;M[p]=w[d],w[d]=p}if(_<=i){(x>14e3||k>26697)&&U-i>100&&(_<i&&(S[x]=i-_,x+=2,_=i),f=r.F._writeBlock(i==U-1||_==U?1:0,S,x,A,e,B,i-B,t,f),x=k=A=0,B=i);var v=0;i<U-2&&(v=r.F._bestMatch(e,i,M,O,Math.min(m[2],U-i),m[3]));var R=v>>>16,E=65535&v;if(v!=0){E=65535&v;var T=o(R=v>>>16,b.of0);b.lhst[257+T]++;var y=o(E,b.df0);b.dhst[y]++,A+=b.exb[T]+b.dxb[y],S[x]=R<<23|i-_,S[x+1]=E<<16|T<<8|y,x+=2,_=i+R}else b.lhst[e[i]]++;k++}}for(B==i&&e.length!=0||(_<i&&(S[x]=i-_,x+=2,_=i),f=r.F._writeBlock(1,S,x,A,e,B,i-B,t,f),x=0,k=0,x=k=A=0,B=i);7&f;)f++;return f>>>3},r.F._bestMatch=function(e,t,a,c,m,b){var o=32767&t,l=a[o],i=o-l+32768&32767;if(l==o||c!=r.F._hash(e,t-i))return 0;for(var f=0,_=0,U=Math.min(32767,t);i<=U&&--b!=0&&l!=o;){if(f==0||e[t+f]==e[t+f-i]){var S=r.F._howLong(e,t,i);if(S>f){if(_=i,(f=S)>=m)break;i+2<S&&(S=i+2);for(var w=0,M=0;M<S-2;M++){var x=t-i+M+32768&32767,k=x-a[x]+32768&32767;k>w&&(w=k,l=x)}}}i+=(o=l)-(l=a[o])+32768&32767}return f<<16|_},r.F._howLong=function(e,t,a){if(e[t]!=e[t-a]||e[t+1]!=e[t+1-a]||e[t+2]!=e[t+2-a])return 0;var c=t,m=Math.min(e.length,t+258);for(t+=3;t<m&&e[t]==e[t-a];)t++;return t-c},r.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(e,t,a,c,m,b,o,l,i){var f,_,U,S,w,M,x,k,B,A=r.F.U,O=r.F._putsF,d=r.F._putsE;A.lhst[256]++,_=(f=r.F.getTrees())[0],U=f[1],S=f[2],w=f[3],M=f[4],x=f[5],k=f[6],B=f[7];var p=32+(i+3&7?8-(i+3&7):0)+(o<<3),v=c+r.F.contSize(A.fltree,A.lhst)+r.F.contSize(A.fdtree,A.dhst),R=c+r.F.contSize(A.ltree,A.lhst)+r.F.contSize(A.dtree,A.dhst);R+=14+3*x+r.F.contSize(A.itree,A.ihst)+(2*A.ihst[16]+3*A.ihst[17]+7*A.ihst[18]);for(var E=0;E<286;E++)A.lhst[E]=0;for(E=0;E<30;E++)A.dhst[E]=0;for(E=0;E<19;E++)A.ihst[E]=0;var T=p<v&&p<R?0:v<R?1:2;if(O(l,i,e),O(l,i+1,T),i+=3,T==0){for(;7&i;)i++;i=r.F._copyExact(m,b,o,l,i)}else{var y,I;if(T==1&&(y=A.fltree,I=A.fdtree),T==2){r.F.makeCodes(A.ltree,_),r.F.revCodes(A.ltree,_),r.F.makeCodes(A.dtree,U),r.F.revCodes(A.dtree,U),r.F.makeCodes(A.itree,S),r.F.revCodes(A.itree,S),y=A.ltree,I=A.dtree,d(l,i,w-257),d(l,i+=5,M-1),d(l,i+=5,x-4),i+=4;for(var g=0;g<x;g++)d(l,i+3*g,A.itree[1+(A.ordr[g]<<1)]);i+=3*x,i=r.F._codeTiny(k,A.itree,l,i),i=r.F._codeTiny(B,A.itree,l,i)}for(var h=b,N=0;N<a;N+=2){for(var C=t[N],P=C>>>23,z=h+(8388607&C);h<z;)i=r.F._writeLit(m[h++],y,l,i);if(P!=0){var L=t[N+1],H=L>>16,D=L>>8&255,F=255&L;d(l,i=r.F._writeLit(257+D,y,l,i),P-A.of0[D]),i+=A.exb[D],O(l,i=r.F._writeLit(F,I,l,i),H-A.df0[F]),i+=A.dxb[F],h+=P}}i=r.F._writeLit(256,y,l,i)}return i},r.F._copyExact=function(e,t,a,c,m){var b=m>>>3;return c[b]=a,c[b+1]=a>>>8,c[b+2]=255-c[b],c[b+3]=255-c[b+1],b+=4,c.set(new Uint8Array(e.buffer,t,a),b),m+(a+4<<3)},r.F.getTrees=function(){for(var e=r.F.U,t=r.F._hufTree(e.lhst,e.ltree,15),a=r.F._hufTree(e.dhst,e.dtree,15),c=[],m=r.F._lenCodes(e.ltree,c),b=[],o=r.F._lenCodes(e.dtree,b),l=0;l<c.length;l+=2)e.ihst[c[l]]++;for(l=0;l<b.length;l+=2)e.ihst[b[l]]++;for(var i=r.F._hufTree(e.ihst,e.itree,7),f=19;f>4&&e.itree[1+(e.ordr[f-1]<<1)]==0;)f--;return[t,a,i,m,o,f,c,b]},r.F.getSecond=function(e){for(var t=[],a=0;a<e.length;a+=2)t.push(e[a+1]);return t},r.F.nonZero=function(e){for(var t="",a=0;a<e.length;a+=2)e[a+1]!=0&&(t+=(a>>1)+",");return t},r.F.contSize=function(e,t){for(var a=0,c=0;c<t.length;c++)a+=t[c]*e[1+(c<<1)];return a},r.F._codeTiny=function(e,t,a,c){for(var m=0;m<e.length;m+=2){var b=e[m],o=e[m+1];c=r.F._writeLit(b,t,a,c);var l=b==16?2:b==17?3:7;b>15&&(r.F._putsE(a,c,o,l),c+=l)}return c},r.F._lenCodes=function(e,t){for(var a=e.length;a!=2&&e[a-1]==0;)a-=2;for(var c=0;c<a;c+=2){var m=e[c+1],b=c+3<a?e[c+3]:-1,o=c+5<a?e[c+5]:-1,l=c==0?-1:e[c-1];if(m==0&&b==m&&o==m){for(var i=c+5;i+2<a&&e[i+2]==m;)i+=2;(f=Math.min(i+1-c>>>1,138))<11?t.push(17,f-3):t.push(18,f-11),c+=2*f-2}else if(m==l&&b==m&&o==m){for(i=c+5;i+2<a&&e[i+2]==m;)i+=2;var f=Math.min(i+1-c>>>1,6);t.push(16,f-3),c+=2*f-2}else t.push(m,0)}return a>>>1},r.F._hufTree=function(e,t,a){var c=[],m=e.length,b=t.length,o=0;for(o=0;o<b;o+=2)t[o]=0,t[o+1]=0;for(o=0;o<m;o++)e[o]!=0&&c.push({lit:o,f:e[o]});var l=c.length,i=c.slice(0);if(l==0)return 0;if(l==1){var f=c[0].lit;return i=f==0?1:0,t[1+(f<<1)]=1,t[1+(i<<1)]=1,1}c.sort(function(k,B){return k.f-B.f});var _=c[0],U=c[1],S=0,w=1,M=2;for(c[0]={lit:-1,f:_.f+U.f,l:_,r:U,d:0};w!=l-1;)_=S!=w&&(M==l||c[S].f<c[M].f)?c[S++]:c[M++],U=S!=w&&(M==l||c[S].f<c[M].f)?c[S++]:c[M++],c[w++]={lit:-1,f:_.f+U.f,l:_,r:U};var x=r.F.setDepth(c[w-1],0);for(x>a&&(r.F.restrictDepth(i,a,x),x=a),o=0;o<l;o++)t[1+(i[o].lit<<1)]=i[o].d;return x},r.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(r.F.setDepth(e.l,t+1),r.F.setDepth(e.r,t+1))},r.F.restrictDepth=function(e,t,a){var c=0,m=1<<a-t,b=0;for(e.sort(function(l,i){return i.d==l.d?l.f-i.f:i.d-l.d}),c=0;c<e.length&&e[c].d>t;c++){var o=e[c].d;e[c].d=t,b+=m-(1<<a-o)}for(b>>>=a-t;b>0;)(o=e[c].d)<t?(e[c].d++,b-=1<<t-o-1):c++;for(;c>=0;c--)e[c].d==t&&b<0&&(e[c].d--,b++);b!=0&&console.log("debt left")},r.F._goodIndex=function(e,t){var a=0;return t[16|a]<=e&&(a|=16),t[8|a]<=e&&(a|=8),t[4|a]<=e&&(a|=4),t[2|a]<=e&&(a|=2),t[1|a]<=e&&(a|=1),a},r.F._writeLit=function(e,t,a,c){return r.F._putsF(a,c,t[e<<1]),c+t[1+(e<<1)]},r.F.inflate=function(e,t){var a=Uint8Array;if(e[0]==3&&e[1]==0)return t||new a(0);var c=r.F,m=c._bitsF,b=c._bitsE,o=c._decodeTiny,l=c.makeCodes,i=c.codes2map,f=c._get17,_=c.U,U=t==null;U&&(t=new a(e.length>>>2<<3));for(var S,w,M=0,x=0,k=0,B=0,A=0,O=0,d=0,p=0,v=0;M==0;)if(M=m(e,v,1),x=m(e,v+1,2),v+=3,x!=0){if(U&&(t=r.F._check(t,p+(1<<17))),x==1&&(S=_.flmap,w=_.fdmap,O=511,d=31),x==2){k=b(e,v,5)+257,B=b(e,v+5,5)+1,A=b(e,v+10,4)+4,v+=14;for(var R=0;R<38;R+=2)_.itree[R]=0,_.itree[R+1]=0;var E=1;for(R=0;R<A;R++){var T=b(e,v+3*R,3);_.itree[1+(_.ordr[R]<<1)]=T,T>E&&(E=T)}v+=3*A,l(_.itree,E),i(_.itree,E,_.imap),S=_.lmap,w=_.dmap,v=o(_.imap,(1<<E)-1,k+B,e,v,_.ttree);var y=c._copyOut(_.ttree,0,k,_.ltree);O=(1<<y)-1;var I=c._copyOut(_.ttree,k,B,_.dtree);d=(1<<I)-1,l(_.ltree,y),i(_.ltree,y,S),l(_.dtree,I),i(_.dtree,I,w)}for(;;){var g=S[f(e,v)&O];v+=15&g;var h=g>>>4;if(!(h>>>8))t[p++]=h;else{if(h==256)break;var N=p+h-254;if(h>264){var C=_.ldef[h-257];N=p+(C>>>3)+b(e,v,7&C),v+=7&C}var P=w[f(e,v)&d];v+=15&P;var z=P>>>4,L=_.ddef[z],H=(L>>>4)+m(e,v,15&L);for(v+=15&L,U&&(t=r.F._check(t,p+(1<<17)));p<N;)t[p]=t[p++-H],t[p]=t[p++-H],t[p]=t[p++-H],t[p]=t[p++-H];p=N}}}else{7&v&&(v+=8-(7&v));var D=4+(v>>>3),F=e[D-4]|e[D-3]<<8;U&&(t=r.F._check(t,p+F)),t.set(new a(e.buffer,e.byteOffset+D,F),p),v=D+F<<3,p+=F}return t.length==p?t:t.slice(0,p)},r.F._check=function(e,t){var a=e.length;if(t<=a)return e;var c=new Uint8Array(Math.max(a<<1,t));return c.set(e,0),c},r.F._decodeTiny=function(e,t,a,c,m,b){for(var o=r.F._bitsE,l=r.F._get17,i=0;i<a;){var f=e[l(c,m)&t];m+=15&f;var _=f>>>4;if(_<=15)b[i]=_,i++;else{var U=0,S=0;_==16?(S=3+o(c,m,2),m+=2,U=b[i-1]):_==17?(S=3+o(c,m,3),m+=3):_==18&&(S=11+o(c,m,7),m+=7);for(var w=i+S;i<w;)b[i]=U,i++}}return m},r.F._copyOut=function(e,t,a,c){for(var m=0,b=0,o=c.length>>>1;b<a;){var l=e[b+t];c[b<<1]=0,c[1+(b<<1)]=l,l>m&&(m=l),b++}for(;b<o;)c[b<<1]=0,c[1+(b<<1)]=0,b++;return m},r.F.makeCodes=function(e,t){for(var a,c,m,b,o=r.F.U,l=e.length,i=o.bl_count,f=0;f<=t;f++)i[f]=0;for(f=1;f<l;f+=2)i[e[f]]++;var _=o.next_code;for(a=0,i[0]=0,c=1;c<=t;c++)a=a+i[c-1]<<1,_[c]=a;for(m=0;m<l;m+=2)(b=e[m+1])!=0&&(e[m]=_[b],_[b]++)},r.F.codes2map=function(e,t,a){for(var c=e.length,m=r.F.U.rev15,b=0;b<c;b+=2)if(e[b+1]!=0)for(var o=b>>1,l=e[b+1],i=o<<4|l,f=t-l,_=e[b]<<f,U=_+(1<<f);_!=U;)a[m[_]>>>15-t]=i,_++},r.F.revCodes=function(e,t){for(var a=r.F.U.rev15,c=15-t,m=0;m<e.length;m+=2){var b=e[m]<<t-e[m+1];e[m]=a[b]>>>c}},r.F._putsE=function(e,t,a){a<<=7&t;var c=t>>>3;e[c]|=a,e[c+1]|=a>>>8},r.F._putsF=function(e,t,a){a<<=7&t;var c=t>>>3;e[c]|=a,e[c+1]|=a>>>8,e[c+2]|=a>>>16},r.F._bitsE=function(e,t,a){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<a)-1},r.F._bitsF=function(e,t,a){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<a)-1},r.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},r.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},r.F.U=(s=Uint16Array,u=Uint32Array,{next_code:new s(16),bl_count:new s(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new s(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new u(32),flmap:new s(512),fltree:[],fdmap:new s(32),fdtree:[],lmap:new s(32768),ltree:[],ttree:[],dmap:new s(32768),dtree:[],imap:new s(512),itree:[],rev15:new s(32768),lhst:new u(286),dhst:new u(30),ihst:new u(19),lits:new u(15e3),strt:new s(65536),prev:new s(32768)}),function(){for(var e=r.F.U,t=0;t<32768;t++){var a=t;a=(4278255360&(a=(4042322160&(a=(3435973836&(a=(2863311530&a)>>>1|(1431655765&a)<<1))>>>2|(858993459&a)<<2))>>>4|(252645135&a)<<4))>>>8|(16711935&a)<<8,e.rev15[t]=(a>>>16|a<<16)>>>17}function c(m,b,o){for(;b--!=0;)m.push(0,o)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];c(e.fltree,144,8),c(e.fltree,112,9),c(e.fltree,24,7),c(e.fltree,8,8),r.F.makeCodes(e.fltree,9),r.F.codes2map(e.fltree,9,e.flmap),r.F.revCodes(e.fltree,9),c(e.fdtree,32,5),r.F.makeCodes(e.fdtree,5),r.F.codes2map(e.fdtree,5,e.fdmap),r.F.revCodes(e.fdtree,5),c(e.itree,19,0),c(e.ltree,286,0),c(e.dtree,30,0),c(e.ttree,320,0)}()})();var $r=qr({__proto__:null,default:rt},[rt]),_e=function(){var n={nextZero(o,l){for(;o[l]!=0;)l++;return l},readUshort:(o,l)=>o[l]<<8|o[l+1],writeUshort(o,l,i){o[l]=i>>8&255,o[l+1]=255&i},readUint:(o,l)=>16777216*o[l]+(o[l+1]<<16|o[l+2]<<8|o[l+3]),writeUint(o,l,i){o[l]=i>>24&255,o[l+1]=i>>16&255,o[l+2]=i>>8&255,o[l+3]=255&i},readASCII(o,l,i){let f="";for(let _=0;_<i;_++)f+=String.fromCharCode(o[l+_]);return f},writeASCII(o,l,i){for(let f=0;f<i.length;f++)o[l+f]=i.charCodeAt(f)},readBytes(o,l,i){let f=[];for(let _=0;_<i;_++)f.push(o[l+_]);return f},pad:o=>o.length<2?`0${o}`:o,readUTF8(o,l,i){let f,_="";for(let U=0;U<i;U++)_+=`%${n.pad(o[l+U].toString(16))}`;try{f=decodeURIComponent(_)}catch{return n.readASCII(o,l,i)}return f}};function s(o,l,i,f){let _=l*i,U=t(f),S=Math.ceil(l*U/8),w=new Uint8Array(4*_),M=new Uint32Array(w.buffer),{ctype:x}=f,{depth:k}=f,B=n.readUshort;if(x==6){let C=_<<2;if(k==8)for(var A=0;A<C;A+=4)w[A]=o[A],w[A+1]=o[A+1],w[A+2]=o[A+2],w[A+3]=o[A+3];if(k==16)for(A=0;A<C;A++)w[A]=o[A<<1]}else if(x==2){let C=f.tabs.tRNS;if(C==null){if(k==8)for(A=0;A<_;A++){var O=3*A;M[A]=255<<24|o[O+2]<<16|o[O+1]<<8|o[O]}if(k==16)for(A=0;A<_;A++)O=6*A,M[A]=255<<24|o[O+4]<<16|o[O+2]<<8|o[O]}else{var d=C[0];let P=C[1],z=C[2];if(k==8)for(A=0;A<_;A++){var p=A<<2;O=3*A,M[A]=255<<24|o[O+2]<<16|o[O+1]<<8|o[O],o[O]==d&&o[O+1]==P&&o[O+2]==z&&(w[p+3]=0)}if(k==16)for(A=0;A<_;A++)p=A<<2,O=6*A,M[A]=255<<24|o[O+4]<<16|o[O+2]<<8|o[O],B(o,O)==d&&B(o,O+2)==P&&B(o,O+4)==z&&(w[p+3]=0)}}else if(x==3){let C=f.tabs.PLTE,P=f.tabs.tRNS,z=P?P.length:0;if(k==1)for(var v=0;v<i;v++){var R=v*S,E=v*l;for(A=0;A<l;A++){p=E+A<<2;var T=3*(y=o[R+(A>>3)]>>7-((7&A)<<0)&1);w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255}}if(k==2)for(v=0;v<i;v++)for(R=v*S,E=v*l,A=0;A<l;A++)p=E+A<<2,T=3*(y=o[R+(A>>2)]>>6-((3&A)<<1)&3),w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255;if(k==4)for(v=0;v<i;v++)for(R=v*S,E=v*l,A=0;A<l;A++)p=E+A<<2,T=3*(y=o[R+(A>>1)]>>4-((1&A)<<2)&15),w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255;if(k==8)for(A=0;A<_;A++){var y;p=A<<2,T=3*(y=o[A]),w[p]=C[T],w[p+1]=C[T+1],w[p+2]=C[T+2],w[p+3]=y<z?P[y]:255}}else if(x==4){if(k==8)for(A=0;A<_;A++){p=A<<2;var I=o[g=A<<1];w[p]=I,w[p+1]=I,w[p+2]=I,w[p+3]=o[g+1]}if(k==16)for(A=0;A<_;A++){var g;p=A<<2,I=o[g=A<<2],w[p]=I,w[p+1]=I,w[p+2]=I,w[p+3]=o[g+2]}}else if(x==0)for(d=f.tabs.tRNS?f.tabs.tRNS:-1,v=0;v<i;v++){let C=v*S,P=v*l;if(k==1)for(var h=0;h<l;h++){var N=(I=255*(o[C+(h>>>3)]>>>7-(7&h)&1))==255*d?0:255;M[P+h]=N<<24|I<<16|I<<8|I}else if(k==2)for(h=0;h<l;h++)N=(I=85*(o[C+(h>>>2)]>>>6-((3&h)<<1)&3))==85*d?0:255,M[P+h]=N<<24|I<<16|I<<8|I;else if(k==4)for(h=0;h<l;h++)N=(I=17*(o[C+(h>>>1)]>>>4-((1&h)<<2)&15))==17*d?0:255,M[P+h]=N<<24|I<<16|I<<8|I;else if(k==8)for(h=0;h<l;h++)N=(I=o[C+h])==d?0:255,M[P+h]=N<<24|I<<16|I<<8|I;else if(k==16)for(h=0;h<l;h++)I=o[C+(h<<1)],N=B(o,C+(h<<1))==d?0:255,M[P+h]=N<<24|I<<16|I<<8|I}return w}function u(o,l,i,f){let _=t(o),U=Math.ceil(i*_/8),S=new Uint8Array((U+1+o.interlace)*f);return l=o.tabs.CgBI?e(l,S):r(l,S),o.interlace==0?l=a(l,o,0,i,f):o.interlace==1&&(l=function(M,x){let k=x.width,B=x.height,A=t(x),O=A>>3,d=Math.ceil(k*A/8),p=new Uint8Array(B*d),v=0,R=[0,0,4,0,2,0,1],E=[0,4,0,2,0,1,0],T=[8,8,8,4,4,2,2],y=[8,8,4,4,2,2,1],I=0;for(;I<7;){let h=T[I],N=y[I],C=0,P=0,z=R[I];for(;z<B;)z+=h,P++;let L=E[I];for(;L<k;)L+=N,C++;let H=Math.ceil(C*A/8);a(M,x,v,C,P);let D=0,F=R[I];for(;F<B;){let q=E[I],V=v+D*H<<3;for(;q<k;){var g;if(A==1&&(g=(g=M[V>>3])>>7-(7&V)&1,p[F*d+(q>>3)]|=g<<7-((7&q)<<0)),A==2&&(g=(g=M[V>>3])>>6-(7&V)&3,p[F*d+(q>>2)]|=g<<6-((3&q)<<1)),A==4&&(g=(g=M[V>>3])>>4-(7&V)&15,p[F*d+(q>>1)]|=g<<4-((1&q)<<2)),A>=8){let j=F*d+q*O;for(let Q=0;Q<O;Q++)p[j+Q]=M[(V>>3)+Q]}V+=A,q+=N}D++,F+=h}C*P!=0&&(v+=P*(1+H)),I+=1}return p}(l,o)),l}function r(o,l){return e(new Uint8Array(o.buffer,2,o.length-6),l)}var e=function(){let o={H:{}};return o.H.N=function(l,i){let f=Uint8Array,_,U,S=0,w=0,M=0,x=0,k=0,B=0,A=0,O=0,d=0;if(l[0]==3&&l[1]==0)return i||new f(0);let p=o.H,v=p.b,R=p.e,E=p.R,T=p.n,y=p.A,I=p.Z,g=p.m,h=i==null;for(h&&(i=new f(l.length>>>2<<5));S==0;)if(S=v(l,d,1),w=v(l,d+1,2),d+=3,w!=0){if(h&&(i=o.H.W(i,O+(1<<17))),w==1&&(_=g.J,U=g.h,B=511,A=31),w==2){M=R(l,d,5)+257,x=R(l,d+5,5)+1,k=R(l,d+10,4)+4,d+=14;let C=1;for(var N=0;N<38;N+=2)g.Q[N]=0,g.Q[N+1]=0;for(N=0;N<k;N++){let L=R(l,d+3*N,3);g.Q[1+(g.X[N]<<1)]=L,L>C&&(C=L)}d+=3*k,T(g.Q,C),y(g.Q,C,g.u),_=g.w,U=g.d,d=E(g.u,(1<<C)-1,M+x,l,d,g.v);let P=p.V(g.v,0,M,g.C);B=(1<<P)-1;let z=p.V(g.v,M,x,g.D);A=(1<<z)-1,T(g.C,P),y(g.C,P,_),T(g.D,z),y(g.D,z,U)}for(;;){let C=_[I(l,d)&B];d+=15&C;let P=C>>>4;if(!(P>>>8))i[O++]=P;else{if(P==256)break;{let z=O+P-254;if(P>264){let q=g.q[P-257];z=O+(q>>>3)+R(l,d,7&q),d+=7&q}let L=U[I(l,d)&A];d+=15&L;let H=L>>>4,D=g.c[H],F=(D>>>4)+v(l,d,15&D);for(d+=15&D;O<z;)i[O]=i[O++-F],i[O]=i[O++-F],i[O]=i[O++-F],i[O]=i[O++-F];O=z}}}}else{7&d&&(d+=8-(7&d));let C=4+(d>>>3),P=l[C-4]|l[C-3]<<8;h&&(i=o.H.W(i,O+P)),i.set(new f(l.buffer,l.byteOffset+C,P),O),d=C+P<<3,O+=P}return i.length==O?i:i.slice(0,O)},o.H.W=function(l,i){let f=l.length;if(i<=f)return l;let _=new Uint8Array(f<<1);return _.set(l,0),_},o.H.R=function(l,i,f,_,U,S){let w=o.H.e,M=o.H.Z,x=0;for(;x<f;){let k=l[M(_,U)&i];U+=15&k;let B=k>>>4;if(B<=15)S[x]=B,x++;else{let A=0,O=0;B==16?(O=3+w(_,U,2),U+=2,A=S[x-1]):B==17?(O=3+w(_,U,3),U+=3):B==18&&(O=11+w(_,U,7),U+=7);let d=x+O;for(;x<d;)S[x]=A,x++}}return U},o.H.V=function(l,i,f,_){let U=0,S=0,w=_.length>>>1;for(;S<f;){let M=l[S+i];_[S<<1]=0,_[1+(S<<1)]=M,M>U&&(U=M),S++}for(;S<w;)_[S<<1]=0,_[1+(S<<1)]=0,S++;return U},o.H.n=function(l,i){let f=o.H.m,_=l.length,U,S,w,M,x=f.j;for(var k=0;k<=i;k++)x[k]=0;for(k=1;k<_;k+=2)x[l[k]]++;let B=f.K;for(U=0,x[0]=0,S=1;S<=i;S++)U=U+x[S-1]<<1,B[S]=U;for(w=0;w<_;w+=2)M=l[w+1],M!=0&&(l[w]=B[M],B[M]++)},o.H.A=function(l,i,f){let _=l.length,U=o.H.m.r;for(let S=0;S<_;S+=2)if(l[S+1]!=0){let w=S>>1,M=l[S+1],x=w<<4|M,k=i-M,B=l[S]<<k,A=B+(1<<k);for(;B!=A;)f[U[B]>>>15-i]=x,B++}},o.H.l=function(l,i){let f=o.H.m.r,_=15-i;for(let U=0;U<l.length;U+=2){let S=l[U]<<i-l[U+1];l[U]=f[S]>>>_}},o.H.M=function(l,i,f){f<<=7&i;let _=i>>>3;l[_]|=f,l[_+1]|=f>>>8},o.H.I=function(l,i,f){f<<=7&i;let _=i>>>3;l[_]|=f,l[_+1]|=f>>>8,l[_+2]|=f>>>16},o.H.e=function(l,i,f){return(l[i>>>3]|l[1+(i>>>3)]<<8)>>>(7&i)&(1<<f)-1},o.H.b=function(l,i,f){return(l[i>>>3]|l[1+(i>>>3)]<<8|l[2+(i>>>3)]<<16)>>>(7&i)&(1<<f)-1},o.H.Z=function(l,i){return(l[i>>>3]|l[1+(i>>>3)]<<8|l[2+(i>>>3)]<<16)>>>(7&i)},o.H.i=function(l,i){return(l[i>>>3]|l[1+(i>>>3)]<<8|l[2+(i>>>3)]<<16|l[3+(i>>>3)]<<24)>>>(7&i)},o.H.m=function(){let l=Uint16Array,i=Uint32Array;return{K:new l(16),j:new l(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new l(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new i(32),J:new l(512),_:[],h:new l(32),$:[],w:new l(32768),C:[],v:[],d:new l(32768),D:[],u:new l(512),Q:[],r:new l(32768),s:new i(286),Y:new i(30),a:new i(19),t:new i(15e3),k:new l(65536),g:new l(32768)}}(),function(){let l=o.H.m;for(var i=0;i<32768;i++){let _=i;_=(2863311530&_)>>>1|(1431655765&_)<<1,_=(3435973836&_)>>>2|(858993459&_)<<2,_=(4042322160&_)>>>4|(252645135&_)<<4,_=(4278255360&_)>>>8|(16711935&_)<<8,l.r[i]=(_>>>16|_<<16)>>>17}function f(_,U,S){for(;U--!=0;)_.push(0,S)}for(i=0;i<32;i++)l.q[i]=l.S[i]<<3|l.T[i],l.c[i]=l.p[i]<<4|l.z[i];f(l._,144,8),f(l._,112,9),f(l._,24,7),f(l._,8,8),o.H.n(l._,9),o.H.A(l._,9,l.J),o.H.l(l._,9),f(l.$,32,5),o.H.n(l.$,5),o.H.A(l.$,5,l.h),o.H.l(l.$,5),f(l.Q,19,0),f(l.C,286,0),f(l.D,30,0),f(l.v,320,0)}(),o.H.N}();function t(o){return[1,null,3,1,2,null,4][o.ctype]*o.depth}function a(o,l,i,f,_){let U=t(l),S=Math.ceil(f*U/8),w,M;U=Math.ceil(U/8);let x=o[i],k=0;if(x>1&&(o[i]=[0,0,1][x-2]),x==3)for(k=U;k<S;k++)o[k+1]=o[k+1]+(o[k+1-U]>>>1)&255;for(let B=0;B<_;B++)if(w=i+B*S,M=w+B+1,x=o[M-1],k=0,x==0)for(;k<S;k++)o[w+k]=o[M+k];else if(x==1){for(;k<U;k++)o[w+k]=o[M+k];for(;k<S;k++)o[w+k]=o[M+k]+o[w+k-U]}else if(x==2)for(;k<S;k++)o[w+k]=o[M+k]+o[w+k-S];else if(x==3){for(;k<U;k++)o[w+k]=o[M+k]+(o[w+k-S]>>>1);for(;k<S;k++)o[w+k]=o[M+k]+(o[w+k-S]+o[w+k-U]>>>1)}else{for(;k<U;k++)o[w+k]=o[M+k]+c(0,o[w+k-S],0);for(;k<S;k++)o[w+k]=o[M+k]+c(o[w+k-U],o[w+k-S],o[w+k-U-S])}return o}function c(o,l,i){let f=o+l-i,_=f-o,U=f-l,S=f-i;return _*_<=U*U&&_*_<=S*S?o:U*U<=S*S?l:i}function m(o,l,i){i.width=n.readUint(o,l),l+=4,i.height=n.readUint(o,l),l+=4,i.depth=o[l],l++,i.ctype=o[l],l++,i.compress=o[l],l++,i.filter=o[l],l++,i.interlace=o[l],l++}function b(o,l,i,f,_,U,S,w,M){let x=Math.min(l,_),k=Math.min(i,U),B=0,A=0;for(let I=0;I<k;I++)for(let g=0;g<x;g++)if(S>=0&&w>=0?(B=I*l+g<<2,A=(w+I)*_+S+g<<2):(B=(-w+I)*l-S+g<<2,A=I*_+g<<2),M==0)f[A]=o[B],f[A+1]=o[B+1],f[A+2]=o[B+2],f[A+3]=o[B+3];else if(M==1){var O=o[B+3]*.00392156862745098,d=o[B]*O,p=o[B+1]*O,v=o[B+2]*O,R=f[A+3]*(1/255),E=f[A]*R,T=f[A+1]*R,y=f[A+2]*R;let h=1-O,N=O+R*h,C=N==0?0:1/N;f[A+3]=255*N,f[A+0]=(d+E*h)*C,f[A+1]=(p+T*h)*C,f[A+2]=(v+y*h)*C}else if(M==2)O=o[B+3],d=o[B],p=o[B+1],v=o[B+2],R=f[A+3],E=f[A],T=f[A+1],y=f[A+2],O==R&&d==E&&p==T&&v==y?(f[A]=0,f[A+1]=0,f[A+2]=0,f[A+3]=0):(f[A]=d,f[A+1]=p,f[A+2]=v,f[A+3]=O);else if(M==3){if(O=o[B+3],d=o[B],p=o[B+1],v=o[B+2],R=f[A+3],E=f[A],T=f[A+1],y=f[A+2],O==R&&d==E&&p==T&&v==y)continue;if(O<220&&R>20)return!1}return!0}return{decode:function(l){let i=new Uint8Array(l),f=8,_=n,U=_.readUshort,S=_.readUint,w={tabs:{},frames:[]},M=new Uint8Array(i.length),x,k=0,B=0,A=[137,80,78,71,13,10,26,10];for(var O=0;O<8;O++)if(i[O]!=A[O])throw"The input is not a PNG file!";for(;f<i.length;){let I=_.readUint(i,f);f+=4;let g=_.readASCII(i,f,4);if(f+=4,g=="IHDR")m(i,f,w);else if(g=="iCCP"){for(var d=f;i[d]!=0;)d++;_.readASCII(i,f,d-f),i[d+1];let h=i.slice(d+2,f+I),N=null;try{N=r(h)}catch{N=e(h)}w.tabs[g]=N}else if(g=="CgBI")w.tabs[g]=i.slice(f,f+4);else if(g=="IDAT"){for(O=0;O<I;O++)M[k+O]=i[f+O];k+=I}else if(g=="acTL")w.tabs[g]={num_frames:S(i,f),num_plays:S(i,f+4)},x=new Uint8Array(i.length);else if(g=="fcTL"){B!=0&&((y=w.frames[w.frames.length-1]).data=u(w,x.slice(0,B),y.rect.width,y.rect.height),B=0);let h={x:S(i,f+12),y:S(i,f+16),width:S(i,f+4),height:S(i,f+8)},N=U(i,f+22);N=U(i,f+20)/(N==0?100:N);let C={rect:h,delay:Math.round(1e3*N),dispose:i[f+24],blend:i[f+25]};w.frames.push(C)}else if(g=="fdAT"){for(O=0;O<I-4;O++)x[B+O]=i[f+O+4];B+=I-4}else if(g=="pHYs")w.tabs[g]=[_.readUint(i,f),_.readUint(i,f+4),i[f+8]];else if(g=="cHRM")for(w.tabs[g]=[],O=0;O<8;O++)w.tabs[g].push(_.readUint(i,f+4*O));else if(g=="tEXt"||g=="zTXt"){w.tabs[g]==null&&(w.tabs[g]={});var p=_.nextZero(i,f),v=_.readASCII(i,f,p-f),R=f+I-p-1;if(g=="tEXt")T=_.readASCII(i,p+1,R);else{var E=r(i.slice(p+2,p+2+R));T=_.readUTF8(E,0,E.length)}w.tabs[g][v]=T}else if(g=="iTXt"){w.tabs[g]==null&&(w.tabs[g]={}),p=0,d=f,p=_.nextZero(i,d),v=_.readASCII(i,d,p-d);let h=i[d=p+1];var T;i[d+1],d+=2,p=_.nextZero(i,d),_.readASCII(i,d,p-d),d=p+1,p=_.nextZero(i,d),_.readUTF8(i,d,p-d),R=I-((d=p+1)-f),h==0?T=_.readUTF8(i,d,R):(E=r(i.slice(d,d+R)),T=_.readUTF8(E,0,E.length)),w.tabs[g][v]=T}else if(g=="PLTE")w.tabs[g]=_.readBytes(i,f,I);else if(g=="hIST"){let h=w.tabs.PLTE.length/3;for(w.tabs[g]=[],O=0;O<h;O++)w.tabs[g].push(U(i,f+2*O))}else if(g=="tRNS")w.ctype==3?w.tabs[g]=_.readBytes(i,f,I):w.ctype==0?w.tabs[g]=U(i,f):w.ctype==2&&(w.tabs[g]=[U(i,f),U(i,f+2),U(i,f+4)]);else if(g=="gAMA")w.tabs[g]=_.readUint(i,f)/1e5;else if(g=="sRGB")w.tabs[g]=i[f];else if(g=="bKGD")w.ctype==0||w.ctype==4?w.tabs[g]=[U(i,f)]:w.ctype==2||w.ctype==6?w.tabs[g]=[U(i,f),U(i,f+2),U(i,f+4)]:w.ctype==3&&(w.tabs[g]=i[f]);else if(g=="IEND")break;f+=I,_.readUint(i,f),f+=4}var y;return B!=0&&((y=w.frames[w.frames.length-1]).data=u(w,x.slice(0,B),y.rect.width,y.rect.height)),w.data=u(w,M,w.width,w.height),delete w.compress,delete w.interlace,delete w.filter,w},toRGBA8:function(l){let i=l.width,f=l.height;if(l.tabs.acTL==null)return[s(l.data,i,f,l).buffer];let _=[];l.frames[0].data==null&&(l.frames[0].data=l.data);let U=i*f*4,S=new Uint8Array(U),w=new Uint8Array(U),M=new Uint8Array(U);for(let k=0;k<l.frames.length;k++){let B=l.frames[k],A=B.rect.x,O=B.rect.y,d=B.rect.width,p=B.rect.height,v=s(B.data,d,p,l);if(k!=0)for(var x=0;x<U;x++)M[x]=S[x];if(B.blend==0?b(v,d,p,S,i,f,A,O,0):B.blend==1&&b(v,d,p,S,i,f,A,O,1),_.push(S.buffer.slice(0)),B.dispose!=0){if(B.dispose==1)b(w,d,p,S,i,f,A,O,0);else if(B.dispose==2)for(x=0;x<U;x++)S[x]=M[x]}}return _},_paeth:c,_copyTile:b,_bin:n}}();(function(){let{_copyTile:n}=_e,{_bin:s}=_e,u=_e._paeth;var r={table:function(){let d=new Uint32Array(256);for(let p=0;p<256;p++){let v=p;for(let R=0;R<8;R++)1&v?v=3988292384^v>>>1:v>>>=1;d[p]=v}return d}(),update(d,p,v,R){for(let E=0;E<R;E++)d=r.table[255&(d^p[v+E])]^d>>>8;return d},crc:(d,p,v)=>4294967295^r.update(4294967295,d,p,v)};function e(d,p,v,R){p[v]+=d[0]*R>>4,p[v+1]+=d[1]*R>>4,p[v+2]+=d[2]*R>>4,p[v+3]+=d[3]*R>>4}function t(d){return Math.max(0,Math.min(255,d))}function a(d,p){let v=d[0]-p[0],R=d[1]-p[1],E=d[2]-p[2],T=d[3]-p[3];return v*v+R*R+E*E+T*T}function c(d,p,v,R,E,T,y){y==null&&(y=1);let I=R.length,g=[];for(var h=0;h<I;h++){let F=R[h];g.push([F>>>0&255,F>>>8&255,F>>>16&255,F>>>24&255])}for(h=0;h<I;h++){let F=4294967295;for(var N=0,C=0;C<I;C++){var P=a(g[h],g[C]);C!=h&&P<F&&(F=P,N=C)}}let z=new Uint32Array(E.buffer),L=new Int16Array(p*v*4),H=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(h=0;h<H.length;h++)H[h]=255*((H[h]+.5)/16-.5);for(let F=0;F<v;F++)for(let q=0;q<p;q++){var D;h=4*(F*p+q),y!=2?D=[t(d[h]+L[h]),t(d[h+1]+L[h+1]),t(d[h+2]+L[h+2]),t(d[h+3]+L[h+3])]:(P=H[4*(3&F)+(3&q)],D=[t(d[h]+P),t(d[h+1]+P),t(d[h+2]+P),t(d[h+3]+P)]),N=0;let V=16777215;for(C=0;C<I;C++){let $=a(D,g[C]);$<V&&(V=$,N=C)}let j=g[N],Q=[D[0]-j[0],D[1]-j[1],D[2]-j[2],D[3]-j[3]];y==1&&(q!=p-1&&e(Q,L,h+4,7),F!=v-1&&(q!=0&&e(Q,L,h+4*p-4,3),e(Q,L,h+4*p,5),q!=p-1&&e(Q,L,h+4*p+4,1))),T[h>>2]=N,z[h>>2]=R[N]}}function m(d,p,v,R,E){E==null&&(E={});let{crc:T}=r,y=s.writeUint,I=s.writeUshort,g=s.writeASCII,h=8,N=d.frames.length>1,C,P=!1,z=33+(N?20:0);if(E.sRGB!=null&&(z+=13),E.pHYs!=null&&(z+=21),E.iCCP!=null&&(C=pako.deflate(E.iCCP),z+=21+C.length+4),d.ctype==3){for(var L=d.plte.length,H=0;H<L;H++)d.plte[H]>>>24!=255&&(P=!0);z+=8+3*L+4+(P?8+1*L+4:0)}for(var D=0;D<d.frames.length;D++)N&&(z+=38),z+=(j=d.frames[D]).cimg.length+12,D!=0&&(z+=4);z+=12;let F=new Uint8Array(z),q=[137,80,78,71,13,10,26,10];for(H=0;H<8;H++)F[H]=q[H];if(y(F,h,13),h+=4,g(F,h,"IHDR"),h+=4,y(F,h,p),h+=4,y(F,h,v),h+=4,F[h]=d.depth,h++,F[h]=d.ctype,h++,F[h]=0,h++,F[h]=0,h++,F[h]=0,h++,y(F,h,T(F,h-17,17)),h+=4,E.sRGB!=null&&(y(F,h,1),h+=4,g(F,h,"sRGB"),h+=4,F[h]=E.sRGB,h++,y(F,h,T(F,h-5,5)),h+=4),E.iCCP!=null){let Q=13+C.length;y(F,h,Q),h+=4,g(F,h,"iCCP"),h+=4,g(F,h,"ICC profile"),h+=11,h+=2,F.set(C,h),h+=C.length,y(F,h,T(F,h-(Q+4),Q+4)),h+=4}if(E.pHYs!=null&&(y(F,h,9),h+=4,g(F,h,"pHYs"),h+=4,y(F,h,E.pHYs[0]),h+=4,y(F,h,E.pHYs[1]),h+=4,F[h]=E.pHYs[2],h++,y(F,h,T(F,h-13,13)),h+=4),N&&(y(F,h,8),h+=4,g(F,h,"acTL"),h+=4,y(F,h,d.frames.length),h+=4,y(F,h,E.loop!=null?E.loop:0),h+=4,y(F,h,T(F,h-12,12)),h+=4),d.ctype==3){for(y(F,h,3*(L=d.plte.length)),h+=4,g(F,h,"PLTE"),h+=4,H=0;H<L;H++){let Q=3*H,$=d.plte[H],Y=255&$,ne=$>>>8&255,Te=$>>>16&255;F[h+Q+0]=Y,F[h+Q+1]=ne,F[h+Q+2]=Te}if(h+=3*L,y(F,h,T(F,h-3*L-4,3*L+4)),h+=4,P){for(y(F,h,L),h+=4,g(F,h,"tRNS"),h+=4,H=0;H<L;H++)F[h+H]=d.plte[H]>>>24&255;h+=L,y(F,h,T(F,h-L-4,L+4)),h+=4}}let V=0;for(D=0;D<d.frames.length;D++){var j=d.frames[D];N&&(y(F,h,26),h+=4,g(F,h,"fcTL"),h+=4,y(F,h,V++),h+=4,y(F,h,j.rect.width),h+=4,y(F,h,j.rect.height),h+=4,y(F,h,j.rect.x),h+=4,y(F,h,j.rect.y),h+=4,I(F,h,R[D]),h+=2,I(F,h,1e3),h+=2,F[h]=j.dispose,h++,F[h]=j.blend,h++,y(F,h,T(F,h-30,30)),h+=4);let Q=j.cimg;y(F,h,(L=Q.length)+(D==0?0:4)),h+=4;let $=h;g(F,h,D==0?"IDAT":"fdAT"),h+=4,D!=0&&(y(F,h,V++),h+=4),F.set(Q,h),h+=L,y(F,h,T(F,$,h-$)),h+=4}return y(F,h,0),h+=4,g(F,h,"IEND"),h+=4,y(F,h,T(F,h-4,4)),h+=4,F.buffer}function b(d,p,v){for(let R=0;R<d.frames.length;R++){let E=d.frames[R];E.rect.width;let T=E.rect.height,y=new Uint8Array(T*E.bpl+T);E.cimg=f(E.img,T,E.bpp,E.bpl,y,p,v)}}function o(d,p,v,R,E){let T=E[0],y=E[1],I=E[2],g=E[3],h=E[4],N=E[5],C=6,P=8,z=255;for(var L=0;L<d.length;L++){let oe=new Uint8Array(d[L]);for(var H=oe.length,D=0;D<H;D+=4)z&=oe[D+3]}let F=z!=255,q=function(X,W,re,le,ee,he){let te=[];for(var G=0;G<X.length;G++){let ce=new Uint8Array(X[G]),ge=new Uint32Array(ce.buffer);var de;let pe=0,ve=0,be=W,Se=re,lt=le?1:0;if(G!=0){let On=he||le||G==1||te[G-2].dispose!=0?1:2,ct=0,St=1e9;for(let He=0;He<On;He++){var Ee=new Uint8Array(X[G-1-He]);let Pn=new Uint32Array(X[G-1-He]),Re=W,Ue=re,Oe=-1,ze=-1;for(let Ie=0;Ie<re;Ie++)for(let Ce=0;Ce<W;Ce++)ge[ae=Ie*W+Ce]!=Pn[ae]&&(Ce<Re&&(Re=Ce),Ce>Oe&&(Oe=Ce),Ie<Ue&&(Ue=Ie),Ie>ze&&(ze=Ie));Oe==-1&&(Re=Ue=Oe=ze=0),ee&&((1&Re)==1&&Re--,(1&Ue)==1&&Ue--);let It=(Oe-Re+1)*(ze-Ue+1);It<St&&(St=It,ct=He,pe=Re,ve=Ue,be=Oe-Re+1,Se=ze-Ue+1)}Ee=new Uint8Array(X[G-1-ct]),ct==1&&(te[G-1].dispose=2),de=new Uint8Array(be*Se*4),n(Ee,W,re,de,be,Se,-pe,-ve,0),lt=n(ce,W,re,de,be,Se,-pe,-ve,3)?1:0,lt==1?i(ce,W,re,de,{x:pe,y:ve,width:be,height:Se}):n(ce,W,re,de,be,Se,-pe,-ve,0)}else de=ce.slice(0);te.push({rect:{x:pe,y:ve,width:be,height:Se},img:de,blend:lt,dispose:0})}if(le)for(G=0;G<te.length;G++){if((ke=te[G]).blend==1)continue;let ce=ke.rect,ge=te[G-1].rect,pe=Math.min(ce.x,ge.x),ve=Math.min(ce.y,ge.y),be={x:pe,y:ve,width:Math.max(ce.x+ce.width,ge.x+ge.width)-pe,height:Math.max(ce.y+ce.height,ge.y+ge.height)-ve};te[G-1].dispose=1,G-1!=0&&l(X,W,re,te,G-1,be,ee),l(X,W,re,te,G,be,ee)}let Xe=0;if(X.length!=1)for(var ae=0;ae<te.length;ae++){var ke;Xe+=(ke=te[ae]).rect.width*ke.rect.height}return te}(d,p,v,T,y,I),V={},j=[],Q=[];if(R!=0){let oe=[];for(D=0;D<q.length;D++)oe.push(q[D].img.buffer);let X=function(ee){let he=0;for(var te=0;te<ee.length;te++)he+=ee[te].byteLength;let G=new Uint8Array(he),de=0;for(te=0;te<ee.length;te++){let Ee=new Uint8Array(ee[te]),Xe=Ee.length;for(let ae=0;ae<Xe;ae+=4){let ke=Ee[ae],ce=Ee[ae+1],ge=Ee[ae+2],pe=Ee[ae+3];pe==0&&(ke=ce=ge=0),G[de+ae]=ke,G[de+ae+1]=ce,G[de+ae+2]=ge,G[de+ae+3]=pe}de+=Xe}return G.buffer}(oe),W=U(X,R);for(D=0;D<W.plte.length;D++)j.push(W.plte[D].est.rgba);let re=0;for(D=0;D<q.length;D++){let le=(Y=q[D]).img.length;var $=new Uint8Array(W.inds.buffer,re>>2,le>>2);Q.push($);let ee=new Uint8Array(W.abuf,re,le);N&&c(Y.img,Y.rect.width,Y.rect.height,j,ee,$),Y.img.set(ee),re+=le}}else for(L=0;L<q.length;L++){var Y=q[L];let oe=new Uint32Array(Y.img.buffer);var ne=Y.rect.width;for(H=oe.length,$=new Uint8Array(H),Q.push($),D=0;D<H;D++){let X=oe[D];if(D!=0&&X==oe[D-1])$[D]=$[D-1];else if(D>ne&&X==oe[D-ne])$[D]=$[D-ne];else{let W=V[X];if(W==null&&(V[X]=W=j.length,j.push(X),j.length>=300))break;$[D]=W}}}let Te=j.length;for(Te<=256&&h==0&&(P=Te<=2?1:Te<=4?2:Te<=16?4:8,P=Math.max(P,g)),L=0;L<q.length;L++){(Y=q[L]).rect.x,Y.rect.y,ne=Y.rect.width;let oe=Y.rect.height,X=Y.img;new Uint32Array(X.buffer);let W=4*ne,re=4;if(Te<=256&&h==0){W=Math.ceil(P*ne/8);var Ae=new Uint8Array(W*oe);let le=Q[L];for(let ee=0;ee<oe;ee++){D=ee*W;let he=ee*ne;if(P==8)for(var K=0;K<ne;K++)Ae[D+K]=le[he+K];else if(P==4)for(K=0;K<ne;K++)Ae[D+(K>>1)]|=le[he+K]<<4-4*(1&K);else if(P==2)for(K=0;K<ne;K++)Ae[D+(K>>2)]|=le[he+K]<<6-2*(3&K);else if(P==1)for(K=0;K<ne;K++)Ae[D+(K>>3)]|=le[he+K]<<7-1*(7&K)}X=Ae,C=3,re=1}else if(F==0&&q.length==1){Ae=new Uint8Array(ne*oe*3);let le=ne*oe;for(D=0;D<le;D++){let ee=3*D,he=4*D;Ae[ee]=X[he],Ae[ee+1]=X[he+1],Ae[ee+2]=X[he+2]}X=Ae,C=2,re=3,W=3*ne}Y.img=X,Y.bpl=W,Y.bpp=re}return{ctype:C,depth:P,plte:j,frames:q}}function l(d,p,v,R,E,T,y){let I=Uint8Array,g=Uint32Array,h=new I(d[E-1]),N=new g(d[E-1]),C=E+1<d.length?new I(d[E+1]):null,P=new I(d[E]),z=new g(P.buffer),L=p,H=v,D=-1,F=-1;for(let V=0;V<T.height;V++)for(let j=0;j<T.width;j++){let Q=T.x+j,$=T.y+V,Y=$*p+Q,ne=z[Y];ne==0||R[E-1].dispose==0&&N[Y]==ne&&(C==null||C[4*Y+3]!=0)||(Q<L&&(L=Q),Q>D&&(D=Q),$<H&&(H=$),$>F&&(F=$))}D==-1&&(L=H=D=F=0),y&&((1&L)==1&&L--,(1&H)==1&&H--),T={x:L,y:H,width:D-L+1,height:F-H+1};let q=R[E];q.rect=T,q.blend=1,q.img=new Uint8Array(T.width*T.height*4),R[E-1].dispose==0?(n(h,p,v,q.img,T.width,T.height,-T.x,-T.y,0),i(P,p,v,q.img,T)):n(P,p,v,q.img,T.width,T.height,-T.x,-T.y,0)}function i(d,p,v,R,E){n(d,p,v,R,E.width,E.height,-E.x,-E.y,2)}function f(d,p,v,R,E,T,y){let I=[],g,h=[0,1,2,3,4];T!=-1?h=[T]:(p*R>5e5||v==1)&&(h=[0]),y&&(g={level:0});let N=$r;for(var C=0;C<h.length;C++){for(let L=0;L<p;L++)_(E,d,L,R,v,h[C]);I.push(N.deflate(E,g))}let P,z=1e9;for(C=0;C<I.length;C++)I[C].length<z&&(P=C,z=I[C].length);return I[P]}function _(d,p,v,R,E,T){let y=v*R,I=y+v;if(d[I]=T,I++,T==0)if(R<500)for(var g=0;g<R;g++)d[I+g]=p[y+g];else d.set(new Uint8Array(p.buffer,y,R),I);else if(T==1){for(g=0;g<E;g++)d[I+g]=p[y+g];for(g=E;g<R;g++)d[I+g]=p[y+g]-p[y+g-E]+256&255}else if(v==0){for(g=0;g<E;g++)d[I+g]=p[y+g];if(T==2)for(g=E;g<R;g++)d[I+g]=p[y+g];if(T==3)for(g=E;g<R;g++)d[I+g]=p[y+g]-(p[y+g-E]>>1)+256&255;if(T==4)for(g=E;g<R;g++)d[I+g]=p[y+g]-u(p[y+g-E],0,0)+256&255}else{if(T==2)for(g=0;g<R;g++)d[I+g]=p[y+g]+256-p[y+g-R]&255;if(T==3){for(g=0;g<E;g++)d[I+g]=p[y+g]+256-(p[y+g-R]>>1)&255;for(g=E;g<R;g++)d[I+g]=p[y+g]+256-(p[y+g-R]+p[y+g-E]>>1)&255}if(T==4){for(g=0;g<E;g++)d[I+g]=p[y+g]+256-u(0,p[y+g-R],0)&255;for(g=E;g<R;g++)d[I+g]=p[y+g]+256-u(p[y+g-E],p[y+g-R],p[y+g-E-R])&255}}}function U(d,p){let v=new Uint8Array(d),R=v.slice(0),E=new Uint32Array(R.buffer),T=S(R,p),y=T[0],I=T[1],g=v.length,h=new Uint8Array(g>>2),N;if(v.length<2e7)for(var C=0;C<g;C+=4)N=w(y,P=v[C]*(1/255),z=v[C+1]*(1/255),L=v[C+2]*(1/255),H=v[C+3]*(1/255)),h[C>>2]=N.ind,E[C>>2]=N.est.rgba;else for(C=0;C<g;C+=4){var P=v[C]*.00392156862745098,z=v[C+1]*(1/255),L=v[C+2]*(1/255),H=v[C+3]*(1/255);for(N=y;N.left;)N=M(N.est,P,z,L,H)<=0?N.left:N.right;h[C>>2]=N.ind,E[C>>2]=N.est.rgba}return{abuf:R.buffer,inds:h,plte:I}}function S(d,p,v){v==null&&(v=1e-4);let R=new Uint32Array(d.buffer),E={i0:0,i1:d.length,bst:null,est:null,tdst:0,left:null,right:null};E.bst=B(d,E.i0,E.i1),E.est=A(E.bst);let T=[E];for(;T.length<p;){let I=0,g=0;for(var y=0;y<T.length;y++)T[y].est.L>I&&(I=T[y].est.L,g=y);if(I<v)break;let h=T[g],N=x(d,R,h.i0,h.i1,h.est.e,h.est.eMq255);if(h.i0>=N||h.i1<=N){h.est.L=0;continue}let C={i0:h.i0,i1:N,bst:null,est:null,tdst:0,left:null,right:null};C.bst=B(d,C.i0,C.i1),C.est=A(C.bst);let P={i0:N,i1:h.i1,bst:null,est:null,tdst:0,left:null,right:null};for(P.bst={R:[],m:[],N:h.bst.N-C.bst.N},y=0;y<16;y++)P.bst.R[y]=h.bst.R[y]-C.bst.R[y];for(y=0;y<4;y++)P.bst.m[y]=h.bst.m[y]-C.bst.m[y];P.est=A(P.bst),h.left=C,h.right=P,T[g]=C,T.push(P)}for(T.sort((I,g)=>g.bst.N-I.bst.N),y=0;y<T.length;y++)T[y].ind=y;return[E,T]}function w(d,p,v,R,E){if(d.left==null)return d.tdst=function(C,P,z,L,H){let D=P-C[0],F=z-C[1],q=L-C[2],V=H-C[3];return D*D+F*F+q*q+V*V}(d.est.q,p,v,R,E),d;let T=M(d.est,p,v,R,E),y=d.left,I=d.right;T>0&&(y=d.right,I=d.left);let g=w(y,p,v,R,E);if(g.tdst<=T*T)return g;let h=w(I,p,v,R,E);return h.tdst<g.tdst?h:g}function M(d,p,v,R,E){let{e:T}=d;return T[0]*p+T[1]*v+T[2]*R+T[3]*E-d.eMq}function x(d,p,v,R,E,T){for(R-=4;v<R;){for(;k(d,v,E)<=T;)v+=4;for(;k(d,R,E)>T;)R-=4;if(v>=R)break;let y=p[v>>2];p[v>>2]=p[R>>2],p[R>>2]=y,v+=4,R-=4}for(;k(d,v,E)>T;)v-=4;return v+4}function k(d,p,v){return d[p]*v[0]+d[p+1]*v[1]+d[p+2]*v[2]+d[p+3]*v[3]}function B(d,p,v){let R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],E=[0,0,0,0],T=v-p>>2;for(let y=p;y<v;y+=4){let I=d[y]*.00392156862745098,g=d[y+1]*(1/255),h=d[y+2]*(1/255),N=d[y+3]*(1/255);E[0]+=I,E[1]+=g,E[2]+=h,E[3]+=N,R[0]+=I*I,R[1]+=I*g,R[2]+=I*h,R[3]+=I*N,R[5]+=g*g,R[6]+=g*h,R[7]+=g*N,R[10]+=h*h,R[11]+=h*N,R[15]+=N*N}return R[4]=R[1],R[8]=R[2],R[9]=R[6],R[12]=R[3],R[13]=R[7],R[14]=R[11],{R,m:E,N:T}}function A(d){let{R:p}=d,{m:v}=d,{N:R}=d,E=v[0],T=v[1],y=v[2],I=v[3],g=R==0?0:1/R,h=[p[0]-E*E*g,p[1]-E*T*g,p[2]-E*y*g,p[3]-E*I*g,p[4]-T*E*g,p[5]-T*T*g,p[6]-T*y*g,p[7]-T*I*g,p[8]-y*E*g,p[9]-y*T*g,p[10]-y*y*g,p[11]-y*I*g,p[12]-I*E*g,p[13]-I*T*g,p[14]-I*y*g,p[15]-I*I*g],N=h,C=O,P=[Math.random(),Math.random(),Math.random(),Math.random()],z=0,L=0;if(R!=0)for(let D=0;D<16&&(P=C.multVec(N,P),L=Math.sqrt(C.dot(P,P)),P=C.sml(1/L,P),!(D!=0&&Math.abs(L-z)<1e-9));D++)z=L;let H=[E*g,T*g,y*g,I*g];return{Cov:h,q:H,e:P,L:z,eMq255:C.dot(C.sml(255,H),P),eMq:C.dot(P,H),rgba:(Math.round(255*H[3])<<24|Math.round(255*H[2])<<16|Math.round(255*H[1])<<8|Math.round(255*H[0])<<0)>>>0}}var O={multVec:(d,p)=>[d[0]*p[0]+d[1]*p[1]+d[2]*p[2]+d[3]*p[3],d[4]*p[0]+d[5]*p[1]+d[6]*p[2]+d[7]*p[3],d[8]*p[0]+d[9]*p[1]+d[10]*p[2]+d[11]*p[3],d[12]*p[0]+d[13]*p[1]+d[14]*p[2]+d[15]*p[3]],dot:(d,p)=>d[0]*p[0]+d[1]*p[1]+d[2]*p[2]+d[3]*p[3],sml:(d,p)=>[d*p[0],d*p[1],d*p[2],d*p[3]]};_e.encode=function(p,v,R,E,T,y,I){E==null&&(E=0),I==null&&(I=!1);let g=o(p,v,R,E,[!1,!1,!1,0,I,!1]);return b(g,-1),m(g,v,R,T,y)},_e.encodeLL=function(p,v,R,E,T,y,I,g){let h={ctype:0+(E==1?0:2)+(T==0?0:4),depth:y,frames:[]},N=(E+T)*y,C=N*v;for(let P=0;P<p.length;P++)h.frames.push({rect:{x:0,y:0,width:v,height:R},img:new Uint8Array(p[P]),blend:0,dispose:1,bpp:Math.ceil(N/8),bpl:Math.ceil(C/8)});return b(h,0,!0),m(h,v,R,I,g)},_e.encode.compress=o,_e.encode.dither=c,_e.quantize=U,_e.quantize.getKDtree=S,_e.quantize.getNearest=w})();var En={toArrayBuffer(n,s){let u=n.width,r=n.height,e=u<<2,t=n.getContext("2d").getImageData(0,0,u,r),a=new Uint32Array(t.data.buffer),c=(32*u+31)/32<<2,m=c*r,b=122+m,o=new ArrayBuffer(b),l=new DataView(o),i=1<<20,f,_,U,S,w=i,M=0,x=0,k=0;function B(d){l.setUint16(x,d,!0),x+=2}function A(d){l.setUint32(x,d,!0),x+=4}function O(d){x+=d}B(19778),A(b),O(4),A(122),A(108),A(u),A(-r>>>0),B(1),B(32),A(3),A(m),A(2835),A(2835),O(8),A(16711680),A(65280),A(255),A(4278190080),A(1466527264),function d(){for(;M<r&&w>0;){for(S=122+M*c,f=0;f<e;)w--,_=a[k++],U=_>>>24,l.setUint32(S+f,_<<8|U),f+=4;M++}k<a.length?(w=i,setTimeout(d,En._dly)):s(o)}()},toBlob(n,s){this.toArrayBuffer(n,u=>{s(new Blob([u],{type:"image/bmp"}))})},_dly:9},fe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},Wr={[fe.CHROME]:16384,[fe.FIREFOX]:11180,[fe.DESKTOP_SAFARI]:16384,[fe.IE]:8192,[fe.IOS]:4096,[fe.ETC]:8192},Tt=typeof window<"u",Rn=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,st=Tt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),Gr=(Tt||Rn)&&(st&&st.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Un=(Tt||Rn)&&(st&&st.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function kt(n,s,u=Date.now()){return new Promise(r=>{let e=n.split(","),t=e[0].match(/:(.*?);/)[1],a=globalThis.atob(e[1]),c=a.length,m=new Uint8Array(c);for(;c--;)m[c]=a.charCodeAt(c);let b=new Blob([m],{type:t});b.name=s,b.lastModified=u,r(b)})}function Tn(n){return new Promise((s,u)=>{let r=new Un;r.onload=()=>s(r.result),r.onerror=e=>u(e),r.readAsDataURL(n)})}function kn(n){return new Promise((s,u)=>{let r=new Image;r.onload=()=>s(r),r.onerror=e=>u(e),r.src=n})}function Fe(){if(Fe.cachedResult!==void 0)return Fe.cachedResult;let n=fe.ETC,{userAgent:s}=navigator;return/Chrom(e|ium)/i.test(s)?n=fe.CHROME:/iP(ad|od|hone)/i.test(s)&&/WebKit/i.test(s)?n=fe.IOS:/Safari/i.test(s)?n=fe.DESKTOP_SAFARI:/Firefox/i.test(s)?n=fe.FIREFOX:(/MSIE/i.test(s)||document.documentMode)&&(n=fe.IE),Fe.cachedResult=n,Fe.cachedResult}function Sn(n,s){let u=Fe(),r=Wr[u],e=n,t=s,a=e*t,c=e>t?t/e:e/t;for(;a>r*r;){let m=(r+e)/2,b=(r+t)/2;m<b?(t=b,e=b*c):(t=m*c,e=m),a=e*t}return{width:e,height:t}}function at(n,s){let u,r;try{if(u=new OffscreenCanvas(n,s),r=u.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{u=document.createElement("canvas"),r=u.getContext("2d")}return u.width=n,u.height=s,[u,r]}function In(n,s){let{width:u,height:r}=Sn(n.width,n.height),[e,t]=at(u,r);return s&&/jpe?g/.test(s)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(n,0,0,e.width,e.height),e}function nt(){return nt.cachedResult!==void 0||(nt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),nt.cachedResult}function it(n,s={}){return new Promise(function(u,r){let e,t;var a=function(){try{return t=In(e,s.fileType||n.type),u([e,t])}catch(m){return r(m)}},c=function(m){try{var b=function(o){try{throw o}catch(l){return r(l)}};try{let o;return Tn(n).then(function(l){try{return o=l,kn(o).then(function(i){try{return e=i,function(){try{return a()}catch(f){return r(f)}}()}catch(f){return b(f)}},b)}catch(i){return b(i)}},b)}catch(o){b(o)}}catch(o){return r(o)}};try{if(nt()||[fe.DESKTOP_SAFARI,fe.MOBILE_SAFARI].includes(Fe()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(n).then(function(m){try{return e=m,a()}catch{return c()}},c)}catch{c()}})}function ot(n,s,u,r,e=1){return new Promise(function(t,a){let c;if(s==="image/png"){let l,i,f;return l=n.getContext("2d"),{data:i}=l.getImageData(0,0,n.width,n.height),f=_e.encode([i.buffer],n.width,n.height,4096*e),c=new Blob([f],{type:s}),c.name=u,c.lastModified=r,m.call(this)}{let l=function(){return m.call(this)};var b=l;if(s==="image/bmp")return new Promise(i=>En.toBlob(n,i)).then(function(i){try{return c=i,c.name=u,c.lastModified=r,l.call(this)}catch(f){return a(f)}}.bind(this),a);{let i=function(){return l.call(this)};var o=i;if(typeof OffscreenCanvas=="function"&&n instanceof OffscreenCanvas)return n.convertToBlob({type:s,quality:e}).then(function(f){try{return c=f,c.name=u,c.lastModified=r,i.call(this)}catch(_){return a(_)}}.bind(this),a);{let f;return f=n.toDataURL(s,e),kt(f,u,r).then(function(_){try{return c=_,i.call(this)}catch(U){return a(U)}}.bind(this),a)}}}function m(){return t(c)}})}function ye(n){n.width=0,n.height=0}function Le(){return new Promise(function(n,s){let u,r,e,t,a;return Le.cachedResult!==void 0?n(Le.cachedResult):(u="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==",kt("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(c){try{return r=c,it(r).then(function(m){try{return e=m[1],ot(e,r.type,r.name,r.lastModified).then(function(b){try{return t=b,ye(e),it(t).then(function(o){try{return a=o[0],Le.cachedResult=a.width===1&&a.height===2,n(Le.cachedResult)}catch(l){return s(l)}},s)}catch(o){return s(o)}},s)}catch(b){return s(b)}},s)}catch(m){return s(m)}},s))})}function Cn(n){return new Promise((s,u)=>{let r=new Un;r.onload=e=>{let t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return s(-2);let a=t.byteLength,c=2;for(;c<a;){if(t.getUint16(c+2,!1)<=8)return s(-1);let m=t.getUint16(c,!1);if(c+=2,m==65505){if(t.getUint32(c+=2,!1)!=1165519206)return s(-1);let b=t.getUint16(c+=6,!1)==18761;c+=t.getUint32(c+4,b);let o=t.getUint16(c,b);c+=2;for(let l=0;l<o;l++)if(t.getUint16(c+12*l,b)==274)return s(t.getUint16(c+12*l+8,b))}else{if((65280&m)!=65280)break;c+=t.getUint16(c,!1)}}return s(-1)},r.onerror=e=>u(e),r.readAsArrayBuffer(n)})}function xn(n,s){let{width:u}=n,{height:r}=n,{maxWidthOrHeight:e}=s,t,a=n;return isFinite(e)&&(u>e||r>e)&&([a,t]=at(u,r),u>r?(a.width=e,a.height=r/u*e):(a.width=u/r*e,a.height=e),t.drawImage(n,0,0,a.width,a.height),ye(n)),a}function Fn(n,s){let{width:u}=n,{height:r}=n,[e,t]=at(u,r);switch(s>4&&s<9?(e.width=r,e.height=u):(e.width=u,e.height=r),s){case 2:t.transform(-1,0,0,1,u,0);break;case 3:t.transform(-1,0,0,-1,u,r);break;case 4:t.transform(1,0,0,-1,0,r);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,r,0);break;case 7:t.transform(0,-1,-1,0,r,u);break;case 8:t.transform(0,-1,1,0,0,u)}return t.drawImage(n,0,0,u,r),ye(n),e}function yn(n,s,u=0){return new Promise(function(r,e){let t,a,c,m,b,o,l,i,f,_,U,S,w,M,x,k,B,A,O,d;function p(R=5){if(s.signal&&s.signal.aborted)throw s.signal.reason;t+=R,s.onProgress(Math.min(t,100))}function v(R){if(s.signal&&s.signal.aborted)throw s.signal.reason;t=Math.min(Math.max(R,t),100),s.onProgress(t)}return t=u,a=s.maxIteration||10,c=1024*s.maxSizeMB*1024,p(),it(n,s).then(function(R){try{return[,m]=R,p(),b=xn(m,s),p(),new Promise(function(E,T){var y;if(!(y=s.exifOrientation))return Cn(n).then(function(g){try{return y=g,I.call(this)}catch(h){return T(h)}}.bind(this),T);function I(){return E(y)}return I.call(this)}).then(function(E){try{return o=E,p(),Le().then(function(T){try{return l=T?b:Fn(b,o),p(),i=s.initialQuality||1,f=s.fileType||n.type,ot(l,f,n.name,n.lastModified,i).then(function(y){try{{let N=function(){if(a--&&(x>c||x>w)){let P,z;return P=d?.95*O.width:O.width,z=d?.95*O.height:O.height,[B,A]=at(P,z),A.drawImage(O,0,0,P,z),i*=f==="image/png"?.85:.95,ot(B,f,n.name,n.lastModified,i).then(function(L){try{return k=L,ye(O),O=B,x=k.size,v(Math.min(99,Math.floor((M-x)/(M-c)*100))),N}catch(H){return e(H)}},e)}return[1]},C=function(){return ye(O),ye(B),ye(b),ye(l),ye(m),v(100),r(k)};var g=N,h=C;if(_=y,p(),U=_.size>c,S=_.size>n.size,!U&&!S)return v(100),r(_);var I;return w=n.size,M=_.size,x=M,O=l,d=!s.alwaysKeepResolution&&U,(I=function(P){for(;P;){if(P.then)return void P.then(I,e);try{if(P.pop){if(P.length)return P.pop()?C.call(this):P;P=N}else P=P.call(this)}catch(z){return e(z)}}}.bind(this))(N)}}catch(N){return e(N)}}.bind(this),e)}catch(y){return e(y)}}.bind(this),e)}catch(T){return e(T)}}.bind(this),e)}catch(E){return e(E)}}.bind(this),e)})}var Vr=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`,Ut;function Xr(n,s){return new Promise((u,r)=>{Ut||(Ut=function(a){let c=[];return typeof a=="function"?c.push(`(${a})()`):c.push(a),URL.createObjectURL(new Blob(c))}(Vr));let e=new Worker(Ut);e.addEventListener("message",function(a){if(s.signal&&s.signal.aborted)e.terminate();else if(a.data.progress===void 0){if(a.data.error)return r(new Error(a.data.error)),void e.terminate();u(a.data.file),e.terminate()}else s.onProgress(a.data.progress)}),e.addEventListener("error",r),s.signal&&s.signal.addEventListener("abort",()=>{r(s.signal.reason),e.terminate()}),e.postMessage({file:n,imageCompressionLibUrl:s.libURL,options:qe(xe({},s),{onProgress:void 0,signal:void 0})})})}function ie(n,s){return new Promise(function(u,r){let e,t,a,c,m,b;if(e=xe({},s),a=0,{onProgress:c}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,m=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=f=>{a=f,typeof c=="function"&&c(a)},!(n instanceof Blob||n instanceof Gr))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(n.type))return r(new Error("The file given is not an image"));if(b=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!m||typeof Worker!="function"||b)return yn(n,e).then(function(f){try{return t=f,i.call(this)}catch(_){return r(_)}}.bind(this),r);var o=function(){try{return i.call(this)}catch(f){return r(f)}}.bind(this),l=function(f){try{return yn(n,e).then(function(_){try{return t=_,o()}catch(U){return r(U)}},r)}catch(_){return r(_)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Xr(n,e).then(function(f){try{return t=f,o()}catch{return l()}},l)}catch{l()}function i(){try{t.name=n.name,t.lastModified=n.lastModified}catch{}try{e.preserveExif&&n.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===n.type)&&(t=vn(n,t))}catch{}return u(t)}})}ie.getDataUrlFromFile=Tn,ie.getFilefromDataUrl=kt,ie.loadImage=kn,ie.drawImageInCanvas=In,ie.drawFileInCanvas=it,ie.canvasToFile=ot,ie.getExifOrientation=Cn,ie.handleMaxWidthOrHeight=xn,ie.followExifOrientation=Fn,ie.cleanupCanvasMemory=ye,ie.isAutoOrientationInBrowser=Le,ie.approximateBelowMaximumCanvasSizeOfBrowser=Sn,ie.copyExifWithoutOrientation=vn,ie.getBrowserName=Fe,ie.version="2.0.2";var hs=(()=>{class n{constructor(u){this.firebaseService=u,this.adsSubject=new Ct([]),this.ads$=this.adsSubject.asObservable(),this.unsubscribe=null,this.db=this.firebaseService.db,this.storage=wn(this.firebaseService.app),this.testStorageConnection()}testStorageConnection(){return ue(this,null,function*(){try{let u=tt(this.storage,"ads/");console.log("\u2705 Firebase Storage initialized successfully"),console.log("Storage bucket:",this.storage.app.options.storageBucket)}catch(u){console.error("\u274C Firebase Storage connection failed:",u),console.error("Please ensure Firebase Storage is enabled in your Firebase console")}})}startListening(u){let r=ht(this.db,"ads"),e=dt(r,pt("uploadDate","desc"));u&&(e=dt(r,jt("createdBy","==",u),pt("uploadDate","desc"))),this.unsubscribe=Gt(e,t=>{let a=t.docs.map(c=>{let m=c.data();return qe(xe({id:c.id},m),{uploadDate:m.uploadDate?.toDate()||new Date,updatedAt:m.updatedAt?.toDate()})});this.adsSubject.next(a)})}stopListening(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}getAds(){return this.ads$}createAd(u,r){return ue(this,null,function*(){try{let e="",t="";u.mediaFile&&(e=yield this.uploadFile(u.mediaFile,"ads/media")),u.thumbnailFile?t=yield this.uploadFile(u.thumbnailFile,"ads/thumbnails"):t=u.type==="image"?e:"";let a=this.getResolutionFromAspectRatio(u.aspectRatio),c={title:u.title,type:u.type,status:u.status||"draft",thumbnailUrl:t,mediaUrl:e,aspectRatio:u.aspectRatio,resolution:a,description:u.description||"",targetUrl:u.targetUrl||"",uploadDate:Ke.now(),createdBy:r,views:0,impressions:0,clicks:0,ctr:0};return(yield Wt(ht(this.db,"ads"),c)).id}catch(e){throw console.error("Error creating ad:",e),e}})}updateAd(u,r){return ue(this,null,function*(){try{let e=Be(this.db,"ads",u),t=qe(xe({},r),{updatedAt:Ke.now()});r.mediaFile&&(t.mediaUrl=yield this.uploadFile(r.mediaFile,"ads/media"),delete t.mediaFile),r.thumbnailFile&&(t.thumbnailUrl=yield this.uploadFile(r.thumbnailFile,"ads/thumbnails"),delete t.thumbnailFile),r.aspectRatio&&(t.resolution=this.getResolutionFromAspectRatio(r.aspectRatio)),yield Qe(e,t)}catch(e){throw console.error("Error updating ad:",e),e}})}deleteAd(u){return ue(this,null,function*(){try{let e=this.adsSubject.value.find(a=>a.id===u);e&&(e.mediaUrl&&(yield this.deleteFileFromUrl(e.mediaUrl)),e.thumbnailUrl&&e.thumbnailUrl!==e.mediaUrl&&(yield this.deleteFileFromUrl(e.thumbnailUrl)));let t=Be(this.db,"ads",u);yield $t(t)}catch(r){throw console.error("Error deleting ad:",r),r}})}updateAdStatus(u,r){return ue(this,null,function*(){try{let e=Be(this.db,"ads",u);yield Qe(e,{status:r,updatedAt:Ke.now()})}catch(e){throw console.error("Error updating ad status:",e),e}})}incrementViews(u){return ue(this,null,function*(){try{let e=this.adsSubject.value.find(t=>t.id===u);if(e){let t=Be(this.db,"ads",u);yield Qe(t,{views:(e.views||0)+1})}}catch(r){throw console.error("Error incrementing views:",r),r}})}incrementClicks(u){return ue(this,null,function*(){try{let e=this.adsSubject.value.find(t=>t.id===u);if(e){let t=(e.clicks||0)+1,a=e.impressions||1,c=t/a*100,m=Be(this.db,"ads",u);yield Qe(m,{clicks:t,ctr:parseFloat(c.toFixed(2))})}}catch(r){throw console.error("Error incrementing clicks:",r),r}})}compressFile(u){return ue(this,null,function*(){let r=u.type;if(r.startsWith("image/"))try{console.log("Compressing image:",u.name,"Original size:",(u.size/1024/1024).toFixed(2),"MB");let t=yield ie(u,{maxSizeMB:2,maxWidthOrHeight:1920,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8});if(console.log("Image compressed:",t.name,"New size:",(t.size/1024/1024).toFixed(2),"MB","Reduction:",((1-t.size/u.size)*100).toFixed(1)+"%"),u.type==="image/jpeg"||u.type==="image/jpg")return new File([t],u.name,{type:t.type});let a=u.name.replace(/\.[^/.]+$/,".jpg");return new File([t],a,{type:"image/jpeg"})}catch(e){return console.error("Image compression failed, using original file:",e),u}if(r.startsWith("video/")){let e=u.size/1024/1024;return console.log("Video file size:",e.toFixed(2),"MB"),e>50&&console.warn("Video file is large (>50MB). Consider compressing it externally for better performance."),u}return u})}uploadFile(u,r){return ue(this,null,function*(){try{let e=yield this.compressFile(u),a=`${new Date().getTime()}_${e.name}`,c=tt(this.storage,`${r}/${a}`),m={contentType:e.type,customMetadata:{uploadedAt:new Date().toISOString(),originalSize:u.size.toString(),compressedSize:e.size.toString()}};console.log("Uploading file:",a,"Type:",e.type,"Size:",(e.size/1024/1024).toFixed(2),"MB");let b=yield _n(c,e,m);console.log("Upload successful:",b.metadata.fullPath);let o=yield An(c);return console.log("Download URL:",o),o}catch(e){throw console.error("Error uploading file:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),e.code==="storage/unauthorized"?new Error("Upload failed: You do not have permission to upload files. Please check Firebase Storage rules."):e.code==="storage/canceled"?new Error("Upload was canceled."):e.code==="storage/unknown"?new Error("Upload failed: Please check if Firebase Storage is enabled in your Firebase project."):e}})}deleteFileFromUrl(u){return ue(this,null,function*(){try{let r=decodeURIComponent(u),e=r.indexOf("/o/")+3,t=r.indexOf("?"),a=r.substring(e,t),c=tt(this.storage,a);yield bn(c)}catch(r){console.error("Error deleting file:",r)}})}getResolutionFromAspectRatio(u){return{"16:9":"1920x1080","9:16":"1080x1920","1:1":"1080x1080","4:5":"1080x1350","4:3":"1024x768","21:9":"2560x1080"}[u]||"1920x1080"}getVideoDuration(u){return new Promise((r,e)=>{let t=document.createElement("video");t.preload="metadata",t.onloadedmetadata=()=>{window.URL.revokeObjectURL(t.src);let a=Math.floor(t.duration),c=Math.floor(a/60),m=a%60;r(`${c.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`)},t.onerror=()=>{e(new Error("Failed to load video metadata"))},t.src=URL.createObjectURL(u)})}static{this.\u0275fac=function(r){return new(r||n)(Ft(Vt))}}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{hs as a};

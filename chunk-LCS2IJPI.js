import{a as n,d as g}from"./chunk-BQ4N44S4.js";import{U as l,Z as c,o as i}from"./chunk-VTT5FMM4.js";var j=(()=>{class e{constructor(t){this.http=t,this.apiUrl=g.apiUrl,this.logsSubject=new i([]),this.logs$=this.logsSubject.asObservable()}getCurrentUserId(){return localStorage.getItem("jjm_user_id")||"guest"}fetchLogs(){let t=this.getCurrentUserId();!t||t==="guest"||this.http.get(`${this.apiUrl}/logs?limit=200&userId=${t}`).subscribe({next:r=>this.logsSubject.next(r),error:r=>console.error("Error fetching logs:",r)})}logActivity(t,r,a,u,h){let o={action:t,entityType:r,entityId:a,entityName:u,details:h,userId:this.getCurrentUserId()};console.log("Logging activity:",o),this.http.post(`${this.apiUrl}/logs`,o).subscribe({next:s=>{console.log("Activity logged successfully:",s);let p=this.logsSubject.value;this.logsSubject.next([s,...p])},error:s=>{console.error("Error logging activity:",s),console.error("Failed log data:",o)}})}getLogs(){return this.logs$}refreshLogs(){this.fetchLogs()}cleanupOldLogs(){return this.http.post(`${this.apiUrl}/cleanup-logs`,{})}static{this.\u0275fac=function(r){return new(r||e)(c(n))}}static{this.\u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{j as a};

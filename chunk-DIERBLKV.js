import{n as re}from"./chunk-VCVPJN2K.js";import{a as ae}from"./chunk-XLT3BDRA.js";import{a as J,b as K,e as X,g as Z,h as ee,i as te,j as ie,l as ne,n as oe}from"./chunk-IQNO2F6Q.js";import{Aa as a,Ba as L,Mb as Q,Nb as R,Pa as _,Pb as G,Qb as Y,Ra as s,Sa as $,Sb as H,Ta as k,Va as o,Wa as n,Xa as T,Ya as v,Za as u,_a as d,a as A,aa as q,b as W,cb as D,db as r,eb as f,f as U,fb as x,gb as z,ia as g,ib as S,ja as m,jb as I,kb as O,mb as j,nb as P,pb as y,rb as F,wa as V}from"./chunk-MNIEKAC2.js";function le(t,p){if(t&1&&(o(0,"div",32)(1,"div",33),r(2),n(),o(3,"div",34),T(4,"div",35),P(5,"number"),n(),o(6,"div",36),r(7),P(8,"number"),n()()),t&2){let e=p.$implicit,l=d();a(2),f(e.category),a(2),$("width",e.total/l.totalSalesValue*100,"%"),s("title","\u20B1"+y(5,6,e.total,"1.2-2")),a(3),z("\u20B1",y(8,9,e.total,"1.2-2")," (",e.count,")")}}function ce(t,p){t&1&&(o(0,"div",37),r(1," No sales data yet "),n())}function de(t,p){if(t&1&&(o(0,"div",50),T(1,"img",51),n()),t&2){let e=d().$implicit;a(),s("src",e.imageUrl,V)("alt",e.name)}}function se(t,p){t&1&&(o(0,"div",52)(1,"span",53),r(2,"\u{1F4E6}"),n()())}function pe(t,p){if(t&1){let e=v();o(0,"div",40),_(1,de,2,2,"div",41)(2,se,3,0,"div",42),o(3,"div",43)(4,"div",44),r(5),n(),o(6,"div",45),r(7),n()(),o(8,"div",46)(9,"div",47),r(10),P(11,"number"),n(),o(12,"div",48),r(13),n(),o(14,"button",49),u("click",function(){let i=g(e).$implicit,c=d(2);return m(c.openEditModal(i))}),r(15," \u270F\uFE0F Edit "),n()()()}if(t&2){let e=p.$implicit;a(),s("ngIf",e.imageUrl),a(),s("ngIf",!e.imageUrl),a(3),f(e.name),a(2),f(e.category),a(3),x("\u20B1",y(11,6,e.price,"1.2-2"),""),a(3),x("Stock: ",e.quantity,"")}}function ge(t,p){if(t&1&&(o(0,"div",38),_(1,pe,16,9,"div",39),n()),t&2){let e=d();a(),s("ngForOf",e.paginatedAvailableProducts)}}function me(t,p){if(t&1&&(o(0,"option",59),r(1),n()),t&2){let e=p.$implicit;s("value",e),a(),f(e)}}function _e(t,p){if(t&1){let e=v();o(0,"button",64),u("click",function(){let i=g(e).$implicit,c=d(3);return m(c.goToAvailablePage(i))}),r(1),n()}if(t&2){let e=p.$implicit,l=d(3);k("active",e===l.availableProductsPage),a(),x(" ",e," ")}}function ue(t,p){if(t&1){let e=v();o(0,"div",60)(1,"button",61),u("click",function(){g(e);let i=d(2);return m(i.prevAvailablePage())}),r(2," \u2190 Prev "),n(),o(3,"div",62),_(4,_e,2,3,"button",63),n(),o(5,"button",61),u("click",function(){g(e);let i=d(2);return m(i.nextAvailablePage())}),r(6," Next \u2192 "),n()()}if(t&2){let e=d(2);a(),s("disabled",e.availableProductsPage===1),a(3),s("ngForOf",e.getPageNumbers(e.availableProductsTotalPages)),a(),s("disabled",e.availableProductsPage===e.availableProductsTotalPages)}}function ve(t,p){if(t&1){let e=v();o(0,"div",54)(1,"div",55)(2,"label",56),r(3,"Show:"),n(),o(4,"select",57),O("ngModelChange",function(i){g(e);let c=d();return I(c.availableProductsPageSize,i)||(c.availableProductsPageSize=i),m(i)}),u("change",function(){g(e);let i=d();return m(i.onAvailablePageSizeChange())}),_(5,me,2,2,"option",28),n(),o(6,"span"),r(7,"per page"),n()(),_(8,ue,7,3,"div",58),n()}if(t&2){let e=d();a(4),S("ngModel",e.availableProductsPageSize),a(),s("ngForOf",e.pageSizeOptions),a(3),s("ngIf",e.availableProductsTotalPages>1)}}function fe(t,p){t&1&&(o(0,"div",65)(1,"p"),r(2,"No available products"),n()())}function xe(t,p){if(t&1&&(o(0,"span",80),r(1),n()),t&2){let e=d().$implicit;a(),x("(",e.quantityCount," items)")}}function Pe(t,p){if(t&1&&(o(0,"div",81),r(1),P(2,"number"),n()),t&2){let e=d().$implicit;a(),z(" ",e.items[0].quantitySold," \xD7 \u20B1",y(2,2,e.items[0].price,"1.2-2")," ")}}function ye(t,p){if(t&1&&(o(0,"div",83),r(1),n()),t&2){let e=p.$implicit;a(),z(" \u2022 ",e.productName," (x",e.quantitySold,") ")}}function Ce(t,p){if(t&1&&(o(0,"div",81),_(1,ye,2,2,"div",82),n()),t&2){let e=d().$implicit;a(),s("ngForOf",e.items)}}function he(t,p){if(t&1&&(o(0,"span"),r(1),P(2,"date"),n()),t&2){let e=d().$implicit;a(),x("(",y(2,1,e.deliveryDate,"shortDate"),")")}}function be(t,p){if(t&1&&(o(0,"div",70)(1,"div",71)(2,"div",72),r(3),_(4,xe,2,1,"span",73),n(),_(5,Pe,3,5,"div",74)(6,Ce,2,1,"div",74),o(7,"div",75),r(8," Pending Delivery "),_(9,he,3,4,"span",76),n()(),o(10,"div",77)(11,"div",78),r(12),P(13,"number"),n(),o(14,"div",79),r(15),P(16,"date"),n()()()),t&2){let e=p.$implicit;a(3),x(" ",e.productName," "),a(),s("ngIf",e.isGroup),a(),s("ngIf",!e.isGroup),a(),s("ngIf",e.isGroup),a(3),s("ngIf",e.deliveryDate),a(3),x("\u20B1",y(13,7,e.total,"1.2-2"),""),a(3),f(y(16,10,e.timestamp,"short"))}}function Se(t,p){if(t&1&&(o(0,"option",59),r(1),n()),t&2){let e=p.$implicit;s("value",e),a(),f(e)}}function Ie(t,p){if(t&1){let e=v();o(0,"button",64),u("click",function(){let i=g(e).$implicit,c=d(4);return m(c.goToPendingPage(i))}),r(1),n()}if(t&2){let e=p.$implicit,l=d(4);k("active",e===l.pendingPage),a(),x(" ",e," ")}}function Oe(t,p){if(t&1){let e=v();o(0,"div",60)(1,"button",61),u("click",function(){g(e);let i=d(3);return m(i.prevPendingPage())}),r(2," \u2190 Prev "),n(),o(3,"div",62),_(4,Ie,2,3,"button",63),n(),o(5,"button",61),u("click",function(){g(e);let i=d(3);return m(i.nextPendingPage())}),r(6," Next \u2192 "),n()()}if(t&2){let e=d(3);a(),s("disabled",e.pendingPage===1),a(3),s("ngForOf",e.getPageNumbers(e.pendingTotalPages)),a(),s("disabled",e.pendingPage===e.pendingTotalPages)}}function we(t,p){if(t&1){let e=v();o(0,"div",54)(1,"div",55)(2,"label",84),r(3,"Show:"),n(),o(4,"select",85),O("ngModelChange",function(i){g(e);let c=d(2);return I(c.pendingPageSize,i)||(c.pendingPageSize=i),m(i)}),u("change",function(){g(e);let i=d(2);return m(i.onPendingPageSizeChange())}),_(5,Se,2,2,"option",28),n(),o(6,"span"),r(7,"per page"),n()(),_(8,Oe,7,3,"div",58),n()}if(t&2){let e=d(2);a(4),S("ngModel",e.pendingPageSize),a(),s("ngForOf",e.pageSizeOptions),a(3),s("ngIf",e.pendingTotalPages>1)}}function Me(t,p){if(t&1&&(o(0,"div",66)(1,"h3")(2,"span",5),r(3,"\u{1F69A}"),n(),r(4," Pending Deliveries "),o(5,"span",67),r(6),n()(),o(7,"div",68),_(8,be,17,13,"div",69),n(),_(9,we,9,3,"div",22),n()),t&2){let e=d();a(6),f(e.pendingSales.length),a(2),s("ngForOf",e.paginatedPendingSales),a(),s("ngIf",e.pendingTotalPages>1||e.groupedPendingSales.length>10)}}function Ee(t,p){if(t&1&&(o(0,"option",59),r(1),n()),t&2){let e=p.$implicit;s("value",e),a(),f(e)}}function ke(t,p){if(t&1&&(o(0,"div",87),r(1),P(2,"date"),n()),t&2){let e=d().$implicit;a(),x(" \u{1F69A} ",y(2,1,e.deliveryDate,"MMM d, y")," ")}}function Te(t,p){if(t&1&&(o(0,"div",70)(1,"div",71)(2,"div",72),r(3),n(),o(4,"div",81),r(5),P(6,"number"),n(),_(7,ke,3,4,"div",86),n(),o(8,"div",77)(9,"div",78),r(10),P(11,"number"),n(),o(12,"div",79),r(13),P(14,"date"),n()()()),t&2){let e=p.$implicit;a(3),f(e.productName),a(2),z(" ",e.quantitySold," \xD7 \u20B1",y(6,6,e.price,"1.2-2")," "),a(2),s("ngIf",e.deliveryDate),a(3),x("\u20B1",y(11,9,e.total,"1.2-2"),""),a(3),f(y(14,12,e.timestamp,"short"))}}function ze(t,p){if(t&1&&(o(0,"div",68),_(1,Te,15,15,"div",69),n()),t&2){let e=d();a(),s("ngForOf",e.paginatedSales)}}function Ve(t,p){if(t&1&&(o(0,"option",59),r(1),n()),t&2){let e=p.$implicit;s("value",e),a(),f(e)}}function Le(t,p){if(t&1){let e=v();o(0,"button",64),u("click",function(){let i=g(e).$implicit,c=d(3);return m(c.goToSalesPage(i))}),r(1),n()}if(t&2){let e=p.$implicit,l=d(3);k("active",e===l.salesPage),a(),x(" ",e," ")}}function De(t,p){if(t&1){let e=v();o(0,"div",60)(1,"button",61),u("click",function(){g(e);let i=d(2);return m(i.prevSalesPage())}),r(2," \u2190 Prev "),n(),o(3,"div",62),_(4,Le,2,3,"button",63),n(),o(5,"button",61),u("click",function(){g(e);let i=d(2);return m(i.nextSalesPage())}),r(6," Next \u2192 "),n()()}if(t&2){let e=d(2);a(),s("disabled",e.salesPage===1),a(3),s("ngForOf",e.getPageNumbers(e.salesTotalPages)),a(),s("disabled",e.salesPage===e.salesTotalPages)}}function Fe(t,p){if(t&1){let e=v();o(0,"div",54)(1,"div",55)(2,"label",88),r(3,"Show:"),n(),o(4,"select",89),O("ngModelChange",function(i){g(e);let c=d();return I(c.salesPageSize,i)||(c.salesPageSize=i),m(i)}),u("change",function(){g(e);let i=d();return m(i.onSalesPageSizeChange())}),_(5,Ve,2,2,"option",28),n(),o(6,"span"),r(7,"per page"),n()(),_(8,De,7,3,"div",58),n()}if(t&2){let e=d();a(4),S("ngModel",e.salesPageSize),a(),s("ngForOf",e.pageSizeOptions),a(3),s("ngIf",e.salesTotalPages>1)}}function Be(t,p){t&1&&(o(0,"div",65)(1,"p"),r(2,"No sales yet"),n()())}function Ne(t,p){if(t&1&&(o(0,"div",50),T(1,"img",51),n()),t&2){let e=d().$implicit;a(),s("src",e.imageUrl,V)("alt",e.name)}}function Ae(t,p){t&1&&(o(0,"div",52)(1,"span",53),r(2,"\u{1F4E6}"),n()())}function We(t,p){if(t&1&&(o(0,"option",59),r(1),n()),t&2){let e=p.$implicit;s("value",e),a(),f(e)}}function Ue(t,p){if(t&1){let e=v();o(0,"button",64),u("click",function(){let i=g(e).$implicit,c=d(5);return m(c.goToOutOfStockPage(i))}),r(1),n()}if(t&2){let e=p.$implicit,l=d(5);k("active",e===l.outOfStockPage),a(),x(" ",e," ")}}function qe(t,p){if(t&1){let e=v();o(0,"div",60)(1,"button",61),u("click",function(){g(e);let i=d(4);return m(i.prevOutOfStockPage())}),r(2," \u2190 Prev "),n(),o(3,"div",62),_(4,Ue,2,3,"button",63),n(),o(5,"button",61),u("click",function(){g(e);let i=d(4);return m(i.nextOutOfStockPage())}),r(6," Next \u2192 "),n()()}if(t&2){let e=d(4);a(),s("disabled",e.outOfStockPage===1),a(3),s("ngForOf",e.getPageNumbers(e.outOfStockTotalPages)),a(),s("disabled",e.outOfStockPage===e.outOfStockTotalPages)}}function $e(t,p){if(t&1){let e=v();o(0,"div",54)(1,"div",55)(2,"label",96),r(3,"Show:"),n(),o(4,"select",97),O("ngModelChange",function(i){g(e);let c=d(3);return I(c.outOfStockPageSize,i)||(c.outOfStockPageSize=i),m(i)}),u("change",function(){g(e);let i=d(3);return m(i.onOutOfStockPageSizeChange())}),_(5,We,2,2,"option",28),n(),o(6,"span"),r(7,"per page"),n()(),_(8,qe,7,3,"div",58),n()}if(t&2){let e=d(3);a(4),S("ngModel",e.outOfStockPageSize),a(),s("ngForOf",e.pageSizeOptions),a(3),s("ngIf",e.outOfStockTotalPages>1)}}function je(t,p){if(t&1){let e=v();o(0,"div",92),_(1,Ne,2,2,"div",41)(2,Ae,3,0,"div",42),o(3,"div",43)(4,"div",44),r(5),o(6,"div")(7,"div",45),r(8),n()(),o(9,"div",46)(10,"div",47),r(11),P(12,"number"),n(),o(13,"div",93),r(14,"Out of Stock"),n(),o(15,"div",94)(16,"button",95),u("click",function(){let i=g(e).$implicit,c=d(2);return m(c.onRestock(i))}),r(17," \u2795 Restock "),n()()()()(),_(18,$e,9,3,"div",22),n()}if(t&2){let e=p.$implicit,l=d(2);a(),s("ngIf",e.imageUrl),a(),s("ngIf",!e.imageUrl),a(3),x(" ",e.name,""),a(3),f(e.category),a(3),x("\u20B1",y(12,6,e.price,"1.2-2"),""),a(7),s("ngIf",l.outOfStockTotalPages>1||l.outOfStockProducts.length>10)}}function Qe(t,p){if(t&1&&(o(0,"div",90)(1,"h3")(2,"span",5),r(3,"\u26A0\uFE0F"),n(),r(4," Out of Stock "),o(5,"span",67),r(6),n()(),o(7,"div",38),_(8,je,19,9,"div",91),n()()),t&2){let e=d();a(6),f(e.outOfStockProducts.length),a(2),s("ngForOf",e.paginatedOutOfStockProducts)}}function Re(t,p){if(t&1){let e=v();o(0,"div",117),T(1,"img",118),o(2,"button",119),u("click",function(){g(e);let i=d(2);return m(i.removeEditImage())}),r(3," Remove Image "),n()()}if(t&2){let e=d(2);a(),s("src",e.editImagePreview,V)}}function Ge(t,p){if(t&1){let e=v();o(0,"div",120)(1,"input",121),u("change",function(i){g(e);let c=d(2);return m(c.onEditImageChange(i))}),n(),o(2,"label",122),r(3," \u{1F4F7} Upload Image "),n()()}}function Ye(t,p){if(t&1){let e=v();o(0,"div",98),u("click",function(){g(e);let i=d();return m(i.closeEditModal())}),o(1,"div",99),u("click",function(i){return g(e),m(i.stopPropagation())}),o(2,"div",100)(3,"h3"),r(4,"Edit Product"),n(),o(5,"button",101),u("click",function(){g(e);let i=d();return m(i.closeEditModal())}),r(6,"\xD7"),n()(),o(7,"div",102)(8,"div",103)(9,"label",104),r(10,"Product Image"),n(),_(11,Re,4,1,"div",105)(12,Ge,4,0,"div",106),n(),o(13,"div",107)(14,"label",108),r(15,"Product Name"),n(),o(16,"input",109),O("ngModelChange",function(i){g(e);let c=d();return I(c.editProductName,i)||(c.editProductName=i),m(i)}),n()(),o(17,"div",107)(18,"label",110),r(19,"Stock Quantity"),n(),o(20,"input",111),O("ngModelChange",function(i){g(e);let c=d();return I(c.editProductQuantity,i)||(c.editProductQuantity=i),m(i)}),n()(),o(21,"div",107)(22,"label",112),r(23,"Price"),n(),o(24,"input",113),O("ngModelChange",function(i){g(e);let c=d();return I(c.editProductPrice,i)||(c.editProductPrice=i),m(i)}),n()()(),o(25,"div",114)(26,"button",115),u("click",function(){g(e);let i=d();return m(i.closeEditModal())}),r(27,"Cancel"),n(),o(28,"button",116),u("click",function(){g(e);let i=d();return m(i.saveProductEdit())}),r(29,"Save Changes"),n()()()()}if(t&2){let e=d();a(11),s("ngIf",e.editImagePreview),a(),s("ngIf",!e.editImagePreview),a(4),S("ngModel",e.editProductName),a(4),S("ngModel",e.editProductQuantity),a(4),S("ngModel",e.editProductPrice)}}var nt=(()=>{class t{constructor(e,l){this.inventoryService=e,this.customerService=l,this.products=[],this.sales=[],this.subscriptions=new U,this.selectedCategory="All",this.categories=["All","Lechon","Hollow blocks","Sand and Gravel","Copra","Others"],this.pageSizeOptions=[10,20,50,100],this.availableProductsPage=1,this.availableProductsPageSize=10,this.salesPage=1,this.salesPageSize=10,this.outOfStockPage=1,this.outOfStockPageSize=10,this.pendingPage=1,this.pendingPageSize=10,this.isEditModalOpen=!1,this.editingProduct=null,this.editProductName="",this.editProductQuantity=0,this.editProductPrice=0,this.editProductImage="",this.editImagePreview=null}ngOnInit(){this.customerService.loadCustomers(),this.subscriptions.add(this.inventoryService.getProducts().subscribe(e=>{this.products=e})),this.subscriptions.add(this.inventoryService.getSales().subscribe(e=>{this.sales=e}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get pendingSales(){return this.sales.filter(e=>e.pending===!0)}get groupedPendingSales(){let e=new Map,l=[];this.pendingSales.forEach(c=>{c.orderId?(e.has(c.orderId)||e.set(c.orderId,[]),e.get(c.orderId).push(c)):l.push(c)});let i=[];return e.forEach((c,h)=>{let C=c[0];i.push({isGroup:!0,orderId:h,sales:c,total:c.reduce((w,b)=>w+b.total,0),productName:`Order #${h.substring(4,10)}...`,quantityCount:c.length,items:c,timestamp:C.timestamp,deliveryDate:C.deliveryDate,pending:!0})}),l.forEach(c=>{i.push({isGroup:!1,sales:[c],total:c.total,productName:c.productName,quantityCount:1,items:[c],timestamp:c.timestamp,deliveryDate:c.deliveryDate,pending:!0})}),i.sort((c,h)=>{let C=c.deliveryDate?new Date(c.deliveryDate).getTime():1/0,w=h.deliveryDate?new Date(h.deliveryDate).getTime():1/0;return C-w})}get filteredSales(){let e=this.sales.filter(l=>l.pending!==!0);return this.selectedCategory==="All"?e:e.filter(l=>l.category===this.selectedCategory)}get availableProducts(){return this.products.filter(e=>e.quantity>0)}get paginatedAvailableProducts(){let e=(this.availableProductsPage-1)*this.availableProductsPageSize,l=e+this.availableProductsPageSize;return this.availableProducts.slice(e,l)}get availableProductsTotalPages(){return Math.ceil(this.availableProducts.length/this.availableProductsPageSize)}get outOfStockProducts(){return this.products.filter(e=>e.quantity===0)}get paginatedOutOfStockProducts(){let e=(this.outOfStockPage-1)*this.outOfStockPageSize,l=e+this.outOfStockPageSize;return this.outOfStockProducts.slice(e,l)}get outOfStockTotalPages(){return Math.ceil(this.outOfStockProducts.length/this.outOfStockPageSize)}get paginatedSales(){let e=(this.salesPage-1)*this.salesPageSize,l=e+this.salesPageSize;return this.filteredSales.slice(e,l)}get salesTotalPages(){return Math.ceil(this.filteredSales.length/this.salesPageSize)}get salesByCategory(){let e=new Map;return this.sales.filter(l=>!l.pending).forEach(l=>{let i=e.get(l.category)||{total:0,count:0};e.set(l.category,{total:i.total+l.total,count:i.count+1})}),Array.from(e.entries()).map(([l,i])=>({category:l,total:i.total,count:i.count}))}get totalInventoryValue(){return this.products.reduce((e,l)=>e+l.price*l.quantity,0)}get totalSalesValue(){return this.sales.filter(e=>!e.pending).reduce((e,l)=>e+l.total,0)}nextAvailablePage(){this.availableProductsPage<this.availableProductsTotalPages&&this.availableProductsPage++}prevAvailablePage(){this.availableProductsPage>1&&this.availableProductsPage--}goToAvailablePage(e){e>=1&&e<=this.availableProductsTotalPages&&(this.availableProductsPage=e)}nextSalesPage(){this.salesPage<this.salesTotalPages&&this.salesPage++}prevSalesPage(){this.salesPage>1&&this.salesPage--}goToSalesPage(e){e>=1&&e<=this.salesTotalPages&&(this.salesPage=e)}nextOutOfStockPage(){this.outOfStockPage<this.outOfStockTotalPages&&this.outOfStockPage++}prevOutOfStockPage(){this.outOfStockPage>1&&this.outOfStockPage--}goToOutOfStockPage(e){this.outOfStockPage=e}get paginatedPendingSales(){let e=(this.pendingPage-1)*this.pendingPageSize,l=e+this.pendingPageSize;return this.groupedPendingSales.slice(e,l)}get pendingTotalPages(){return Math.ceil(this.groupedPendingSales.length/this.pendingPageSize)}nextPendingPage(){this.pendingPage<this.pendingTotalPages&&this.pendingPage++}prevPendingPage(){this.pendingPage>1&&this.pendingPage--}goToPendingPage(e){this.pendingPage=e}onPendingPageSizeChange(){this.pendingPage=1}onAvailablePageSizeChange(){this.availableProductsPage=1}onSalesPageSizeChange(){this.salesPage=1}onOutOfStockPageSizeChange(){this.outOfStockPage=1}getPageNumbers(e){return Array.from({length:e},(l,i)=>i+1)}onRestock(e){let l=prompt(`Enter quantity to add for ${e.name}:`);if(l){let i=parseInt(l,10);!isNaN(i)&&i>0?this.inventoryService.restockProduct(e.id,i):alert("Please enter a valid number greater than 0")}}openEditModal(e){this.editingProduct=e,this.editProductName=e.name,this.editProductQuantity=e.quantity,this.editProductPrice=e.price,this.editProductImage=e.imageUrl||"",this.editImagePreview=e.imageUrl||null,this.isEditModalOpen=!0}closeEditModal(){this.isEditModalOpen=!1,this.editingProduct=null,this.editProductName="",this.editProductQuantity=0,this.editProductPrice=0,this.editProductImage="",this.editImagePreview=null}onEditImageChange(e){let l=e.target;if(l.files&&l.files[0]){let i=l.files[0];if(i.size>10*1024*1024){alert("File is too large. Please select an image under 10MB.");return}let c=new FileReader;c.onload=h=>{let C=new Image;C.src=h.target?.result,C.onload=()=>{let w=document.createElement("canvas"),b=C.width,M=C.height,E=800;(b>E||M>E)&&(b>M?(M=Math.round(M*E/b),b=E):(b=Math.round(b*E/M),M=E)),w.width=b,w.height=M;let B=w.getContext("2d");if(B){B.drawImage(C,0,0,b,M);let N=w.toDataURL("image/jpeg",.7);this.editImagePreview=N,this.editProductImage=N}}},c.readAsDataURL(i)}}removeEditImage(){this.editImagePreview=null,this.editProductImage=""}saveProductEdit(){if(!this.editingProduct)return;if(!this.editProductName.trim()){alert("Product name cannot be empty");return}if(this.editProductQuantity<0){alert("Quantity cannot be negative");return}if(this.editProductPrice<0){alert("Price cannot be negative");return}let e=W(A({},this.editingProduct),{name:this.editProductName,quantity:this.editProductQuantity,price:this.editProductPrice,imageUrl:this.editProductImage});this.inventoryService.updateProduct(e),this.closeEditModal()}static{this.\u0275fac=function(l){return new(l||t)(L(re),L(ae))}}static{this.\u0275cmp=q({type:t,selectors:[["app-inventory-list"]],standalone:!0,features:[j],decls:65,vars:23,consts:[["noAvailable",""],["noSales",""],[1,"inventory-section"],[1,"inventory-content"],[1,"card","analytics-card"],[1,"icon"],[1,"analytics-grid"],[1,"chart-container"],[1,"bar-chart"],["class","bar-item",4,"ngFor","ngForOf"],["class","empty-chart",4,"ngIf"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-label"],[1,"stat-value"],[1,"stat-card","success"],[1,"lists-container"],[1,"card"],[1,"badge"],["class","product-list",4,"ngIf","ngIfElse"],["class","pagination",4,"ngIf"],["class","card pending-section",4,"ngIf"],[1,"section-header"],[1,"filter-group"],["for","categoryFilter"],["id","categoryFilter",1,"category-filter",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","sales-list",4,"ngIf","ngIfElse"],["class","card out-of-stock-section",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"bar-item"],[1,"bar-label"],[1,"bar-wrapper"],[1,"bar-fill",3,"title"],[1,"bar-value"],[1,"empty-chart"],[1,"product-list"],["class","product-item",4,"ngFor","ngForOf"],[1,"product-item"],["class","product-image-wrapper",4,"ngIf"],["class","product-image-wrapper placeholder",4,"ngIf"],[1,"product-info"],[1,"product-name"],[1,"product-category"],[1,"product-details"],[1,"product-price"],[1,"product-stock"],[1,"btn-edit-sm",3,"click"],[1,"product-image-wrapper"],["loading","lazy",1,"product-image",3,"src","alt"],[1,"product-image-wrapper","placeholder"],[1,"placeholder-icon"],[1,"pagination"],[1,"pagination-size"],["for","availablePageSize"],["id","availablePageSize",1,"page-size-select",3,"ngModelChange","change","ngModel"],["class","pagination-controls",4,"ngIf"],[3,"value"],[1,"pagination-controls"],[1,"pagination-btn",3,"click","disabled"],[1,"pagination-pages"],["class","pagination-page",3,"active","click",4,"ngFor","ngForOf"],[1,"pagination-page",3,"click"],[1,"empty-state"],[1,"card","pending-section"],[1,"badge","warning"],[1,"sales-list"],["class","sale-item",4,"ngFor","ngForOf"],[1,"sale-item"],[1,"sale-info"],[1,"sale-name"],["style","font-size:0.8em; color:gray",4,"ngIf"],["class","sale-details-text",4,"ngIf"],[1,"delivery-badge","warning"],[4,"ngIf"],[1,"sale-amount"],[1,"sale-total"],[1,"sale-date"],[2,"font-size","0.8em","color","gray"],[1,"sale-details-text"],["style","font-size:0.9em; margin-bottom:2px",4,"ngFor","ngForOf"],[2,"font-size","0.9em","margin-bottom","2px"],["for","pendingPageSize"],["id","pendingPageSize",1,"page-size-select",3,"ngModelChange","change","ngModel"],["class","delivery-badge",4,"ngIf"],[1,"delivery-badge"],["for","salesPageSize"],["id","salesPageSize",1,"page-size-select",3,"ngModelChange","change","ngModel"],[1,"card","out-of-stock-section"],["class","product-item dimmed",4,"ngFor","ngForOf"],[1,"product-item","dimmed"],[1,"product-stock","out"],[1,"product-actions"],[1,"btn-restock",3,"click"],["for","outOfStockPageSize"],["id","outOfStockPageSize",1,"page-size-select",3,"ngModelChange","change","ngModel"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"edit-image-section"],[1,"edit-label"],["class","edit-image-preview-container",4,"ngIf"],["class","edit-image-upload",4,"ngIf"],[1,"form-group"],["for","editName"],["type","text","id","editName",1,"text-input",3,"ngModelChange","ngModel"],["for","editQuantity"],["type","number","id","editQuantity","min","0",1,"number-input",3,"ngModelChange","ngModel"],["for","editPrice"],["type","number","id","editPrice","min","0","step","0.01",1,"number-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn-cancel",3,"click"],[1,"btn-save",3,"click"],[1,"edit-image-preview-container"],["alt","Product preview",1,"edit-image-preview",3,"src"],["type","button",1,"remove-edit-image-btn",3,"click"],[1,"edit-image-upload"],["type","file","id","editProductImage","accept","image/*",1,"file-input",3,"change"],["for","editProductImage",1,"btn-upload"]],template:function(l,i){if(l&1){let c=v();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h3")(4,"span",5),r(5,"\u{1F4C8}"),n(),r(6," Sales Analytics "),n(),o(7,"div",6)(8,"div",7)(9,"h4"),r(10,"Sales by Category"),n(),o(11,"div",8),_(12,le,9,12,"div",9)(13,ce,2,0,"div",10),n()()()(),o(14,"div",11)(15,"div",12)(16,"div",13),r(17,"\u{1F4B0}"),n(),o(18,"div",14)(19,"div",15),r(20,"Total Inventory Value"),n(),o(21,"div",16),r(22),P(23,"number"),n()()(),o(24,"div",17)(25,"div",13),r(26,"\u{1F4CA}"),n(),o(27,"div",14)(28,"div",15),r(29,"Total Sales"),n(),o(30,"div",16),r(31),P(32,"number"),n()()()(),o(33,"div",18)(34,"div",19)(35,"h3")(36,"span",5),r(37,"\u{1F4E6}"),n(),r(38," Available Inventory "),o(39,"span",20),r(40),n()(),_(41,ge,2,1,"div",21)(42,ve,9,3,"div",22)(43,fe,3,0,"ng-template",null,0,F),n(),_(45,Me,10,3,"div",23),o(46,"div",19)(47,"div",24)(48,"h3")(49,"span",5),r(50,"\u{1F4B0}"),n(),r(51," Sales History "),o(52,"span",20),r(53),n()(),o(54,"div",25)(55,"label",26),r(56,"Filter by Category:"),n(),o(57,"select",27),O("ngModelChange",function(C){return g(c),I(i.selectedCategory,C)||(i.selectedCategory=C),m(C)}),u("change",function(){return g(c),m(i.salesPage=1)}),_(58,Ee,2,2,"option",28),n()()(),_(59,ze,2,1,"div",29)(60,Fe,9,3,"div",22)(61,Be,3,0,"ng-template",null,1,F),n(),_(63,Qe,9,2,"div",30)(64,Ye,30,5,"div",31),n()()()}if(l&2){let c=D(44),h=D(62);a(12),s("ngForOf",i.salesByCategory),a(),s("ngIf",i.salesByCategory.length===0),a(9),x("\u20B1",y(23,17,i.totalInventoryValue,"1.2-2"),""),a(9),x("\u20B1",y(32,20,i.totalSalesValue,"1.2-2"),""),a(9),f(i.availableProducts.length),a(),s("ngIf",i.availableProducts.length>0)("ngIfElse",c),a(),s("ngIf",i.availableProductsTotalPages>1||i.availableProducts.length>10),a(3),s("ngIf",i.pendingSales.length>0),a(8),f(i.filteredSales.length),a(4),S("ngModel",i.selectedCategory),a(),s("ngForOf",i.categories),a(),s("ngIf",i.sales.length>0)("ngIfElse",h),a(),s("ngIf",i.salesTotalPages>1||i.filteredSales.length>10),a(3),s("ngIf",i.outOfStockProducts.length>0),a(),s("ngIf",i.isEditModalOpen)}},dependencies:[H,Q,R,Y,G,oe,te,ie,J,Z,ee,K,ne,X],styles:[".inventory-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-xl)}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:var(--space-lg);margin-bottom:var(--space-2xl)}.analytics-card[_ngcontent-%COMP%]{margin-bottom:var(--space-2xl)}.analytics-grid[_ngcontent-%COMP%]{margin-top:var(--space-lg)}.chart-container[_ngcontent-%COMP%]{background:var(--color-bg);padding:var(--space-lg);border-radius:var(--radius-md)}.chart-container[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 var(--space-lg) 0;color:var(--color-text);font-size:1rem}.bar-chart[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-md)}.bar-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 1fr 120px;gap:var(--space-sm);align-items:center}.bar-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text)}.bar-wrapper[_ngcontent-%COMP%]{height:24px;background:var(--color-surface);border-radius:var(--radius-md);overflow:hidden;border:1px solid var(--color-border)}.bar-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,var(--color-primary),var(--color-success));transition:width .3s ease;min-width:2%}.bar-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:var(--color-text);text-align:right}.empty-chart[_ngcontent-%COMP%]{text-align:center;padding:var(--space-2xl);color:var(--color-text-muted);font-style:italic}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--space-md);margin-bottom:var(--space-lg)}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm)}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text)}.category-filter[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-md);background:var(--color-surface);color:var(--color-text);font-size:.875rem;cursor:pointer;transition:all var(--transition-base)}.category-filter[_ngcontent-%COMP%]:hover{border-color:var(--color-primary)}.category-filter[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px #3b82f61a}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary),var(--color-primary-dark));color:#fff;padding:var(--space-xl);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);display:flex;align-items:center;gap:var(--space-lg)}.stat-card.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-success),#059669)}.stat-icon[_ngcontent-%COMP%]{font-size:2.5rem}.stat-info[_ngcontent-%COMP%]{flex:1}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;opacity:.9;margin-bottom:var(--space-sm)}.stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700}.lists-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(500px,1fr));gap:var(--space-xl)}h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);margin-bottom:var(--space-lg)}.icon[_ngcontent-%COMP%]{font-size:1.5rem}.badge[_ngcontent-%COMP%]{margin-left:auto;background:var(--color-bg);color:var(--color-primary);padding:var(--space-xs) var(--space-md);border-radius:var(--radius-xl);font-size:.875rem;font-weight:600}.badge.warning[_ngcontent-%COMP%]{background:#fef3c7;color:var(--color-warning)}.product-list[_ngcontent-%COMP%], .sales-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-md)}.product-item[_ngcontent-%COMP%], .sale-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--space-md);padding:var(--space-md);background:var(--color-bg);border-radius:var(--radius-md);transition:all var(--transition-base)}.product-image-wrapper[_ngcontent-%COMP%]{flex-shrink:0;width:60px;height:60px;border-radius:var(--radius-md);overflow:hidden;background:var(--color-surface);border:1px solid var(--color-border);display:flex;align-items:center;justify-content:center}.product-image-wrapper.placeholder[_ngcontent-%COMP%]{background:var(--color-bg)}.product-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.placeholder-icon[_ngcontent-%COMP%]{font-size:1.5rem;opacity:.5}.product-item[_ngcontent-%COMP%]:hover, .sale-item[_ngcontent-%COMP%]:hover{background:#e0e7ff;transform:translate(4px)}.product-item.dimmed[_ngcontent-%COMP%]{opacity:.5}.product-info[_ngcontent-%COMP%], .sale-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-xs);flex:1;align-self:flex-start;padding-top:4px}.product-name[_ngcontent-%COMP%], .sale-name[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text)}.product-category[_ngcontent-%COMP%], .sale-details-text[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text-muted)}.delivery-badge[_ngcontent-%COMP%]{display:inline-block;margin-top:var(--space-xs);padding:var(--space-xs) var(--space-sm);background:#10b9811a;color:var(--color-success);border-radius:var(--radius-sm);font-size:.75rem;font-weight:500}.product-details[_ngcontent-%COMP%], .sale-amount[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:var(--space-xs)}.product-price[_ngcontent-%COMP%], .sale-total[_ngcontent-%COMP%]{font-weight:600;font-size:1.125rem;color:var(--color-primary)}.product-stock[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-success);font-weight:500}.product-stock.out[_ngcontent-%COMP%]{color:var(--color-danger)}.sale-date[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:var(--space-2xl);color:var(--color-text-muted)}.out-of-stock-section[_ngcontent-%COMP%]{border:2px solid rgba(239,68,68,.2)}@media (max-width: 768px){.lists-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.pagination[_ngcontent-%COMP%]{flex-wrap:wrap}.pagination-pages[_ngcontent-%COMP%]{order:3;width:100%;margin-top:var(--space-sm)}h3[_ngcontent-%COMP%]{font-size:1.25rem}.product-name[_ngcontent-%COMP%], .sale-name[_ngcontent-%COMP%]{font-size:.95rem}.product-category[_ngcontent-%COMP%], .sale-details-text[_ngcontent-%COMP%]{font-size:.8rem}.product-price[_ngcontent-%COMP%], .sale-total[_ngcontent-%COMP%]{font-size:1rem}.product-stock[_ngcontent-%COMP%], .sale-date[_ngcontent-%COMP%]{font-size:.75rem}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem}.stat-label[_ngcontent-%COMP%]{font-size:.8rem}}.btn-restock[_ngcontent-%COMP%]{margin-top:var(--space-xs);padding:var(--space-xs) var(--space-sm);background:var(--color-primary-light);color:#fff;border:none;border-radius:var(--radius-sm);font-size:.75rem;font-weight:500;cursor:pointer;transition:all var(--transition-base)}.btn-restock[_ngcontent-%COMP%]:hover{background:var(--color-primary);transform:translateY(-1px)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background-color:var(--color-surface);padding:2rem;border-radius:12px;width:90%;max-width:500px;box-shadow:0 10px 25px #0003;animation:_ngcontent-%COMP%_slideIn .3s ease-out;color:var(--color-text)}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;border-bottom:1px solid var(--color-border);padding-bottom:1rem}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--color-text)}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--color-text-muted)}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.modal-footer[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:flex-end;gap:1rem;padding-top:1rem;border-top:1px solid var(--color-border)}.btn-cancel[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid var(--color-border);background-color:var(--color-surface);color:var(--color-text);border-radius:6px;cursor:pointer;font-weight:500;transition:background-color .2s}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:var(--color-bg)}.btn-save[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:#4caf50;color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:500}.btn-save[_ngcontent-%COMP%]:hover{background-color:#45a049}.btn-edit-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;background-color:transparent;color:var(--color-primary);border:1px solid var(--color-primary);border-radius:4px;cursor:pointer;font-size:.75rem;font-weight:500;transition:all .2s;margin-left:.5rem}.btn-edit-sm[_ngcontent-%COMP%]:hover{background-color:var(--color-primary);color:#fff}.product-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.edit-image-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.edit-label[_ngcontent-%COMP%]{font-weight:500;color:var(--color-text);font-size:.9rem}.edit-image-preview-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;align-items:flex-start}.edit-image-preview[_ngcontent-%COMP%]{width:100px;height:100px;object-fit:cover;border-radius:var(--radius-md);border:1px solid var(--color-border)}.remove-edit-image-btn[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-danger);background:none;border:none;cursor:pointer;padding:0;text-decoration:underline}.remove-edit-image-btn[_ngcontent-%COMP%]:hover{text-decoration:none}.edit-image-upload[_ngcontent-%COMP%]{display:flex;align-items:center}.edit-image-upload[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]{opacity:0;width:.1px;height:.1px;position:absolute}.btn-upload[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background-color:var(--color-bg);border:1px dashed var(--color-border);border-radius:var(--radius-md);color:var(--color-text-muted);font-size:.9rem;cursor:pointer;transition:all .2s;width:100%;justify-content:center}.btn-upload[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);color:var(--color-primary);background-color:#f0f9ff}"]})}}return t})();export{nt as a};

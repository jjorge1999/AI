import{g as re}from"./chunk-H3ZRXFQB.js";import{b as oe,c as ae,f as ce,h as le,i as se,j as de,k as pe,l as me,m as ue,p as ge}from"./chunk-EDJXXAUJ.js";import{c as he}from"./chunk-XJ5NHUZA.js";import"./chunk-QHBZUDAX.js";import{a as fe}from"./chunk-KJWVDUE4.js";import{a as ve}from"./chunk-GEGDM544.js";import{Ab as P,Ba as l,Bb as w,Ca as V,Cb as q,Db as J,Ob as F,P as W,Pb as X,Ra as v,Ta as d,Ua as A,Va as T,Ya as i,Za as r,_ as G,_a as Q,a as B,ac as K,bb as b,bc as Z,cb as p,cc as ee,db as s,ec as te,g as j,ga as m,ha as u,hc as ne,ic as ie,lb as o,mb as C,nb as x,nd as _e,ob as R,pb as U,qb as S,rb as O,sb as k,u as L,ub as H,vb as Y,za as N}from"./chunk-IZ5DWI6X.js";import{a as z,b as $,g as D}from"./chunk-7QOE2ANW.js";var xe=(()=>{class c{constructor(){this.device=null,this.characteristic=null,this.connectionStatusSubject=new j("disconnected"),this.connectionStatus$=this.connectionStatusSubject.asObservable(),this.deviceNameSubject=new j(null),this.deviceName$=this.deviceNameSubject.asObservable(),this.PRINTER_SERVICE_UUIDS=["000018f0-0000-1000-8000-00805f9b34fb","49535343-fe7d-4ae5-8fa9-9fafd205e455","0000ff00-0000-1000-8000-00805f9b34fb","e7810a71-73ae-499d-8c15-faa9aef0c3f2"],this.ESC=27,this.GS=29,this.LF=10;let e=localStorage.getItem("jjm_bluetooth_printer");e&&this.deviceNameSubject.next(e)}isBluetoothSupported(){return!!navigator.bluetooth}connectPrinter(){return D(this,null,function*(){if(!this.isBluetoothSupported())throw new Error("Web Bluetooth API is not supported in this browser");this.connectionStatusSubject.next("connecting");try{let e=navigator.bluetooth;if(this.device=yield e.requestDevice({acceptAllDevices:!0,optionalServices:this.PRINTER_SERVICE_UUIDS}),!this.device)throw new Error("No device selected");this.device.addEventListener("gattserverdisconnected",this.onDisconnected.bind(this));let n=yield this.device.gatt?.connect();if(!n)throw new Error("Failed to connect to GATT server");let t=yield n.getPrimaryServices();for(let _ of t)try{let f=yield _.getCharacteristics();for(let h of f)if(h.properties.write||h.properties.writeWithoutResponse){this.characteristic=h;break}if(this.characteristic)break}catch{}if(!this.characteristic)throw new Error("No writable characteristic found on printer");let a=this.device.name||"Bluetooth Printer";return localStorage.setItem("jjm_bluetooth_printer",a),this.deviceNameSubject.next(a),this.connectionStatusSubject.next("connected"),!0}catch(e){throw console.error("Bluetooth connection error:",e),this.connectionStatusSubject.next("disconnected"),e}})}disconnectPrinter(){this.device?.gatt?.connected&&this.device.gatt.disconnect(),this.device=null,this.characteristic=null,this.connectionStatusSubject.next("disconnected")}onDisconnected(){this.characteristic=null,this.connectionStatusSubject.next("disconnected")}sendData(e){return D(this,null,function*(){if(!this.characteristic)throw new Error("Printer not connected");let n=100;for(let t=0;t<e.length;t+=n){let a=e.slice(t,t+n);this.characteristic.properties.writeWithoutResponse?yield this.characteristic.writeValueWithoutResponse(a):yield this.characteristic.writeValue(a),yield new Promise(_=>setTimeout(_,50))}})}buildEscPosReceipt(e){let n=new TextEncoder,t=[],a=(...f)=>{for(let h of f)t.push(h)},_=f=>{let h=n.encode(f);for(let M=0;M<h.length;M++)t.push(h[M])};a(this.ESC,64),a(this.ESC,97,1),a(this.ESC,33,48),_(e.storeName),a(this.LF),a(this.ESC,33,0),e.storeAddress&&(_(e.storeAddress),a(this.LF)),e.storePhone&&(_(`Tel: ${e.storePhone}`),a(this.LF)),_("================================"),a(this.LF),_(`Order: ${e.orderId}`),a(this.LF),_(`Date: ${e.date.toLocaleDateString()} ${e.date.toLocaleTimeString()}`),a(this.LF),e.customerName&&(_(`Customer: ${e.customerName}`),a(this.LF)),e.deliveryDate&&(_(`Delivery: ${e.deliveryDate.toLocaleDateString()} ${e.deliveryDate.toLocaleTimeString()}`),a(this.LF)),_("--------------------------------"),a(this.LF),a(this.ESC,97,0);for(let f of e.items){_(f.name),a(this.LF);let h=`  ${f.quantity} x ${this.formatMoney(f.price)}`,M=this.formatMoney(f.total),y=32-h.length-M.length;if(_(h+" ".repeat(Math.max(1,y))+M),a(this.LF),f.discount&&f.discount>0){let E=f.discountType==="percent"?`  Discount: ${f.discount}%`:`  Discount: -${this.formatMoney(f.discount)}`;_(E),a(this.LF)}}return _("--------------------------------"),a(this.LF),a(this.ESC,97,2),e.totalDiscount>0&&(_(`Total Discount: -${this.formatMoney(e.totalDiscount)}`),a(this.LF)),a(this.ESC,69,1),_(`TOTAL: ${this.formatMoney(e.total)}`),a(this.LF),a(this.ESC,69,0),_(`Cash: ${this.formatMoney(e.cashReceived)}`),a(this.LF),_(`Change: ${this.formatMoney(e.change)}`),a(this.LF),e.notes&&(a(this.ESC,97,0),_("--------------------------------"),a(this.LF),_(`Notes: ${e.notes}`),a(this.LF)),a(this.ESC,97,1),_("================================"),a(this.LF),_("Thank you for your purchase!"),a(this.LF),_("Please come again"),a(this.LF,this.LF,this.LF),a(this.GS,86,1),new Uint8Array(t)}formatMoney(e){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e)}printReceipt(e){return D(this,null,function*(){let n=this.buildEscPosReceipt(e);yield this.sendData(n)})}printTestPage(){return D(this,null,function*(){let e={storeName:"JJM Inventory",storeAddress:"Test Address",storePhone:"123-456-7890",orderId:"TEST-001",date:new Date,items:[{name:"Test Product 1",quantity:2,price:100,total:200},{name:"Test Product 2",quantity:1,price:150,total:150}],subtotal:350,totalDiscount:0,total:350,cashReceived:500,change:150};yield this.printReceipt(e)})}isConnected(){return this.connectionStatusSubject.value==="connected"&&this.characteristic!==null}forgetPrinter(){localStorage.removeItem("jjm_bluetooth_printer"),this.deviceNameSubject.next(null),this.disconnectPrinter()}static{this.\u0275fac=function(n){return new(n||c)}}static{this.\u0275prov=W({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();var be=()=>[1,5,10,25];function Pe(c,g){if(c&1){let e=b();i(0,"button",3),p("click",function(){let t=m(e).$implicit,a=s();return u(a.categoryFilter=t)}),i(1,"span",4),o(2),r(),i(3,"span",5),o(4),r()()}if(c&2){let e=g.$implicit,n=s();T("active",n.categoryFilter===e),l(2),C(n.getCategoryIcon(e)),l(2),C(e)}}function Me(c,g){c&1&&(i(0,"span",63),o(1,"inventory_2"),r())}function we(c,g){if(c&1&&(i(0,"span",64),o(1),r()),c&2){let e=s().$implicit,n=s();l(),x(" ",n.getCartQuantity(e.id)," ")}}function Se(c,g){if(c&1){let e=b();i(0,"div",54),p("click",function(){let t=m(e).$implicit,a=s();return u(a.addProductToCart(t))}),i(1,"div",55),v(2,Me,2,0,"span",56)(3,we,2,1,"span",57),r(),i(4,"div",58)(5,"p",59),o(6),r(),i(7,"div",60)(8,"span",61),o(9),r(),i(10,"span",62),o(11),r()()()()}if(c&2){let e=g.$implicit,n=s();T("in-cart",n.isInCart(e.id)),l(),A("background-image",e.imageUrl?"url("+e.imageUrl+")":"none"),l(),d("ngIf",!e.imageUrl),l(),d("ngIf",n.isInCart(e.id)),l(3),C(e.name),l(3),C(n.formatCurrency(e.price)),l(2),x("Qty: ",e.quantity,"")}}function Oe(c,g){c&1&&(i(0,"div",65)(1,"span",4),o(2,"search_off"),r(),i(3,"p"),o(4,"No products available"),r()())}function ke(c,g){if(c&1){let e=b();i(0,"button",66),p("click",function(){m(e);let t=s();return u(t.clearCart())}),o(1,"Clear"),r()}}function Te(c,g){if(c&1&&(i(0,"option",67),o(1),r()),c&2){let e=g.$implicit;d("value",e.id),l(),x(" ",e.name," ")}}function Ee(c,g){c&1&&(i(0,"span",4),o(1,"inventory_2"),r())}function De(c,g){if(c&1&&(i(0,"span",82),o(1),r()),c&2){let e=s().$implicit,n=s();l(),x(" ",n.formatCurrency(e.product.price)," each ")}}function Ie(c,g){if(c&1&&(i(0,"span",83),o(1),r()),c&2){let e=s().$implicit,n=s();l(),x(" ",e.discountType==="percent"?e.discount+"%":n.formatCurrency(e.discount)," off ")}}function Ve(c,g){if(c&1){let e=b();i(0,"div",68)(1,"div",69),v(2,Ee,2,0,"span",70),r(),i(3,"div",71)(4,"div",72)(5,"span",73),o(6),r(),i(7,"span",74),o(8),r()(),i(9,"div",72),v(10,De,2,1,"span",75)(11,Ie,2,1,"span",76),i(12,"div",77)(13,"button",78),p("click",function(){let t=m(e).index,a=s();return u(a.decrementItem(t))}),i(14,"span",4),o(15,"remove"),r()(),i(16,"button",79),p("click",function(){let t=m(e).index,a=s();return u(a.openQuantityModal(t))}),o(17),r(),i(18,"button",80),p("click",function(){let t=m(e).index,a=s();return u(a.incrementItem(t))}),i(19,"span",4),o(20,"add"),r()()()()(),i(21,"button",81),p("click",function(){let t=m(e).index,a=s();return u(a.removeFromCart(t))}),i(22,"span",4),o(23,"close"),r()()()}if(c&2){let e=g.$implicit,n=s();l(),A("background-image",e.product.imageUrl?"url("+e.product.imageUrl+")":"none"),l(),d("ngIf",!e.product.imageUrl),l(4),C(e.product.name),l(2),C(n.formatCurrency(e.total)),l(2),d("ngIf",e.discount===0),l(),d("ngIf",e.discount>0),l(6),x(" ",e.quantity," "),l(),d("disabled",e.quantity>=e.product.quantity)}}function qe(c,g){c&1&&(i(0,"div",84)(1,"span",4),o(2,"shopping_cart"),r(),i(3,"p"),o(4,"Cart is empty"),r(),i(5,"span",85),o(6,"Tap products to add them"),r()())}function Re(c,g){if(c&1&&(i(0,"span",86),o(1),r()),c&2){let e=s();l(),C(e.pendingSales().length)}}function Ne(c,g){if(c&1){let e=b();i(0,"div",87)(1,"span",4),o(2,"local_shipping"),r(),i(3,"span"),o(4),P(5,"date"),r(),i(6,"button",88),p("click",function(){m(e);let t=s();return u(t.clearDelivery())}),o(7,"\u2715"),r()()}if(c&2){let e=s();l(4),R("",q(5,2,e.deliveryDate,"shortDate")," ",e.deliveryTime?"at "+e.deliveryTime:"","")}}function Fe(c,g){if(c&1){let e=b();i(0,"div",89)(1,"div",90)(2,"label"),o(3,"Cash Received"),r(),i(4,"div",91)(5,"span",92),o(6,"\u20B1"),r(),i(7,"input",93),p("ngModelChange",function(t){m(e);let a=s();return u(a.onCashInput(t))})("blur",function(){m(e);let t=s();return u(t.formatCashOnBlur())})("focus",function(){m(e);let t=s();return u(t.unformatCashOnFocus())}),r()()(),i(8,"div",94)(9,"span"),o(10,"Change"),r(),i(11,"span",95),o(12),r()()()}if(c&2){let e=s();l(7),d("ngModel",e.cashDisplayValue),l(),T("negative",e.change<0),l(4),C(e.formatCurrency(e.change))}}function ze(c,g){if(c&1&&(i(0,"div",96)(1,"span",4),o(2,"warning"),r(),o(3),r()),c&2){let e=s();l(3),x(" ",e.errorMessage," ")}}function $e(c,g){if(c&1){let e=b();i(0,"button",97),p("click",function(){m(e);let t=s();return u(t.clearFilter())}),i(1,"span",4),o(2,"clear"),r()()}}function je(c,g){if(c&1&&(i(0,"span",114),o(1),P(2,"slice"),r()),c&2){let e=s().$implicit;l(),x("Order #",J(2,1,e.orderId,4,12),"")}}function Ae(c,g){if(c&1&&(i(0,"span",114),o(1),r()),c&2){let e=s().$implicit;l(),C(e.sales==null||e.sales[0]==null?null:e.sales[0].productName)}}function Be(c,g){c&1&&(i(0,"span",115),o(1,"RESERVATION"),r())}function Le(c,g){if(c&1&&(i(0,"span"),o(1),r()),c&2){let e=g.$implicit,n=g.last;l(),U(" ",e.productName," (x",e.quantitySold,")",n?"":", "," ")}}function We(c,g){if(c&1&&(i(0,"div",116),v(1,Le,2,3,"span",117),r()),c&2){let e=s().$implicit;l(),d("ngForOf",e.sales)}}function Ge(c,g){if(c&1&&(i(0,"div",118)(1,"span",4),o(2,"person"),r(),i(3,"span"),o(4),r()()),c&2){let e=s().$implicit;l(4),C(e.customer.name)}}function Qe(c,g){if(c&1&&(i(0,"div",118)(1,"span",4),o(2,"event"),r(),i(3,"span"),o(4),P(5,"date"),r()()),c&2){let e=s().$implicit;l(4),C(q(5,1,e.deliveryDate,"medium"))}}function Ue(c,g){if(c&1&&(i(0,"div",118)(1,"span",4),o(2,"percent"),r(),i(3,"span"),o(4),r()()),c&2){let e=s().$implicit,n=s();l(4),x("Discount: ",e.discountType==="percent"?e.discount+"%":n.formatCurrency(e.discount),"")}}function He(c,g){if(c&1&&(i(0,"div",118)(1,"span",4),o(2,"notes"),r(),i(3,"span"),o(4),r()()),c&2){let e=s().$implicit;l(4),C(e.deliveryNotes)}}function Ye(c,g){if(c&1){let e=b();i(0,"button",119),p("click",function(){m(e);let t=s().$implicit,a=s();return u(a.confirmGroupReservation(t==null?null:t.sales))}),i(1,"span",4),o(2,"check_circle"),r()()}}function Je(c,g){if(c&1){let e=b();i(0,"button",120),p("click",function(){m(e);let t=s().$implicit,a=s();return u(a.markGroupAsDelivered(t==null?null:t.sales))}),i(1,"span",4),o(2,"local_shipping"),r()()}}function Xe(c,g){if(c&1){let e=b();i(0,"div",98)(1,"div",99)(2,"div",100),v(3,je,3,5,"span",101)(4,Ae,2,1,"span",101)(5,Be,2,0,"span",102),r(),i(6,"span",103),o(7),r()(),v(8,We,2,1,"div",104),i(9,"div",105),v(10,Ge,5,1,"div",106)(11,Qe,6,4,"div",106)(12,Ue,5,1,"div",106),i(13,"div",107)(14,"span",4),o(15,"payments"),r(),i(16,"span"),o(17),r()(),i(18,"div",107)(19,"span",4),o(20,"change_circle"),r(),i(21,"span"),o(22),r()(),v(23,He,5,1,"div",106),r(),i(24,"div",108)(25,"button",109),p("click",function(){let t=m(e).$implicit,a=s();return u(a.reprintOrderReceipt(t))}),i(26,"span",4),o(27,"print"),r()(),i(28,"button",110),p("click",function(){let t=m(e).$implicit,a=s();return u(a.openEditModal(t==null?null:t.sales[0]))}),i(29,"span",4),o(30,"edit"),r()(),v(31,Ye,3,0,"button",111)(32,Je,3,0,"button",112),i(33,"button",113),p("click",function(){let t=m(e).$implicit,a=s();return u(a.cancelGroupOrder(t==null?null:t.sales))}),i(34,"span",4),o(35,"delete"),r()()()()}if(c&2){let e=g.$implicit,n=s();T("reservation",e.status==="pending_confirmation"),l(3),d("ngIf",e.isGroup),l(),d("ngIf",!e.isGroup),l(),d("ngIf",e.status==="pending_confirmation"),l(2),C(n.formatCurrency(e.total)),l(),d("ngIf",e.isGroup),l(2),d("ngIf",e.customer),l(),d("ngIf",e.deliveryDate),l(),d("ngIf",e.discount>0),l(5),x("Cash: ",n.formatCurrency(e.cashReceived),""),l(5),x("Change: ",n.formatCurrency(e.change),""),l(),d("ngIf",e.deliveryNotes),l(8),d("ngIf",e.status==="pending_confirmation"),l(),d("ngIf",e.status!=="pending_confirmation")}}function Ke(c,g){c&1&&(i(0,"div",121)(1,"span",4),o(2,"check_circle"),r(),i(3,"p"),o(4,"No pending deliveries"),r()())}function Ze(c,g){if(c&1){let e=b();i(0,"div",122)(1,"button",123),p("click",function(){m(e);let t=s();return u(t.prevPendingPage())}),i(2,"span",4),o(3,"chevron_left"),r()(),i(4,"span"),o(5),r(),i(6,"button",123),p("click",function(){m(e);let t=s();return u(t.nextPendingPage())}),i(7,"span",4),o(8,"chevron_right"),r()()()}if(c&2){let e=s();l(),d("disabled",e.pendingPage===1),l(4),R("Page ",e.pendingPage," of ",e.pendingTotalPages,""),l(),d("disabled",e.pendingPage>=e.pendingTotalPages)}}function et(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closeDeliveryModal())}),i(1,"div",125),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h3")(4,"span",4),o(5,"local_shipping"),r(),o(6," Delivery Options"),r(),i(7,"button",127),p("click",function(){m(e);let t=s();return u(t.closeDeliveryModal())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",128)(11,"div",129)(12,"label"),o(13,"Delivery Date"),r(),i(14,"input",130),k("ngModelChange",function(t){m(e);let a=s();return O(a.deliveryDate,t)||(a.deliveryDate=t),u(t)}),r()(),i(15,"div",129)(16,"label"),o(17,"Delivery Time"),r(),i(18,"input",131),k("ngModelChange",function(t){m(e);let a=s();return O(a.deliveryTime,t)||(a.deliveryTime=t),u(t)}),r()(),i(19,"div",129)(20,"label"),o(21,"Notes"),r(),i(22,"textarea",132),k("ngModelChange",function(t){m(e);let a=s();return O(a.deliveryNotes,t)||(a.deliveryNotes=t),u(t)}),r()()(),i(23,"div",133)(24,"button",134),p("click",function(){m(e);let t=s();return u(t.closeDeliveryModal())}),o(25,"Cancel"),r(),i(26,"button",135),p("click",function(){m(e);let t=s();return u(t.closeDeliveryModal())}),o(27,"Save"),r()()()()}if(c&2){let e=s();l(14),S("ngModel",e.deliveryDate),d("min",e.minDate),l(4),S("ngModel",e.deliveryTime),l(4),S("ngModel",e.deliveryNotes)}}function tt(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closeEditModal())}),i(1,"div",125),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h3")(4,"span",4),o(5,"edit"),r(),o(6," Edit Delivery"),r(),i(7,"button",127),p("click",function(){m(e);let t=s();return u(t.closeEditModal())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",128)(11,"div",129)(12,"label"),o(13,"Delivery Date"),r(),i(14,"input",130),k("ngModelChange",function(t){m(e);let a=s();return O(a.editDeliveryDate,t)||(a.editDeliveryDate=t),u(t)}),r()(),i(15,"div",129)(16,"label"),o(17,"Delivery Time"),r(),i(18,"input",131),k("ngModelChange",function(t){m(e);let a=s();return O(a.editDeliveryTime,t)||(a.editDeliveryTime=t),u(t)}),r()(),i(19,"div",129)(20,"label"),o(21,"Notes"),r(),i(22,"textarea",136),k("ngModelChange",function(t){m(e);let a=s();return O(a.editDeliveryNotes,t)||(a.editDeliveryNotes=t),u(t)}),r()()(),i(23,"div",133)(24,"button",134),p("click",function(){m(e);let t=s();return u(t.closeEditModal())}),o(25,"Cancel"),r(),i(26,"button",135),p("click",function(){m(e);let t=s();return u(t.saveEdit())}),o(27,"Save Changes"),r()()()()}if(c&2){let e=s();l(14),S("ngModel",e.editDeliveryDate),d("min",e.minDate),l(4),S("ngModel",e.editDeliveryTime),l(4),S("ngModel",e.editDeliveryNotes)}}function nt(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closeDiscountModal())}),i(1,"div",137),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h3")(4,"span",4),o(5,"percent"),r(),o(6," Apply Discount"),r(),i(7,"button",127),p("click",function(){m(e);let t=s();return u(t.closeDiscountModal())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",128)(11,"div",138)(12,"input",139),k("ngModelChange",function(t){m(e);let a=s();return O(a.tempDiscount,t)||(a.tempDiscount=t),u(t)}),r(),i(13,"select",140),k("ngModelChange",function(t){m(e);let a=s();return O(a.tempDiscountType,t)||(a.tempDiscountType=t),u(t)}),i(14,"option",141),o(15,"\u20B1 Amount"),r(),i(16,"option",142),o(17,"% Percent"),r()()()(),i(18,"div",133)(19,"button",134),p("click",function(){m(e);let t=s();return u(t.closeDiscountModal())}),o(20,"Cancel"),r(),i(21,"button",135),p("click",function(){m(e);let t=s();return u(t.applyDiscount())}),o(22,"Apply"),r()()()()}if(c&2){let e=s();l(12),S("ngModel",e.tempDiscount),l(),S("ngModel",e.tempDiscountType)}}function it(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closeNotesModal())}),i(1,"div",137),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h3")(4,"span",4),o(5,"edit_note"),r(),o(6," Order Notes"),r(),i(7,"button",127),p("click",function(){m(e);let t=s();return u(t.closeNotesModal())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",128)(11,"textarea",143),k("ngModelChange",function(t){m(e);let a=s();return O(a.deliveryNotes,t)||(a.deliveryNotes=t),u(t)}),r()(),i(12,"div",133)(13,"button",134),p("click",function(){m(e);let t=s();return u(t.closeNotesModal())}),o(14,"Cancel"),r(),i(15,"button",135),p("click",function(){m(e);let t=s();return u(t.closeNotesModal())}),o(16,"Save"),r()()()()}if(c&2){let e=s();l(11),S("ngModel",e.deliveryNotes)}}function rt(c,g){if(c&1&&(i(0,"div",153)(1,"span",154),o(2),r(),i(3,"span",155),o(4),r()()),c&2){let e=s(2);l(2),C(e.cart[e.quantityModalIndex].product.name),l(2),x("Max: ",e.quantityModalMax," in stock")}}function ot(c,g){if(c&1){let e=b();i(0,"button",156),p("click",function(){let t=m(e).$implicit,a=s(2);return u(a.setQuickQuantity(t))}),o(1),r()}if(c&2){let e=g.$implicit,n=s(2);T("active",n.quantityModalValue===e),d("disabled",e>n.quantityModalMax),l(),x(" ",e," ")}}function at(c,g){if(c&1&&(i(0,"p",157)(1,"span",4),o(2,"warning"),r(),o(3),r()),c&2){let e=s(2);l(3),x(" Exceeds available stock. Will be set to ",e.quantityModalMax,". ")}}function ct(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closeQuantityModal())}),i(1,"div",144),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h3")(4,"span",4),o(5,"pin"),r(),o(6," Set Quantity"),r(),i(7,"button",127),p("click",function(){m(e);let t=s();return u(t.closeQuantityModal())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",128),v(11,rt,5,2,"div",145),i(12,"div",146)(13,"button",147),p("click",function(){m(e);let t=s();return u(t.decrementModalQty())}),i(14,"span",4),o(15,"remove"),r()(),i(16,"input",148),k("ngModelChange",function(t){m(e);let a=s();return O(a.quantityModalValue,t)||(a.quantityModalValue=t),u(t)}),r(),i(17,"button",147),p("click",function(){m(e);let t=s();return u(t.incrementModalQty())}),i(18,"span",4),o(19,"add"),r()()(),i(20,"div",149),v(21,ot,2,4,"button",150),i(22,"button",151),p("click",function(){m(e);let t=s();return u(t.setQuickQuantity(t.quantityModalMax))}),o(23," MAX "),r()(),v(24,at,4,1,"p",152),r(),i(25,"div",133)(26,"button",134),p("click",function(){m(e);let t=s();return u(t.closeQuantityModal())}),o(27,"Cancel"),r(),i(28,"button",135),p("click",function(){m(e);let t=s();return u(t.applyQuantity())}),o(29,"Apply"),r()()()()}if(c&2){let e=s();l(11),d("ngIf",e.cart[e.quantityModalIndex]),l(2),d("disabled",e.quantityModalValue<=1),l(3),S("ngModel",e.quantityModalValue),d("max",e.quantityModalMax),l(),d("disabled",e.quantityModalValue>=e.quantityModalMax),l(4),d("ngForOf",Y(9,be)),l(),T("active",e.quantityModalValue===e.quantityModalMax),l(2),d("ngIf",e.quantityModalValue>e.quantityModalMax)}}function lt(c,g){c&1&&(i(0,"span",4),o(1,"bluetooth_connected"),r())}function st(c,g){c&1&&(i(0,"span",4),o(1,"bluetooth_searching"),r())}function dt(c,g){c&1&&(i(0,"span",4),o(1,"bluetooth_disabled"),r())}function pt(c,g){c&1&&(i(0,"p",167),o(1,"Connected"),r())}function mt(c,g){c&1&&(i(0,"p",167),o(1,"Connecting..."),r())}function ut(c,g){c&1&&(i(0,"p",167),o(1,"Not Connected"),r())}function gt(c,g){if(c&1&&(i(0,"p",168),o(1),P(2,"async"),r()),c&2){let e=s(2);l(),C(w(2,1,e.printerName$))}}function _t(c,g){if(c&1){let e=b();i(0,"div",169)(1,"button",170),p("click",function(){m(e);let t=s(2);return u(t.connectPrinter())}),i(2,"span",4),o(3,"bluetooth"),r(),o(4," Connect Printer "),r(),i(5,"p",171),o(6,"Make sure your Bluetooth printer is turned on and in pairing mode."),r()()}}function vt(c,g){if(c&1){let e=b();i(0,"div",169)(1,"button",172),p("click",function(){m(e);let t=s(2);return u(t.printTestPage())}),i(2,"span",4),o(3,"receipt_long"),r(),o(4," Print Test Page "),r(),i(5,"button",172),p("click",function(){m(e);let t=s(2);return u(t.printReceipt())}),i(6,"span",4),o(7,"print"),r(),o(8," Reprint Last Receipt "),r(),i(9,"button",173),p("click",function(){m(e);let t=s(2);return u(t.disconnectPrinter())}),i(10,"span",4),o(11,"bluetooth_disabled"),r(),o(12," Disconnect "),r()()}if(c&2){let e=s(2);l(),d("disabled",e.isPrinting),l(4),d("disabled",e.isPrinting||!e.lastReceiptData)}}function ft(c,g){if(c&1){let e=b();i(0,"div",174)(1,"button",175),p("click",function(){m(e);let t=s(2);return u(t.forgetPrinter())}),i(2,"span",4),o(3,"delete_outline"),r(),o(4," Forget This Printer "),r()()}}function ht(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closePrintModal())}),i(1,"div",158),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h4")(4,"span",4),o(5,"print"),r(),o(6," Bluetooth Printer "),r(),i(7,"button",159),p("click",function(){m(e);let t=s();return u(t.closePrintModal())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",128)(11,"div",160),P(12,"async"),P(13,"async"),i(14,"div",161),v(15,lt,2,0,"span",70),P(16,"async"),v(17,st,2,0,"span",70),P(18,"async"),v(19,dt,2,0,"span",70),P(20,"async"),r(),i(21,"div",162),v(22,pt,2,0,"p",163),P(23,"async"),v(24,mt,2,0,"p",163),P(25,"async"),v(26,ut,2,0,"p",163),P(27,"async"),v(28,gt,3,3,"p",164),P(29,"async"),r()(),v(30,_t,7,0,"div",165),P(31,"async"),v(32,vt,13,2,"div",165),P(33,"async"),v(34,ft,5,0,"div",166),P(35,"async"),r()()()}if(c&2){let e=s();l(11),T("connected",w(12,14,e.printerStatus$)==="connected")("connecting",w(13,16,e.printerStatus$)==="connecting"),l(4),d("ngIf",w(16,18,e.printerStatus$)==="connected"),l(2),d("ngIf",w(18,20,e.printerStatus$)==="connecting"),l(2),d("ngIf",w(20,22,e.printerStatus$)==="disconnected"),l(3),d("ngIf",w(23,24,e.printerStatus$)==="connected"),l(2),d("ngIf",w(25,26,e.printerStatus$)==="connecting"),l(2),d("ngIf",w(27,28,e.printerStatus$)==="disconnected"),l(2),d("ngIf",w(29,30,e.printerName$)),l(2),d("ngIf",w(31,32,e.printerStatus$)==="disconnected"),l(2),d("ngIf",w(33,34,e.printerStatus$)==="connected"),l(2),d("ngIf",w(35,36,e.printerName$))}}function xt(c,g){if(c&1&&(i(0,"p",197),o(1),r()),c&2){let e=s(3);l(),C(e.lastReceiptData.storeAddress)}}function Ct(c,g){if(c&1&&(i(0,"p",198),o(1),r()),c&2){let e=s(3);l(),x("Tel: ",e.lastReceiptData.storePhone,"")}}function yt(c,g){if(c&1&&(i(0,"p")(1,"strong"),o(2,"Customer:"),r(),o(3),r()),c&2){let e=s(3);l(3),x(" ",e.lastReceiptData.customerName,"")}}function bt(c,g){if(c&1&&(i(0,"p")(1,"strong"),o(2,"Delivery:"),r(),o(3),P(4,"date"),r()),c&2){let e=s(3);l(3),x(" ",q(4,1,e.lastReceiptData.deliveryDate,"short"),"")}}function Pt(c,g){if(c&1&&(i(0,"span"),o(1),r()),c&2){let e=s(2).$implicit;l(),x("Discount: ",e.discount,"%")}}function Mt(c,g){if(c&1&&(i(0,"span"),o(1),r()),c&2){let e=s(2).$implicit,n=s(3);l(),x("Discount: -",n.formatCurrency(e.discount),"")}}function wt(c,g){if(c&1&&(i(0,"div",203),v(1,Pt,2,1,"span",188)(2,Mt,2,1,"span",188),r()),c&2){let e=s().$implicit;l(),d("ngIf",e.discountType==="percent"),l(),d("ngIf",e.discountType==="amount")}}function St(c,g){if(c&1&&(i(0,"div",199)(1,"div",200),o(2),r(),i(3,"div",201)(4,"span"),o(5),r(),i(6,"span"),o(7),r()(),v(8,wt,3,2,"div",202),r()),c&2){let e=g.$implicit,n=s(3);l(2),C(e.name),l(3),R("",e.quantity," x ",n.formatCurrency(e.price),""),l(2),C(n.formatCurrency(e.total)),l(),d("ngIf",e.discount&&e.discount>0)}}function Ot(c,g){if(c&1&&(i(0,"div",194)(1,"span"),o(2,"Total Discount"),r(),i(3,"span"),o(4),r()()),c&2){let e=s(3);l(4),x("-",e.formatCurrency(e.lastReceiptData.totalDiscount),"")}}function kt(c,g){if(c&1&&(i(0,"div",204)(1,"div",186),o(2,"--------------------------------"),r(),i(3,"p")(4,"strong"),o(5,"Notes:"),r(),o(6),r()()),c&2){let e=s(3);l(6),x(" ",e.lastReceiptData.notes,"")}}function Tt(c,g){if(c&1&&(i(0,"div",181)(1,"div",182)(2,"h2",183),o(3),r(),v(4,xt,2,1,"p",184)(5,Ct,2,1,"p",185),r(),i(6,"div",186),o(7,"================================"),r(),i(8,"div",187)(9,"p")(10,"strong"),o(11,"Order:"),r(),o(12),r(),i(13,"p")(14,"strong"),o(15,"Date:"),r(),o(16),P(17,"date"),r(),v(18,yt,4,1,"p",188)(19,bt,5,4,"p",188),r(),i(20,"div",186),o(21,"--------------------------------"),r(),i(22,"div",189),v(23,St,9,5,"div",190),r(),i(24,"div",186),o(25,"--------------------------------"),r(),i(26,"div",191),v(27,Ot,5,1,"div",192),i(28,"div",193)(29,"span"),o(30,"TOTAL"),r(),i(31,"span"),o(32),r()(),i(33,"div",194)(34,"span"),o(35,"Cash"),r(),i(36,"span"),o(37),r()(),i(38,"div",194)(39,"span"),o(40,"Change"),r(),i(41,"span"),o(42),r()()(),v(43,kt,7,1,"div",195),i(44,"div",186),o(45,"================================"),r(),i(46,"div",196)(47,"p"),o(48,"Thank you for your purchase!"),r(),i(49,"p"),o(50,"Please come again"),r()()()),c&2){let e=s(2);l(3),C(e.lastReceiptData.storeName),l(),d("ngIf",e.lastReceiptData.storeAddress),l(),d("ngIf",e.lastReceiptData.storePhone),l(7),x(" ",e.lastReceiptData.orderId,""),l(4),x(" ",q(17,13,e.lastReceiptData.date,"short"),""),l(2),d("ngIf",e.lastReceiptData.customerName),l(),d("ngIf",e.lastReceiptData.deliveryDate),l(4),d("ngForOf",e.lastReceiptData.items),l(4),d("ngIf",e.lastReceiptData.totalDiscount>0),l(5),C(e.formatCurrency(e.lastReceiptData.total)),l(5),C(e.formatCurrency(e.lastReceiptData.cashReceived)),l(5),C(e.formatCurrency(e.lastReceiptData.change)),l(),d("ngIf",e.lastReceiptData.notes)}}function Et(c,g){if(c&1){let e=b();i(0,"div",124),p("click",function(){m(e);let t=s();return u(t.closeReceiptPreview())}),i(1,"div",176),p("click",function(t){return m(e),u(t.stopPropagation())}),i(2,"div",126)(3,"h4")(4,"span",4),o(5,"receipt_long"),r(),o(6," Receipt Preview "),r(),i(7,"button",159),p("click",function(){m(e);let t=s();return u(t.closeReceiptPreview())}),i(8,"span",4),o(9,"close"),r()()(),i(10,"div",177),v(11,Tt,51,16,"div",178),r(),i(12,"div",179)(13,"button",134),p("click",function(){m(e);let t=s();return u(t.closeReceiptPreview())}),o(14,"Close"),r(),i(15,"button",180),p("click",function(){m(e);let t=s();return u(t.printFromPreview())}),i(16,"span",4),o(17,"print"),r(),o(18),P(19,"async"),r()()()()}if(c&2){let e=s();l(11),d("ngIf",e.lastReceiptData),l(4),d("disabled",e.isPrinting),l(3),x(" ",w(19,3,e.printerStatus$)==="connected"?"Print Receipt":"Connect & Print"," ")}}var Ut=(()=>{class c{togglePending(){this.isPendingCollapsed=!this.isPendingCollapsed}onCashInput(e){this.cashDisplayValue=e;let n=e.replace(/[^0-9.]/g,"");this.cashReceived=parseFloat(n),isNaN(this.cashReceived)&&(this.cashReceived=0)}formatCashOnBlur(){this.cashReceived!==0?this.cashDisplayValue=this.cashReceived.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):this.cashDisplayValue=""}unformatCashOnFocus(){this.cashReceived!==0?this.cashDisplayValue=this.cashReceived.toString():this.cashDisplayValue=""}constructor(e,n,t,a,_,f){this.inventoryService=e,this.customerService=n,this.dialogService=t,this.printService=a,this.storeService=_,this.router=f,this.allProducts=this.inventoryService.products,this.customers=this.customerService.customers,this.sales=this.inventoryService.sales,this.categoriesSignal=this.inventoryService.categories,this.stores=this.storeService.stores,this.products=F(()=>this.allProducts().filter(I=>I.quantity>0)),this.pendingSales=F(()=>this.sales().filter(I=>I.pending===!0)),this.allGroupedSales=[],this.isPendingCollapsed=!1,this.categories=F(()=>this.categoriesSignal().map(I=>I.name).sort()),this.categoryFilter="",this.isPendingPanelOpen=!1,this.isDeliveryModalOpen=!1,this.isDiscountModalOpen=!1,this.isNotesModalOpen=!1,this.orderNumber=1e3+Math.floor(Math.random()*9e3),this.currentDate=new Date,this.currentTime=new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),this.tempDiscount=0,this.tempDiscountType="amount",this.initialPendingOpen=!1,this.subscriptions=new B,this.selectedProductId="",this.selectedCustomerId="",this.quantity=1,this.cashReceived=0,this.discount=0,this.discountType="amount",this.errorMessage="",this.cart=[],this.deliveryDate="",this.deliveryTime="",this.deliveryNotes="",this.minDate="",this.deliveryFilterDate="",this.statusFilter="all",this.isEditModalOpen=!1,this.editingSale=null,this.editDeliveryDate="",this.editDeliveryTime="",this.editDeliveryNotes="",this.isQuantityModalOpen=!1,this.quantityModalIndex=-1,this.quantityModalValue=1,this.quantityModalMax=1,this.pendingPage=1,this.pendingPageSize=5,this.pendingPageSizeOptions=[5,10,20,50],this.alarmInterval=null,this.checkInterval=null,this.audioCtx=null,this.audioUnlocked=!1,this.printerStatus$=this.printService.connectionStatus$,this.printerName$=this.printService.deviceName$,this.isPrintModalOpen=!1,this.isPrinting=!1,this.lastReceiptData=null,this.isReceiptPreviewOpen=!1,this.activeStore=null,this.cashDisplayValue="";let h=new Date,M=h.getFullYear(),y=String(h.getMonth()+1).padStart(2,"0"),E=String(h.getDate()).padStart(2,"0");this.minDate=`${M}-${y}-${E}`,this.deliveryDate=this.minDate,this.deliveryTime="10:00",X(()=>{this.sales()&&(this.updateGroupedSales(),this.checkInterval||this.startAlarmChecks())})}ngOnInit(){let e=history.state;(this.initialPendingOpen||e&&e.initialPendingOpen)&&(this.isPendingPanelOpen=!0),this.customerService.loadCustomers();let n=this.storeService.getActiveStoreId();n&&(this.activeStore=this.stores().find(t=>t.id===n)),this.discount=0}ngOnDestroy(){this.subscriptions.unsubscribe(),this.stopAlarm(),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.audioCtx&&this.audioCtx.close().catch(()=>{})}onUserInteraction(){this.unlockAudioContext()}unlockAudioContext(){if(this.audioUnlocked)return;this.audioCtx||(this.audioCtx=new(window.AudioContext||window.webkitAudioContext));let e=this.audioCtx;if(e){e.state==="suspended"&&e.resume().catch(()=>{});try{let n=e.createBuffer(1,1,22050),t=e.createBufferSource();t.buffer=n,t.connect(e.destination),t.start(0),this.audioUnlocked=!0}catch{}}}startAlarmChecks(){this.checkInterval=setInterval(()=>this.checkPendingDeliveryAlarms(),60*60*1e3),this.checkPendingDeliveryAlarms()}get filteredPendingSales(){let e=this.pendingSales();return this.statusFilter==="reservation"&&(e=e.filter(n=>n.reservationStatus==="pending_confirmation")),this.deliveryFilterDate&&(e=e.filter(n=>{if(!n.deliveryDate)return!1;let t=new Date(n.deliveryDate),a=t.getFullYear(),_=String(t.getMonth()+1).padStart(2,"0"),f=String(t.getDate()).padStart(2,"0");return`${a}-${_}-${f}`===this.deliveryFilterDate})),e.slice().sort((n,t)=>{let a=n.reservationStatus==="pending_confirmation",_=t.reservationStatus==="pending_confirmation";if(a&&!_)return-1;if(!a&&_)return 1;let f=n.deliveryDate?new Date(n.deliveryDate).getTime():1/0,h=t.deliveryDate?new Date(t.deliveryDate).getTime():1/0;return f-h})}checkPendingDeliveryAlarms(){let e=new Date,n=[];this.pendingSales().forEach(t=>{if(!t.deliveryDate)return;let _=new Date(t.deliveryDate).getTime()-e.getTime(),f=Math.floor(_/(1e3*60*60*24));(f===1||f===2||f<0)&&n.push({sale:t,days:f})}),n.length>0&&this.triggerBatchAlarm(n)}triggerBatchAlarm(e){if(this.alarmInterval)return;let n="";if(e.length===1){let t=e[0],_=new Date(t.sale.deliveryDate).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"});t.days<0?n=`\u26A0\uFE0F OVERDUE: Delivery for "${t.sale.productName}" was due on ${_}.`:t.days===0?n=`\u26A0\uFE0F TODAY: Delivery for "${t.sale.productName}" is due today!`:n=`\u26A0\uFE0F UPCOMING: Delivery for "${t.sale.productName}" is due in ${t.days} day(s) (${_}).`}else n=`\u26A0\uFE0F There are ${e.length} deliveries due soon or overdue. Please check the Pending Deliveries list.`;this.playLoopingAlarm(),this.dialogService.alert(n,"Delivery Reminder","warning").subscribe(()=>{this.stopAlarm()})}playLoopingAlarm(){this.stopAlarm(),this.playBeep(),this.alarmInterval=setInterval(()=>{this.playBeep()},2e3)}stopAlarm(){this.alarmInterval&&(clearInterval(this.alarmInterval),this.alarmInterval=null)}playBeep(){try{this.audioCtx||(this.audioCtx=new(window.AudioContext||window.webkitAudioContext));let e=this.audioCtx;if(e.state==="suspended")return;let n=e.createOscillator(),t=e.createOscillator(),a=e.createGain();n.type="sine",t.type="sine",n.frequency.setValueAtTime(523.25,e.currentTime),t.frequency.setValueAtTime(659.25,e.currentTime),n.connect(a),t.connect(a),a.connect(e.destination),a.gain.setValueAtTime(0,e.currentTime),a.gain.linearRampToValueAtTime(.15,e.currentTime+.05),a.gain.linearRampToValueAtTime(.15,e.currentTime+.4),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.8),n.start(e.currentTime),t.start(e.currentTime),n.stop(e.currentTime+.8),t.stop(e.currentTime+.8)}catch(e){console.error("Audio alarm failed",e)}}get selectedProduct(){return this.products().find(e=>e.id===this.selectedProductId)}get selectedCustomer(){return this.customers().find(e=>e.id===this.selectedCustomerId)}getCustomerById(e){if(e)return this.customers().find(n=>n.id===e)}get maxQuantity(){return this.selectedProduct?.quantity||0}onProductChange(){this.quantity=1,this.errorMessage="",this.discount=0}addToCart(){if(this.errorMessage="",!this.selectedProduct){this.errorMessage="Please select a product";return}if(this.quantity<1||this.quantity>this.maxQuantity){this.errorMessage=`Quantity must be between 1 and ${this.maxQuantity}`;return}let e=this.cart.filter(t=>t.product.id===this.selectedProduct.id).reduce((t,a)=>t+a.quantity,0);if(e+this.quantity>this.maxQuantity){this.errorMessage=`Cannot add more. Total in cart (${e}) + new (${this.quantity}) exceeds stock (${this.maxQuantity})`;return}let n=this.selectedProduct.price*this.quantity;this.discount>0&&(this.discountType==="percent"?n=n-n*(this.discount/100):n=n-this.discount),n=Math.max(0,Math.round(n*100)/100),this.cart.push({product:this.selectedProduct,quantity:this.quantity,discount:this.discount,discountType:this.discountType,total:n}),this.quantity=1,this.discount=0,this.discountType="amount",this.selectedProductId=""}removeFromCart(e){this.cart.splice(e,1)}get total(){return this.cart.reduce((e,n)=>e+n.total,0)}get change(){return this.cashReceived-this.total}isValid(){return this.cart.length>0&&this.cashReceived>=this.total}updateGroupedSales(){let e=new Map,n=[];this.filteredPendingSales.forEach(a=>{a.orderId?(e.has(a.orderId)||e.set(a.orderId,[]),e.get(a.orderId).push(a)):n.push(a)});let t=[];e.forEach((a,_)=>{let f=a[0];t.push({isGroup:!0,orderId:_,sales:a,total:a.reduce((h,M)=>h+M.total,0),customerName:this.getCustomerById(f.customerId)?.name||"Walk-in",customer:this.getCustomerById(f.customerId),deliveryDate:f.deliveryDate,timestamp:f.timestamp,status:f.reservationStatus,productNames:a.map(h=>h.productName).join(", "),deliveryNotes:f.deliveryNotes,quantityTotal:a.reduce((h,M)=>h+M.quantitySold,0),discount:f.discount,discountType:f.discountType,cashReceived:f.cashReceived,change:f.change})}),n.forEach(a=>{t.push({isGroup:!1,id:a.id,sales:[a],total:a.total,customerName:this.getCustomerById(a.customerId)?.name||"Walk-in",customer:this.getCustomerById(a.customerId),deliveryDate:a.deliveryDate,timestamp:a.timestamp,status:a.reservationStatus,productNames:a.productName,deliveryNotes:a.deliveryNotes,quantityTotal:a.quantitySold,discount:a.discount,discountType:a.discountType,cashReceived:a.cashReceived,change:a.change})}),this.allGroupedSales=t.sort((a,_)=>{let f=a.status==="pending_confirmation",h=_.status==="pending_confirmation";if(f&&!h)return-1;if(!f&&h)return 1;let M=a.deliveryDate?new Date(a.deliveryDate).getTime():1/0,y=_.deliveryDate?new Date(_.deliveryDate).getTime():1/0;return M-y}),this.pendingPage>this.pendingTotalPages&&this.pendingPage>1&&(this.pendingPage=1)}get paginatedGroupedPendingSales(){let e=(this.pendingPage-1)*this.pendingPageSize;return this.allGroupedSales.slice(e,e+this.pendingPageSize)}get pendingTotalPages(){return Math.ceil(this.allGroupedSales.length/this.pendingPageSize)}nextPendingPage(){this.pendingPage<this.pendingTotalPages&&this.pendingPage++}prevPendingPage(){this.pendingPage>1&&this.pendingPage--}goToPendingPage(e){this.pendingPage=e}getPendingPageNumbers(){return Array(this.pendingTotalPages).fill(0).map((e,n)=>n+1)}clearFilter(){this.deliveryFilterDate="",this.statusFilter="all",this.pendingPage=1,this.updateGroupedSales()}checkout(){if(this.errorMessage="",this.cart.length===0){this.errorMessage="Cart is empty";return}if(this.cashReceived<this.total){this.errorMessage="Insufficient cash received";return}let e=this.cashReceived-this.total,n="ORD-"+Date.now()+"-"+Math.floor(Math.random()*1e3),t=[...this.cart],a=this.cashReceived,_=this.total,f=this.selectedCustomer?.name,h;this.deliveryDate&&(this.deliveryTime?h=new Date(`${this.deliveryDate}T${this.deliveryTime}`):h=new Date(this.deliveryDate));let M=this.cart.map((y,E)=>{let I=y.total;return E===0&&(I+=e),this.inventoryService.recordSale(y.product.id,y.quantity,I,h,this.deliveryNotes||void 0,this.selectedCustomerId||void 0,y.discount,y.discountType,n)});L(M).subscribe({next:()=>{this.lastReceiptData={storeName:this.activeStore?.name||"JJM Inventory",storeAddress:this.activeStore?.address||"",storePhone:this.activeStore?.phoneNumber||"",orderId:n,date:new Date,items:t.map(y=>({name:y.product.name,quantity:y.quantity,price:y.product.price,discount:y.discount,discountType:y.discountType,total:y.total})),subtotal:_,totalDiscount:t.reduce((y,E)=>E.discountType==="percent"?y+E.product.price*E.quantity*E.discount/100:y+E.discount,0),total:_,cashReceived:a,change:e,customerName:f,deliveryDate:h,notes:this.deliveryNotes},this.isReceiptPreviewOpen=!0,this.cart=[],this.cashReceived=0,this.cashDisplayValue="",this.deliveryDate=this.minDate,this.deliveryTime="",this.deliveryNotes="",this.selectedCustomerId="",this.errorMessage="",this.dialogService.success("Sale completed successfully!","Checkout Complete")},error:y=>{this.errorMessage=y.message||"Error processing sales"}})}connectPrinter(){return D(this,null,function*(){try{yield this.printService.connectPrinter(),this.dialogService.success("Printer connected successfully!","Bluetooth Printer")}catch(e){this.dialogService.error(e.message||"Failed to connect to printer","Connection Error")}})}disconnectPrinter(){this.printService.disconnectPrinter()}forgetPrinter(){this.printService.forgetPrinter()}printReceipt(){return D(this,null,function*(){if(!this.lastReceiptData){this.dialogService.warning("No receipt data available","Print Error");return}if(!this.printService.isConnected()){this.dialogService.warning("Printer not connected. Please connect a Bluetooth printer first.","Printer Not Connected");return}this.isPrinting=!0;try{yield this.printService.printReceipt(this.lastReceiptData),this.dialogService.success("Receipt printed successfully!","Print Complete")}catch(e){this.dialogService.error(e.message||"Failed to print receipt","Print Error")}finally{this.isPrinting=!1}})}printTestPage(){return D(this,null,function*(){if(!this.printService.isConnected()){this.dialogService.warning("Printer not connected","Print Error");return}this.isPrinting=!0;try{yield this.printService.printTestPage(),this.dialogService.success("Test page printed!","Print Complete")}catch(e){this.dialogService.error(e.message||"Failed to print test page","Print Error")}finally{this.isPrinting=!1}})}openPrintModal(){this.isPrintModalOpen=!0}closePrintModal(){this.isPrintModalOpen=!1}closeReceiptPreview(){this.isReceiptPreviewOpen=!1}openReceiptPreview(){if(this.cart.length>0){let e=this.selectedCustomer?.name,n;this.deliveryDate&&(this.deliveryTime?n=new Date(`${this.deliveryDate}T${this.deliveryTime}`):n=new Date(this.deliveryDate)),this.lastReceiptData={storeName:this.activeStore?.name||"JJM Inventory",storeAddress:this.activeStore?.address||"",storePhone:this.activeStore?.phoneNumber||"",orderId:"(Preview)",date:new Date,items:this.cart.map(t=>({name:t.product.name,quantity:t.quantity,price:t.product.price,discount:t.discount,discountType:t.discountType,total:t.total})),subtotal:this.total,totalDiscount:this.cart.reduce((t,a)=>a.discountType==="percent"?t+a.product.price*a.quantity*a.discount/100:t+a.discount,0),total:this.total,cashReceived:this.cashReceived||0,change:Math.max(0,(this.cashReceived||0)-this.total),customerName:e,deliveryDate:n,notes:this.deliveryNotes},this.isReceiptPreviewOpen=!0}else this.lastReceiptData?this.isReceiptPreviewOpen=!0:this.dialogService.info("Add items to cart to preview the receipt.","Cart Empty")}printFromPreview(){return D(this,null,function*(){if(!this.printService.isConnected()){this.isReceiptPreviewOpen=!1,this.isPrintModalOpen=!0,this.dialogService.warning("Please connect a Bluetooth printer first.","Printer Not Connected");return}yield this.printReceipt(),this.isReceiptPreviewOpen=!1})}reprintOrderReceipt(e){if(!e||!e.sales||e.sales.length===0){this.dialogService.warning("No order data available","Reprint Error");return}this.lastReceiptData={storeName:this.activeStore?.name||"JJM Inventory",storeAddress:this.activeStore?.address||"",storePhone:this.activeStore?.phoneNumber||"",orderId:e.orderId||e.sales[0]?.id||"N/A",date:e.timestamp||new Date,items:e.sales.map(n=>({name:n.productName,quantity:n.quantitySold,price:n.price,discount:n.discount||0,discountType:n.discountType||"amount",total:n.total})),subtotal:e.total,totalDiscount:e.discount||0,total:e.total,cashReceived:e.cashReceived||0,change:e.change||0,customerName:e.customer?.name,deliveryDate:e.deliveryDate,notes:e.deliveryNotes},this.isReceiptPreviewOpen=!0}markAsDelivered(e){this.dialogService.confirm("Are you sure you want to mark this item as delivered?","Mark as Delivered").subscribe(n=>{n&&this.inventoryService.completePendingSale(e)})}confirmReservation(e){this.dialogService.confirm("Confirming this reservation will deduct items from inventory. Continue?","Confirm Reservation").subscribe(n=>{n&&this.inventoryService.confirmReservation(e)})}deleteReservation(e){this.dialogService.confirm("Are you sure you want to remove this reservation?","Remove Reservation").subscribe(n=>{n&&this.inventoryService.deleteSale(e.id)})}openEditModal(e){if(e){if(this.editingSale=e,this.isEditModalOpen=!0,e.deliveryDate){let n=new Date(e.deliveryDate),t=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),_=String(n.getDate()).padStart(2,"0");this.editDeliveryDate=`${t}-${a}-${_}`,this.editDeliveryTime=n.toTimeString().substring(0,5)}else this.editDeliveryDate="",this.editDeliveryTime="";this.editDeliveryNotes=e.deliveryNotes||""}}closeEditModal(){this.isEditModalOpen=!1,this.editingSale=null,this.editDeliveryDate="",this.editDeliveryTime="",this.editDeliveryNotes=""}saveEdit(){if(!this.editingSale)return;let e;this.editDeliveryDate&&(this.editDeliveryTime?e=new Date(`${this.editDeliveryDate}T${this.editDeliveryTime}`):e=new Date(this.editDeliveryDate));let n=this.editingSale.orderId;if(n)this.pendingSales().filter(a=>a.orderId===n).forEach(a=>{let _=$(z({},a),{deliveryDate:e,deliveryNotes:this.editDeliveryNotes});this.inventoryService.updateSale(_)});else{let t=$(z({},this.editingSale),{deliveryDate:e,deliveryNotes:this.editDeliveryNotes});this.inventoryService.updateSale(t)}this.closeEditModal()}markGroupAsDelivered(e){!e||e.length===0||this.dialogService.confirm(`Mark ${e.length} items as delivered? This will deduct stock and complete the order.`,"Mark Group as Delivered").subscribe(n=>{n&&e.forEach(t=>this.inventoryService.completePendingSale(t.id))})}confirmGroupReservation(e){!e||e.length===0||this.dialogService.confirm(`Confirm reservation for ${e.length} items? This will deduct stock upon delivery.`,"Confirm Group Reservation").subscribe(n=>{n&&e.forEach(t=>this.inventoryService.confirmReservation(t))})}cancelGroupOrder(e){!e||e.length===0||this.dialogService.confirm(`Cancel order for ${e.length} items? This cannot be undone.`,"Cancel Order").subscribe(n=>{n&&e.forEach(t=>this.inventoryService.deleteSale(t.id))})}get filteredProducts(){return this.categoryFilter?this.products().filter(e=>e.category===this.categoryFilter):this.products()}getCategoryIcon(e){return{Lechon:"restaurant","Hollow blocks":"construction","Sand and Gravel":"landscape",Copra:"eco",Electronics:"devices",Furniture:"chair","Hot Drinks":"local_cafe","Cold Drinks":"ac_unit",Pastries:"bakery_dining",Others:"category"}[e]||"category"}isInCart(e){return this.cart.some(n=>n.product.id===e)}getCartQuantity(e){return this.cart.filter(n=>n.product.id===e).reduce((n,t)=>n+t.quantity,0)}addProductToCart(e){this.errorMessage="";let n=this.cart.findIndex(a=>a.product.id===e.id);if(n>=0){let a=this.cart[n];a.quantity<e.quantity?(a.quantity++,a.total=this.calculateItemTotal(a)):this.errorMessage=`Cannot add more. Already at max stock (${e.quantity})`;return}let t={product:e,quantity:1,discount:0,discountType:"amount",total:e.price};this.cart.push(t)}calculateItemTotal(e){let n=e.product.price*e.quantity;return e.discount>0&&(e.discountType==="percent"?n=n-n*(e.discount/100):n=n-e.discount),Math.max(0,Math.round(n*100)/100)}incrementItem(e){let n=this.cart[e];n&&n.quantity<n.product.quantity&&(n.quantity++,n.total=this.calculateItemTotal(n))}decrementItem(e){let n=this.cart[e];n&&(n.quantity>1?(n.quantity--,n.total=this.calculateItemTotal(n)):this.removeFromCart(e))}clearCart(){this.cart=[],this.cashReceived=0,this.cashDisplayValue="",this.errorMessage=""}formatCurrency(e){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}togglePendingPanel(){this.isPendingPanelOpen=!this.isPendingPanelOpen,this.isPendingPanelOpen&&this.updateGroupedSales()}closePendingPanel(){this.isPendingPanelOpen=!1}openDeliveryModal(){this.isDeliveryModalOpen=!0}closeDeliveryModal(){this.isDeliveryModalOpen=!1}openDiscountModal(){this.tempDiscount=0,this.tempDiscountType="amount",this.isDiscountModalOpen=!0}closeDiscountModal(){this.isDiscountModalOpen=!1}applyDiscount(){if(this.cart.length>0&&this.tempDiscount>0){let e=this.tempDiscount/this.cart.length;this.cart.forEach(n=>{n.discount=e,n.discountType=this.tempDiscountType,n.total=this.calculateItemTotal(n)})}this.closeDiscountModal()}openNotesModal(){this.isNotesModalOpen=!0}closeNotesModal(){this.isNotesModalOpen=!1}clearDelivery(){this.deliveryDate="",this.deliveryTime="",this.deliveryNotes=""}openQuantityModal(e){let n=this.cart[e];n&&(this.quantityModalIndex=e,this.quantityModalValue=n.quantity,this.quantityModalMax=n.product.quantity,this.isQuantityModalOpen=!0)}closeQuantityModal(){this.isQuantityModalOpen=!1,this.quantityModalIndex=-1}applyQuantity(){if(this.quantityModalIndex<0)return;let e=this.cart[this.quantityModalIndex];if(!e)return;let n=Math.floor(this.quantityModalValue);isNaN(n)||n<1?n=1:n>this.quantityModalMax&&(n=this.quantityModalMax),e.quantity=n,e.total=this.calculateItemTotal(e),this.closeQuantityModal()}incrementModalQty(){this.quantityModalValue<this.quantityModalMax&&this.quantityModalValue++}decrementModalQty(){this.quantityModalValue>1&&this.quantityModalValue--}setQuickQuantity(e){e<=this.quantityModalMax?this.quantityModalValue=e:this.quantityModalValue=this.quantityModalMax}static{this.\u0275fac=function(n){return new(n||c)(V(he),V(fe),V(ve),V(xe),V(_e),V(re))}}static{this.\u0275cmp=G({type:c,selectors:[["app-pos-calculator"]],hostBindings:function(n,t){n&1&&p("click",function(){return t.onUserInteraction()},!1,N)("touchstart",function(){return t.onUserInteraction()},!1,N)("keydown",function(){return t.onUserInteraction()},!1,N)},inputs:{initialPendingOpen:"initialPendingOpen"},standalone:!0,features:[H],decls:109,vars:45,consts:[[1,"pos-container"],[1,"products-panel"],[1,"category-rail"],[1,"category-btn",3,"click"],[1,"material-icon"],[1,"category-label"],["class","category-btn",3,"active","click",4,"ngFor","ngForOf"],[1,"product-grid-wrapper"],[1,"product-grid"],["class","product-card",3,"in-cart","click",4,"ngFor","ngForOf"],["class","empty-products",4,"ngIf"],[1,"cart-panel"],[1,"cart-header"],[1,"order-info"],[1,"order-title"],[1,"order-meta"],["class","clear-btn",3,"click",4,"ngIf"],[1,"customer-select-wrapper"],[1,"customer-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"cart-items"],["class","cart-item",4,"ngFor","ngForOf"],["class","empty-cart",4,"ngIf"],[1,"cart-footer"],[1,"quick-actions"],[1,"action-btn",3,"click"],[1,"action-label"],[1,"printer-status-dot"],["class","pending-badge",4,"ngIf"],["class","delivery-summary",4,"ngIf"],[1,"order-summary"],[1,"summary-row"],[1,"summary-row","total-row"],[1,"total-amount"],["class","payment-section",4,"ngIf"],[1,"main-actions"],[1,"charge-btn",3,"click","disabled"],["class","error-banner",4,"ngIf"],[1,"pending-overlay",3,"click"],[1,"pending-panel",3,"click"],[1,"pending-header"],[1,"close-pending-btn",3,"click"],[1,"pending-filters"],["type","date","placeholder","Filter by date",1,"filter-input",3,"ngModelChange","ngModel"],[1,"filter-select",3,"ngModelChange","ngModel"],["value","all"],["value","reservation"],["class","clear-filter-btn",3,"click",4,"ngIf"],[1,"pending-list"],["class","pending-order-card",3,"reservation",4,"ngFor","ngForOf"],["class","empty-pending",4,"ngIf"],["class","pending-pagination",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"product-card",3,"click"],[1,"product-image"],["class","material-icon no-image",4,"ngIf"],["class","cart-indicator",4,"ngIf"],[1,"product-info"],[1,"product-name"],[1,"product-meta"],[1,"product-price"],[1,"product-stock"],[1,"material-icon","no-image"],[1,"cart-indicator"],[1,"empty-products"],[1,"clear-btn",3,"click"],[3,"value"],[1,"cart-item"],[1,"cart-item-image"],["class","material-icon",4,"ngIf"],[1,"cart-item-details"],[1,"cart-item-row"],[1,"cart-item-name"],[1,"cart-item-total"],["class","cart-item-price",4,"ngIf"],["class","cart-item-price discount-applied",4,"ngIf"],[1,"qty-controls"],[1,"qty-btn",3,"click"],["title","Click to enter quantity",1,"qty-value-btn",3,"click"],[1,"qty-btn",3,"click","disabled"],["title","Remove",1,"remove-item-btn",3,"click"],[1,"cart-item-price"],[1,"cart-item-price","discount-applied"],[1,"empty-cart"],[1,"hint"],[1,"pending-badge"],[1,"delivery-summary"],[1,"clear-delivery",3,"click"],[1,"payment-section"],[1,"cash-input-wrapper"],[1,"cash-input-row"],[1,"currency-symbol"],["type","text","placeholder","0.00",1,"cash-input",3,"ngModelChange","blur","focus","ngModel"],[1,"change-display"],[1,"change-amount"],[1,"error-banner"],[1,"clear-filter-btn",3,"click"],[1,"pending-order-card"],[1,"order-card-header"],[1,"order-title-section"],["class","order-id",4,"ngIf"],["class","reservation-badge",4,"ngIf"],[1,"order-total"],["class","order-items-preview",4,"ngIf"],[1,"order-details"],["class","detail-row",4,"ngIf"],[1,"detail-row","payment-row"],[1,"order-actions"],["title","Reprint Receipt",1,"order-action-btn","print",3,"click"],[1,"order-action-btn","edit",3,"click"],["class","order-action-btn confirm",3,"click",4,"ngIf"],["class","order-action-btn deliver",3,"click",4,"ngIf"],[1,"order-action-btn","delete",3,"click"],[1,"order-id"],[1,"reservation-badge"],[1,"order-items-preview"],[4,"ngFor","ngForOf"],[1,"detail-row"],[1,"order-action-btn","confirm",3,"click"],[1,"order-action-btn","deliver",3,"click"],[1,"empty-pending"],[1,"pending-pagination"],[3,"click","disabled"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"form-group"],["type","date",3,"ngModelChange","ngModel","min"],["type","time",3,"ngModelChange","ngModel"],["rows","3","placeholder","Special instructions...",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn-cancel",3,"click"],[1,"btn-save",3,"click"],["rows","3","placeholder","Notes...",3,"ngModelChange","ngModel"],[1,"modal-content","small",3,"click"],[1,"discount-input-row"],["type","number","placeholder","0","min","0",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","amount"],["value","percent"],["rows","4","placeholder","Add notes for this order...",3,"ngModelChange","ngModel"],[1,"modal-content","small","qty-modal",3,"click"],["class","qty-product-info",4,"ngIf"],[1,"qty-input-group"],[1,"qty-modal-btn",3,"click","disabled"],["type","number","min","1",1,"qty-input",3,"ngModelChange","ngModel","max"],[1,"qty-quick-btns"],["class","quick-qty-btn",3,"active","disabled","click",4,"ngFor","ngForOf"],[1,"quick-qty-btn","max-btn",3,"click"],["class","qty-hint",4,"ngIf"],[1,"qty-product-info"],[1,"qty-product-name"],[1,"qty-stock-info"],[1,"quick-qty-btn",3,"click","disabled"],[1,"qty-hint"],[1,"modal-card","printer-modal",3,"click"],[1,"btn-close",3,"click"],[1,"printer-status-card"],[1,"status-icon"],[1,"status-info"],["class","status-label",4,"ngIf"],["class","device-name",4,"ngIf"],["class","printer-actions",4,"ngIf"],["class","printer-footer",4,"ngIf"],[1,"status-label"],[1,"device-name"],[1,"printer-actions"],[1,"btn-connect",3,"click"],[1,"help-text"],[1,"btn-action",3,"click","disabled"],[1,"btn-disconnect",3,"click"],[1,"printer-footer"],[1,"btn-forget",3,"click"],[1,"modal-card","receipt-preview-modal",3,"click"],[1,"modal-body","receipt-preview-body"],["class","receipt-paper",4,"ngIf"],[1,"modal-actions","receipt-actions"],[1,"btn-print",3,"click","disabled"],[1,"receipt-paper"],[1,"receipt-header"],[1,"store-name"],["class","store-address",4,"ngIf"],["class","store-phone",4,"ngIf"],[1,"receipt-divider"],[1,"receipt-order-info"],[4,"ngIf"],[1,"receipt-items"],["class","receipt-item",4,"ngFor","ngForOf"],[1,"receipt-totals"],["class","total-row",4,"ngIf"],[1,"total-row","grand-total"],[1,"total-row"],["class","receipt-notes",4,"ngIf"],[1,"receipt-footer"],[1,"store-address"],[1,"store-phone"],[1,"receipt-item"],[1,"item-name"],[1,"item-detail"],["class","item-discount",4,"ngIf"],[1,"item-discount"],[1,"receipt-notes"]],template:function(n,t){n&1&&(i(0,"div",0)(1,"main",1)(2,"div",2)(3,"button",3),p("click",function(){return t.categoryFilter=""}),i(4,"span",4),o(5,"star"),r(),i(6,"span",5),o(7,"All Items"),r()(),v(8,Pe,5,4,"button",6),r(),i(9,"div",7)(10,"div",8),v(11,Se,12,9,"div",9)(12,Oe,5,0,"div",10),r()()(),i(13,"aside",11)(14,"div",12)(15,"div",13)(16,"h3",14),o(17),r(),i(18,"p",15),o(19),P(20,"date"),r()(),v(21,ke,2,0,"button",16),r(),i(22,"div",17)(23,"select",18),k("ngModelChange",function(_){return O(t.selectedCustomerId,_)||(t.selectedCustomerId=_),_}),i(24,"option",19),o(25,"-- Walk-in Customer --"),r(),v(26,Te,2,2,"option",20),r()(),i(27,"div",21),v(28,Ve,24,9,"div",22)(29,qe,7,0,"div",23),r(),i(30,"div",24)(31,"div",25)(32,"button",26),p("click",function(){return t.openDiscountModal()}),i(33,"span",4),o(34,"percent"),r(),i(35,"span",27),o(36,"Discount"),r()(),i(37,"button",26),p("click",function(){return t.openDeliveryModal()}),i(38,"span",4),o(39,"local_shipping"),r(),i(40,"span",27),o(41,"Delivery"),r()(),i(42,"button",26),p("click",function(){return t.openNotesModal()}),i(43,"span",4),o(44,"edit_note"),r(),i(45,"span",27),o(46,"Notes"),r()(),i(47,"button",26),p("click",function(){return t.openReceiptPreview()}),i(48,"span",4),o(49,"receipt_long"),r(),i(50,"span",27),o(51,"Print View"),r(),Q(52,"span",28),P(53,"async"),r(),i(54,"button",26),p("click",function(){return t.togglePendingPanel()}),i(55,"span",4),o(56,"schedule"),r(),i(57,"span",27),o(58,"Pending"),r(),v(59,Re,2,1,"span",29),r()(),v(60,Ne,8,5,"div",30),i(61,"div",31)(62,"div",32)(63,"span"),o(64,"Subtotal"),r(),i(65,"span"),o(66),r()(),i(67,"div",33)(68,"span"),o(69,"Total"),r(),i(70,"span",34),o(71),r()()(),v(72,Fe,13,4,"div",35),i(73,"div",36)(74,"button",37),p("click",function(){return t.checkout()}),i(75,"span"),o(76),r(),i(77,"span",4),o(78,"arrow_forward"),r()()(),v(79,ze,4,1,"div",38),r()()(),i(80,"div",39),p("click",function(){return t.closePendingPanel()}),i(81,"div",40),p("click",function(_){return _.stopPropagation()}),i(82,"div",41)(83,"h3")(84,"span",4),o(85,"schedule"),r(),o(86," Pending Deliveries "),r(),i(87,"button",42),p("click",function(){return t.closePendingPanel()}),i(88,"span",4),o(89,"close"),r()()(),i(90,"div",43)(91,"input",44),k("ngModelChange",function(_){return O(t.deliveryFilterDate,_)||(t.deliveryFilterDate=_),_}),p("ngModelChange",function(){return t.updateGroupedSales()}),r(),i(92,"select",45),k("ngModelChange",function(_){return O(t.statusFilter,_)||(t.statusFilter=_),_}),p("ngModelChange",function(){return t.updateGroupedSales()}),i(93,"option",46),o(94,"All Deliveries"),r(),i(95,"option",47),o(96,"Reservations Only"),r()(),v(97,$e,3,0,"button",48),r(),i(98,"div",49),v(99,Xe,36,15,"div",50)(100,Ke,5,0,"div",51),r(),v(101,Ze,9,4,"div",52),r()(),v(102,et,28,4,"div",53)(103,tt,28,4,"div",53)(104,nt,23,2,"div",53)(105,it,17,1,"div",53)(106,ct,30,10,"div",53)(107,ht,36,38,"div",53)(108,Et,20,5,"div",53)),n&2&&(l(3),T("active",!t.categoryFilter),l(5),d("ngForOf",t.categories()),l(3),d("ngForOf",t.filteredProducts),l(),d("ngIf",t.filteredProducts.length===0),l(5),x("Order #",t.orderNumber,""),l(2),R("",q(20,40,t.currentDate,"shortDate")," \u2022 ",t.currentTime,""),l(2),d("ngIf",t.cart.length>0),l(2),S("ngModel",t.selectedCustomerId),l(3),d("ngForOf",t.customers()),l(2),d("ngForOf",t.cart),l(),d("ngIf",t.cart.length===0),l(23),T("connected",w(53,43,t.printerStatus$)==="connected"),l(7),d("ngIf",t.pendingSales().length>0),l(),d("ngIf",t.deliveryDate),l(6),C(t.formatCurrency(t.total)),l(5),C(t.formatCurrency(t.total)),l(),d("ngIf",t.cart.length>0),l(2),d("disabled",!t.isValid()),l(2),x("CHARGE ",t.formatCurrency(t.total),""),l(3),d("ngIf",t.errorMessage),l(),T("open",t.isPendingPanelOpen),l(),T("open",t.isPendingPanelOpen),l(10),S("ngModel",t.deliveryFilterDate),l(),S("ngModel",t.statusFilter),l(5),d("ngIf",t.deliveryFilterDate||t.statusFilter!=="all"),l(2),d("ngForOf",t.paginatedGroupedPendingSales),l(),d("ngIf",t.allGroupedSales.length===0),l(),d("ngIf",t.pendingTotalPages>1),l(),d("ngIf",t.isDeliveryModalOpen),l(),d("ngIf",t.isEditModalOpen),l(),d("ngIf",t.isDiscountModalOpen),l(),d("ngIf",t.isNotesModalOpen),l(),d("ngIf",t.isQuantityModalOpen),l(),d("ngIf",t.isPrintModalOpen),l(),d("ngIf",t.isReceiptPreviewOpen))},dependencies:[ie,K,Z,ee,ne,te,ge,de,pe,oe,le,se,ae,ue,me,ce],styles:['.pos-container[_ngcontent-%COMP%]{display:flex;height:calc(100vh - 100px);height:calc(100dvh - 100px);width:100%;overflow:hidden;background:var(--color-bg)}.material-icon[_ngcontent-%COMP%]{font-family:Material Symbols Outlined,sans-serif;font-weight:400;font-style:normal;font-size:24px;display:inline-block;line-height:1;text-transform:none;letter-spacing:normal;word-wrap:normal;white-space:nowrap;direction:ltr;-webkit-font-smoothing:antialiased;font-variation-settings:"FILL" 0,"wght" 400,"GRAD" 0,"opsz" 24}.products-panel[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-width:0;overflow:hidden}.category-rail[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm);padding:var(--space-md) var(--space-lg);overflow-x:auto;border-bottom:1px solid var(--color-border);background:var(--color-surface);flex-shrink:0}.category-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm) var(--space-md);border:none;border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text-muted);font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}.category-btn[_ngcontent-%COMP%]:hover{background:#137fec1a;color:var(--color-primary)}.category-btn.active[_ngcontent-%COMP%]{background:var(--color-primary);color:#fff;box-shadow:0 4px 12px #137fec4d}.category-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:20px}.category-label[_ngcontent-%COMP%]{font-weight:500}.product-grid-wrapper[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:var(--space-lg)}.product-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:var(--space-md)}@media (min-width: 1200px){.product-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr)}}@media (min-width: 1400px){.product-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(6,1fr)}}.product-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-sm);padding:var(--space-sm);background:var(--color-surface);border-radius:var(--radius-xl);cursor:pointer;transition:all .2s;border:2px solid transparent;height:200px}.product-card[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);transform:translateY(-2px);box-shadow:var(--shadow-md)}.product-card.in-cart[_ngcontent-%COMP%]{border-color:var(--color-primary);background:#137fec0d}.product-image[_ngcontent-%COMP%]{position:relative;width:100%;height:120px;min-height:120px;max-height:120px;border-radius:var(--radius-lg);background-color:var(--color-bg);background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0}.product-image[_ngcontent-%COMP%]   .no-image[_ngcontent-%COMP%]{font-size:36px;color:var(--color-text-muted);opacity:.5}.cart-indicator[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:var(--color-primary);color:#fff;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;box-shadow:0 2px 8px #0000004d}.product-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.product-name[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text);margin:0;line-height:1.3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.product-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.product-price[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--color-primary)}.product-stock[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted)}.empty-products[_ngcontent-%COMP%]{grid-column:1 / -1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--space-2xl);color:var(--color-text-muted)}.empty-products[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:var(--space-md);opacity:.5}.cart-panel[_ngcontent-%COMP%]{width:480px;min-width:420px;flex-shrink:0;display:flex;flex-direction:column;background:var(--color-surface);border-left:1px solid var(--color-border);box-shadow:-4px 0 24px #0000001a;overflow-y:auto}.cart-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:var(--space-md) var(--space-lg);border-bottom:1px solid var(--color-border);flex-shrink:0}.order-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.order-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:700;color:var(--color-text);margin:0}.order-meta[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted);margin:0}.clear-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--color-primary);font-size:.875rem;font-weight:600;cursor:pointer;text-transform:uppercase;letter-spacing:.05em}.clear-btn[_ngcontent-%COMP%]:hover{color:#ef4444}.customer-select-wrapper[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-lg);border-bottom:1px solid var(--color-border);flex-shrink:0}.customer-select[_ngcontent-%COMP%]{width:100%;padding:var(--space-sm) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text);font-size:.875rem}.cart-items[_ngcontent-%COMP%]{flex:1;min-height:180px;overflow-y:auto;padding:var(--space-xs) var(--space-md)}.cart-item[_ngcontent-%COMP%]{display:flex;gap:var(--space-md);padding:var(--space-md);border-radius:var(--radius-lg);transition:background .2s;position:relative}.cart-item[_ngcontent-%COMP%]:hover{background:var(--color-bg)}.cart-item-image[_ngcontent-%COMP%]{width:48px;height:48px;min-width:48px;border-radius:var(--radius-lg);background-color:var(--color-bg);background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center}.cart-item-image[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--color-text-muted)}.cart-item-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.cart-item-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.cart-item-name[_ngcontent-%COMP%]{font-weight:500;color:var(--color-text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cart-item-total[_ngcontent-%COMP%]{font-weight:700;color:var(--color-text)}.cart-item-price[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted)}.cart-item-price.discount-applied[_ngcontent-%COMP%]{color:#10b981}.qty-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;background:var(--color-bg);border-radius:9999px;padding:2px}.qty-btn[_ngcontent-%COMP%]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;border:none;background:transparent;color:var(--color-text-muted);cursor:pointer;border-radius:50%;transition:all .2s;padding:0}.qty-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--color-surface);color:var(--color-text)}.qty-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.qty-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px}.qty-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:var(--color-text);min-width:20px;text-align:center}.remove-item-btn[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border:none;background:transparent;color:var(--color-text-muted);cursor:pointer;border-radius:50%;opacity:0;transition:all .2s;padding:0}.cart-item[_ngcontent-%COMP%]:hover   .remove-item-btn[_ngcontent-%COMP%]{opacity:1}.remove-item-btn[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#ef4444}.remove-item-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px}.empty-cart[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--space-2xl);color:var(--color-text-muted);text-align:center}.empty-cart[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:var(--space-md);opacity:.3}.empty-cart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 var(--space-xs);font-weight:500}.empty-cart[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:.75rem}.cart-footer[_ngcontent-%COMP%]{border-top:1px solid var(--color-border);padding:var(--space-xs) var(--space-md);background:var(--color-surface);display:flex;flex-direction:column;gap:var(--space-xs);flex-shrink:0}.quick-actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:var(--space-xs);overflow:visible}.action-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;padding:var(--space-xs);border:1px solid var(--color-border);border-radius:var(--radius-md);background:var(--color-bg);cursor:pointer;transition:all .2s;position:relative;overflow:visible}.action-btn[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);background:#137fec0d}.action-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--color-primary)}.action-label[_ngcontent-%COMP%]{font-size:.55rem;font-weight:600;text-transform:uppercase;letter-spacing:.03em;color:var(--color-text-muted)}.pending-badge[_ngcontent-%COMP%]{position:absolute;top:0;right:0;transform:translate(40%,-40%);background:#ef4444;color:#fff;font-size:.625rem;font-weight:700;padding:2px 6px;border-radius:9999px;min-width:18px;text-align:center;display:flex;align-items:center;justify-content:center;z-index:10;box-shadow:0 2px 4px #0003}.delivery-summary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm) var(--space-md);background:#10b9811a;border-radius:var(--radius-lg);font-size:.875rem;color:#10b981}.delivery-summary[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px}.clear-delivery[_ngcontent-%COMP%]{margin-left:auto;background:transparent;border:none;color:inherit;cursor:pointer;font-size:.875rem}.order-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-xs);padding:var(--space-sm) 0;border-top:1px solid var(--color-border)}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.875rem;color:var(--color-text-muted)}.summary-row.total-row[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:var(--color-text);padding-top:var(--space-sm);border-top:1px solid var(--color-border)}.total-amount[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}.payment-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-sm)}.cash-input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;color:var(--color-text-muted);display:block;margin-bottom:4px}.cash-input-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);border:1px solid var(--color-border);border-radius:var(--radius-lg);padding:0 var(--space-md);background:var(--color-bg)}.currency-symbol[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text-muted)}.cash-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;padding:var(--space-sm) 0;font-size:1.125rem;font-weight:600;color:var(--color-text)}.cash-input[_ngcontent-%COMP%]:focus{outline:none}.change-display[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--space-sm) var(--space-md);background:#10b9811a;border-radius:var(--radius-lg);font-size:.875rem;color:#10b981}.change-display.negative[_ngcontent-%COMP%]{background:#ef44441a;color:#ef4444}.change-amount[_ngcontent-%COMP%]{font-weight:700;font-size:1rem}.main-actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm)}.charge-btn[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;gap:var(--space-sm);height:56px;background:var(--color-primary);color:#fff;border:none;border-radius:var(--radius-xl);font-size:1.125rem;font-weight:700;cursor:pointer;transition:all .2s;box-shadow:0 4px 16px #137fec4d}.charge-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--color-primary-dark);transform:translateY(-2px);box-shadow:0 6px 20px #137fec66}.charge-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.charge-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:24px}.error-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm) var(--space-md);background:#ef44441a;border-radius:var(--radius-lg);color:#ef4444;font-size:.875rem}.error-banner[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px}.pending-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:1000;opacity:0;pointer-events:none;transition:opacity .3s}.pending-overlay.open[_ngcontent-%COMP%]{opacity:1;pointer-events:all}.pending-panel[_ngcontent-%COMP%]{position:fixed;top:0;right:-450px;width:450px;max-width:100%;height:100%;background:var(--color-surface);box-shadow:-8px 0 32px #0003;display:flex;flex-direction:column;transition:right .3s ease;z-index:1001}.pending-panel.open[_ngcontent-%COMP%]{right:0}.pending-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--space-lg);border-bottom:1px solid var(--color-border)}.pending-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);font-size:1.125rem;font-weight:700;color:var(--color-text);margin:0}.pending-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{color:var(--color-primary)}.close-pending-btn[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border:none;background:var(--color-bg);border-radius:var(--radius-lg);color:var(--color-text-muted);cursor:pointer;padding:0}.close-pending-btn[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#ef4444}.pending-filters[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm);padding:var(--space-md) var(--space-lg);border-bottom:1px solid var(--color-border)}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{flex:1;padding:var(--space-sm) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text);font-size:.875rem}.clear-filter-btn[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border:none;background:var(--color-bg);border-radius:var(--radius-lg);color:var(--color-text-muted);cursor:pointer;padding:0}.clear-filter-btn[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#ef4444}.pending-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:var(--space-md) var(--space-lg);display:flex;flex-direction:column;gap:var(--space-md)}.pending-order-card[_ngcontent-%COMP%]{background:var(--color-bg);border:1px solid var(--color-border);border-radius:var(--radius-xl);padding:var(--space-md);display:flex;flex-direction:column;gap:var(--space-sm)}.pending-order-card.reservation[_ngcontent-%COMP%]{border-color:#f97316;background:#f973160d}.order-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.order-title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);flex-wrap:wrap}.order-id[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text)}.reservation-badge[_ngcontent-%COMP%]{font-size:.625rem;font-weight:700;padding:2px 6px;background:#f97316;color:#fff;border-radius:9999px}.order-total[_ngcontent-%COMP%]{font-weight:700;color:var(--color-primary)}.order-items-preview[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted);padding:var(--space-xs) 0}.order-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);font-size:.75rem;color:var(--color-text-muted)}.detail-row[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:16px}.detail-row.payment-row[_ngcontent-%COMP%]{color:#10b981;font-weight:500}.order-actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-xs);padding-top:var(--space-sm);border-top:1px solid var(--color-border)}.order-action-btn[_ngcontent-%COMP%]{flex:1;height:36px;display:flex;align-items:center;justify-content:center;border:none;background:var(--color-surface);border-radius:var(--radius-lg);cursor:pointer;transition:all .2s}.order-action-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:20px}.order-action-btn.edit[_ngcontent-%COMP%]{color:var(--color-text-muted)}.order-action-btn.edit[_ngcontent-%COMP%]:hover{background:#3b82f61a;color:#3b82f6}.order-action-btn.confirm[_ngcontent-%COMP%]{color:#10b981}.order-action-btn.confirm[_ngcontent-%COMP%]:hover{background:#10b9811a}.order-action-btn.deliver[_ngcontent-%COMP%]{color:var(--color-primary)}.order-action-btn.deliver[_ngcontent-%COMP%]:hover{background:#137fec1a}.order-action-btn.delete[_ngcontent-%COMP%]{color:#ef4444}.order-action-btn.delete[_ngcontent-%COMP%]:hover{background:#ef44441a}.order-action-btn.print[_ngcontent-%COMP%]{color:#3b82f6}.order-action-btn.print[_ngcontent-%COMP%]:hover{background:#3b82f61a}.empty-pending[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--space-2xl);color:var(--color-text-muted);text-align:center}.empty-pending[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:48px;color:#10b981;margin-bottom:var(--space-md)}.pending-pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-md);padding:var(--space-md) var(--space-lg);border-top:1px solid var(--color-border)}.pending-pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border:1px solid var(--color-border);background:var(--color-bg);border-radius:var(--radius-lg);cursor:pointer;color:var(--color-text)}.pending-pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.pending-pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text-muted)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:2000;padding:var(--space-lg)}.modal-content[_ngcontent-%COMP%]{background:var(--color-surface);border-radius:var(--radius-xl);width:100%;max-width:400px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease}.modal-content.small[_ngcontent-%COMP%]{max-width:320px}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--space-lg);border-bottom:1px solid var(--color-border)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);font-size:1rem;font-weight:600;color:var(--color-text);margin:0}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{color:var(--color-primary)}.modal-close[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border:none;background:transparent;border-radius:var(--radius-lg);color:var(--color-text-muted);cursor:pointer;padding:0}.modal-close[_ngcontent-%COMP%]:hover{background:var(--color-bg);color:var(--color-text)}.modal-body[_ngcontent-%COMP%]{padding:var(--space-lg);display:flex;flex-direction:column;gap:var(--space-md)}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-xs)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text);font-size:.875rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px #137fec26}.discount-input-row[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm)}.discount-input-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text);font-size:1.25rem;font-weight:600}.discount-input-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:120px;padding:var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text);font-size:.875rem}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:var(--space-sm);padding:var(--space-lg);border-top:1px solid var(--color-border)}.btn-cancel[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-lg);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:transparent;color:var(--color-text);font-size:.875rem;font-weight:500;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--color-bg)}.btn-save[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-lg);background:var(--color-primary);color:#fff;border:none;border-radius:var(--radius-lg);font-size:.875rem;font-weight:600;cursor:pointer}.btn-save[_ngcontent-%COMP%]:hover{background:var(--color-primary-dark)}body.dark-theme[_nghost-%COMP%]   .cart-panel[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .cart-panel[_ngcontent-%COMP%], body.dark-theme[_nghost-%COMP%]   .pending-panel[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .pending-panel[_ngcontent-%COMP%], body.dark-theme[_nghost-%COMP%]   .modal-content[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:#1e293b}body.dark-theme[_nghost-%COMP%]   .product-card[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .product-card[_ngcontent-%COMP%], body.dark-theme[_nghost-%COMP%]   .pending-order-card[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .pending-order-card[_ngcontent-%COMP%]{background:#1e293b}body.dark-theme[_nghost-%COMP%]   .category-rail[_ngcontent-%COMP%], body.dark-theme   [_nghost-%COMP%]   .category-rail[_ngcontent-%COMP%]{background:#1e293b}@media (max-width: 900px){.pos-container[_ngcontent-%COMP%]{flex-direction:column;height:calc(100vh - 64px);overflow-y:auto}.products-panel[_ngcontent-%COMP%]{height:auto;min-height:300px;flex-shrink:0}.product-grid-wrapper[_ngcontent-%COMP%]{max-height:40vh}.cart-panel[_ngcontent-%COMP%]{width:100%;min-width:100%;height:auto;min-height:400px;border-left:none;border-top:1px solid var(--color-border)}.pending-panel[_ngcontent-%COMP%]{width:100%;right:-100%}}@media (max-width: 600px){.product-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:var(--space-sm)}.product-card[_ngcontent-%COMP%]{height:180px}.product-image[_ngcontent-%COMP%]{height:100px;min-height:100px;max-height:100px}.quick-actions[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.cart-header[_ngcontent-%COMP%], .cart-footer[_ngcontent-%COMP%]{padding:var(--space-md)}.category-rail[_ngcontent-%COMP%]{padding:var(--space-sm) var(--space-md)}}.qty-value-btn[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:var(--color-text);min-width:28px;height:28px;padding:0 8px;text-align:center;background:transparent;border:1px dashed var(--color-border);border-radius:var(--radius-md);cursor:pointer;transition:all .2s}.qty-value-btn[_ngcontent-%COMP%]:hover{background:var(--color-primary);color:#fff;border-color:var(--color-primary);border-style:solid}.qty-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-lg);align-items:center}.qty-product-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;text-align:center}.qty-product-name[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text);font-size:1rem}.qty-stock-info[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-muted)}.qty-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-md);background:var(--color-bg);padding:var(--space-sm);border-radius:var(--radius-xl)}.qty-modal-btn[_ngcontent-%COMP%]{width:44px;height:44px;display:flex;align-items:center;justify-content:center;border:none;background:var(--color-surface);color:var(--color-primary);cursor:pointer;border-radius:50%;transition:all .2s;box-shadow:0 2px 8px #0000001a}.qty-modal-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--color-primary);color:#fff;transform:scale(1.1)}.qty-modal-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.qty-modal-btn[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:24px}.qty-input[_ngcontent-%COMP%]{width:80px;height:56px;text-align:center;font-size:1.75rem;font-weight:700;color:var(--color-text);background:var(--color-surface);border:2px solid var(--color-border);border-radius:var(--radius-lg);outline:none;transition:border-color .2s}.qty-input[_ngcontent-%COMP%]:focus{border-color:var(--color-primary)}.qty-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .qty-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}.qty-input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;appearance:textfield}.qty-quick-btns[_ngcontent-%COMP%]{display:flex;gap:var(--space-sm);flex-wrap:wrap;justify-content:center}.quick-qty-btn[_ngcontent-%COMP%]{min-width:48px;height:40px;padding:0 var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);background:var(--color-bg);color:var(--color-text);font-weight:600;font-size:.875rem;cursor:pointer;transition:all .2s}.quick-qty-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:var(--color-primary);background:#137fec1a;color:var(--color-primary)}.quick-qty-btn.active[_ngcontent-%COMP%]{background:var(--color-primary);color:#fff;border-color:var(--color-primary)}.quick-qty-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.quick-qty-btn.max-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff;border-color:#10b981}.quick-qty-btn.max-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#059669,#047857);border-color:#059669}.quick-qty-btn.max-btn.active[_ngcontent-%COMP%]{box-shadow:0 4px 12px #10b98166}.qty-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-xs);font-size:.75rem;color:#f59e0b;margin:0}.qty-hint[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:16px}.printer-status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#9ca3af;position:absolute;top:6px;right:6px}.printer-status-dot.connected[_ngcontent-%COMP%]{background:#10b981;box-shadow:0 0 8px #10b98180;animation:_ngcontent-%COMP%_pulse-green 2s infinite}@keyframes _ngcontent-%COMP%_pulse-green{0%,to{opacity:1}50%{opacity:.6}}.printer-modal[_ngcontent-%COMP%]{max-width:420px}.printer-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);margin:0;font-size:1.25rem;font-weight:700}.printer-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{color:var(--color-primary)}.printer-status-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-lg);padding:var(--space-lg);background:var(--color-bg);border-radius:var(--radius-xl);border:2px solid var(--color-border);margin-bottom:var(--space-xl)}.printer-status-card.connected[_ngcontent-%COMP%]{border-color:#10b981;background:#10b9810d}.printer-status-card.connecting[_ngcontent-%COMP%]{border-color:#3b82f6;background:#3b82f60d}.printer-status-card[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;background:var(--color-surface);display:flex;align-items:center;justify-content:center}.printer-status-card[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:28px;color:#9ca3af}.printer-status-card.connected[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{background:#10b9811a}.printer-status-card.connected[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{color:#10b981}.printer-status-card.connecting[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{background:#3b82f61a}.printer-status-card.connecting[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{color:#3b82f6;animation:_ngcontent-%COMP%_spin 1.5s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.status-info[_ngcontent-%COMP%]   .status-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;margin:0 0 4px;color:var(--color-text)}.status-info[_ngcontent-%COMP%]   .device-name[_ngcontent-%COMP%]{font-size:.85rem;color:var(--color-text-muted);margin:0}.printer-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-md)}.printer-actions[_ngcontent-%COMP%]   .btn-connect[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-sm);width:100%;padding:1rem;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;border:none;border-radius:var(--radius-lg);font-size:1rem;font-weight:700;cursor:pointer;transition:all .3s ease}.printer-actions[_ngcontent-%COMP%]   .btn-connect[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #3b82f64d}.printer-actions[_ngcontent-%COMP%]   .help-text[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-text-muted);text-align:center;margin:var(--space-sm) 0 0 0}.printer-actions[_ngcontent-%COMP%]   .btn-action[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-sm);width:100%;padding:.85rem;background:var(--color-bg);color:var(--color-text);border:1px solid var(--color-border);border-radius:var(--radius-lg);font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s ease}.printer-actions[_ngcontent-%COMP%]   .btn-action[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--color-surface);border-color:var(--color-primary);color:var(--color-primary)}.printer-actions[_ngcontent-%COMP%]   .btn-action[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.printer-actions[_ngcontent-%COMP%]   .btn-disconnect[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-sm);width:100%;padding:.85rem;background:transparent;color:#ef4444;border:1px solid rgba(239,68,68,.3);border-radius:var(--radius-lg);font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s ease}.printer-actions[_ngcontent-%COMP%]   .btn-disconnect[_ngcontent-%COMP%]:hover{background:#ef44441a;border-color:#ef4444}.printer-footer[_ngcontent-%COMP%]{margin-top:var(--space-xl);padding-top:var(--space-lg);border-top:1px solid var(--color-border)}.printer-footer[_ngcontent-%COMP%]   .btn-forget[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-xs);width:100%;padding:.75rem;background:transparent;color:var(--color-text-muted);border:none;font-size:.85rem;cursor:pointer;transition:all .2s}.printer-footer[_ngcontent-%COMP%]   .btn-forget[_ngcontent-%COMP%]:hover{color:#ef4444}.printer-footer[_ngcontent-%COMP%]   .btn-forget[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:18px}.receipt-preview-modal[_ngcontent-%COMP%]{max-width:420px;max-height:90vh}.receipt-preview-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-sm);margin:0;font-size:1.25rem;font-weight:700}.receipt-preview-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{color:var(--color-primary)}.receipt-preview-body[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto;padding:0}.receipt-paper[_ngcontent-%COMP%]{background:#fff;color:#1f2937;padding:var(--space-xl);font-family:Courier New,Courier,monospace;font-size:.9rem;line-height:1.5;border-radius:var(--radius-lg);box-shadow:0 4px 12px #00000014;margin:var(--space-md)}.receipt-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--space-md)}.receipt-header[_ngcontent-%COMP%]   .store-name[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;margin:0 0 var(--space-xs) 0;color:#111827;font-family:Inter,sans-serif}.receipt-header[_ngcontent-%COMP%]   .store-address[_ngcontent-%COMP%], .receipt-header[_ngcontent-%COMP%]   .store-phone[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;margin:2px 0}.receipt-divider[_ngcontent-%COMP%]{text-align:center;color:#9ca3af;font-size:.75rem;letter-spacing:.1em;margin:var(--space-sm) 0}.receipt-order-info[_ngcontent-%COMP%]{margin-bottom:var(--space-md)}.receipt-order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:.85rem}.receipt-order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#374151}.receipt-items[_ngcontent-%COMP%]{margin-bottom:var(--space-sm)}.receipt-item[_ngcontent-%COMP%]{margin-bottom:var(--space-md)}.receipt-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-weight:600;color:#111827;margin-bottom:2px}.receipt-item[_ngcontent-%COMP%]   .item-detail[_ngcontent-%COMP%]{display:flex;justify-content:space-between;color:#4b5563;font-size:.85rem;padding-left:var(--space-md)}.receipt-item[_ngcontent-%COMP%]   .item-discount[_ngcontent-%COMP%]{color:#10b981;font-size:.8rem;padding-left:var(--space-md);font-style:italic}.receipt-totals[_ngcontent-%COMP%]{margin-top:var(--space-md)}.receipt-totals[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:4px 0;font-size:.9rem}.receipt-totals[_ngcontent-%COMP%]   .total-row.grand-total[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#111827;margin-top:var(--space-sm);padding-top:var(--space-sm);border-top:1px dashed #d1d5db}.receipt-notes[_ngcontent-%COMP%]{margin-top:var(--space-sm)}.receipt-notes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;margin:4px 0}.receipt-footer[_ngcontent-%COMP%]{text-align:center;margin-top:var(--space-md);color:#9ca3af;font-size:.85rem}.receipt-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0}.receipt-actions[_ngcontent-%COMP%]{padding:var(--space-lg);gap:var(--space-md);border-top:1px solid var(--color-border)}.receipt-actions[_ngcontent-%COMP%]   .btn-print[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-sm);flex:1;padding:.85rem 1.5rem;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;border:none;border-radius:var(--radius-lg);font-size:1rem;font-weight:700;cursor:pointer;transition:all .3s ease}.receipt-actions[_ngcontent-%COMP%]   .btn-print[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #3b82f64d}.receipt-actions[_ngcontent-%COMP%]   .btn-print[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.receipt-actions[_ngcontent-%COMP%]   .btn-print[_ngcontent-%COMP%]   .material-icon[_ngcontent-%COMP%]{font-size:20px}']})}}return c})();export{Ut as PosCalculatorComponent};
